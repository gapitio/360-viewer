{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../src/components/hotspot/DataHotspot.svelte","../../src/components/hotspot/InfoHotspot.svelte","../../src/components/hotspot/SceneHotspot.svelte","../../node_modules/minimal-event-emitter/index.js","../../node_modules/marzipano/src/util/now.js","../../node_modules/marzipano/src/collections/WorkQueue.js","../../node_modules/marzipano/src/util/calcRect.js","../../node_modules/marzipano/src/util/async.js","../../node_modules/marzipano/src/util/once.js","../../node_modules/marzipano/src/util/cancelize.js","../../node_modules/marzipano/src/util/clearOwnProperties.js","../../node_modules/marzipano/src/stages/RendererRegistry.js","../../node_modules/marzipano/src/stages/Stage.js","../../node_modules/marzipano/src/util/global.js","../../node_modules/marzipano/src/assets/Static.js","../../node_modules/marzipano/src/util/inherits.js","../../node_modules/marzipano/src/NetworkError.js","../../node_modules/marzipano/src/loaders/HtmlImage.js","../../node_modules/bowser/es5.js","../../node_modules/marzipano/src/util/pixelRatio.js","../../node_modules/marzipano/src/util/ispot.js","../../node_modules/marzipano/src/util/dom.js","../../node_modules/marzipano/src/stages/WebGl.js","../../node_modules/gl-matrix/esm/common.js","../../node_modules/gl-matrix/esm/mat2.js","../../node_modules/gl-matrix/esm/mat2d.js","../../node_modules/gl-matrix/esm/mat3.js","../../node_modules/gl-matrix/esm/mat4.js","../../node_modules/gl-matrix/esm/vec3.js","../../node_modules/gl-matrix/esm/vec4.js","../../node_modules/gl-matrix/esm/quat.js","../../node_modules/gl-matrix/esm/quat2.js","../../node_modules/gl-matrix/esm/vec2.js","../../node_modules/marzipano/src/util/clamp.js","../../node_modules/marzipano/src/renderers/WebGlCommon.js","../../node_modules/marzipano/src/shaders/vertexNormal.js","../../node_modules/marzipano/src/shaders/fragmentNormal.js","../../node_modules/marzipano/src/renderers/WebGlBase.js","../../node_modules/marzipano/src/renderers/WebGlCube.js","../../node_modules/marzipano/src/renderers/WebGlFlat.js","../../node_modules/marzipano/src/shaders/vertexEquirect.js","../../node_modules/marzipano/src/shaders/fragmentEquirect.js","../../node_modules/marzipano/src/renderers/WebGlEquirect.js","../../node_modules/marzipano/src/renderers/registerDefaultRenderers.js","../../node_modules/marzipano/src/util/hash.js","../../node_modules/marzipano/src/util/mod.js","../../node_modules/marzipano/src/collections/Set.js","../../node_modules/marzipano/src/TileSearcher.js","../../node_modules/marzipano/src/collections/LruMap.js","../../node_modules/marzipano/src/geometries/Level.js","../../node_modules/marzipano/src/util/cmp.js","../../node_modules/marzipano/src/geometries/common.js","../../node_modules/marzipano/src/util/type.js","../../node_modules/marzipano/src/geometries/Cube.js","../../node_modules/marzipano/src/geometries/Flat.js","../../node_modules/marzipano/src/geometries/Equirect.js","../../node_modules/marzipano/src/util/convertFov.js","../../node_modules/marzipano/src/util/real.js","../../node_modules/marzipano/src/util/decimal.js","../../node_modules/marzipano/src/util/compose.js","../../node_modules/marzipano/src/views/Rectilinear.js","../../node_modules/marzipano/src/views/Flat.js","../../node_modules/marzipano/src/collections/WorkPool.js","../../node_modules/marzipano/src/util/noop.js","../../node_modules/marzipano/src/util/chain.js","../../node_modules/marzipano/src/util/delay.js","../../node_modules/marzipano/src/sources/ImageUrl.js","../../node_modules/marzipano/src/sources/SingleAsset.js","../../node_modules/marzipano/src/assets/Dynamic.js","../../node_modules/marzipano/src/collections/Map.js","../../node_modules/marzipano/src/collections/LruSet.js","../../node_modules/marzipano/src/util/defaults.js","../../node_modules/marzipano/src/util/retry.js","../../node_modules/marzipano/src/TextureStore.js","../../node_modules/marzipano/src/util/extend.js","../../node_modules/marzipano/src/Layer.js","../../node_modules/marzipano/src/RenderLoop.js","../../node_modules/marzipano/src/controls/Dynamics.js","../../node_modules/marzipano/src/controls/Key.js","../../node_modules/hammerjs/hammer.js","../../node_modules/marzipano/src/controls/HammerGestures.js","../../node_modules/marzipano/src/controls/util.js","../../node_modules/marzipano/src/controls/Drag.js","../../node_modules/marzipano/src/controls/Qtvr.js","../../node_modules/marzipano/src/controls/ScrollZoom.js","../../node_modules/marzipano/src/controls/PinchZoom.js","../../node_modules/marzipano/src/controls/Velocity.js","../../node_modules/marzipano/src/controls/ElementPress.js","../../node_modules/marzipano/src/controls/Composer.js","../../node_modules/marzipano/src/controls/Controls.js","../../node_modules/marzipano/src/util/positionAbsolutely.js","../../node_modules/marzipano/src/Hotspot.js","../../node_modules/marzipano/src/HotspotContainer.js","../../node_modules/marzipano/src/Scene.js","../../node_modules/marzipano/src/Timer.js","../../node_modules/marzipano/src/controls/ControlCursor.js","../../node_modules/marzipano/src/controls/registerDefaultControls.js","../../node_modules/marzipano/src/util/tween.js","../../node_modules/marzipano/src/Viewer.js","../../node_modules/marzipano/src/colorEffects.js","../../node_modules/marzipano/src/autorotate.js","../../node_modules/marzipano/src/util/radToDeg.js","../../node_modules/marzipano/src/index.js","../../node_modules/marzipano/src/util/defer.js","../../node_modules/marzipano/src/util/degToRad.js","../../src/components/viewers/PanoramaViewer/PanoramaViewer.svelte","../../src/main.ts"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot_spread(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_spread_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_spread_changes_fn(dirty) | get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.31.1' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to seperate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_custom_elements_slots, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, update_slot_spread, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","<script lang=\"ts\">\n  export let type: \"flow\" | \"energy\" | \"power\" | \"temperature\";\n  export let value: string | number;\n\n  const types = {\n    flow: {\n      color: \"#7a36d2\",\n      unit: \"L/h\",\n    },\n    energy: {\n      color: \"#17C1B6\",\n      unit: \"kWh\",\n    },\n    power: {\n      color: \"#48ADE0\",\n      unit: \"kW\",\n    },\n    temperature: {\n      color: \"#D648E0\",\n      unit: \"°C\",\n    },\n  };\n\n  let elt: HTMLElement;\n\n  setInterval(() => {\n    value = (Math.random() * 1000).toFixed(2);\n  }, 1000);\n</script>\n\n<style>\n  div {\n    color: white;\n    width: 200px;\n  }\n  .type {\n    text-transform: uppercase;\n  }\n</style>\n\n<div bind:this={elt}>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"0 0 214 70\">\n    <g transform=\"translate(-652 -547)\">\n      <g\n        transform=\"translate(657 552)\"\n        fill=\"#1b191c\"\n        stroke={types[type].color}\n        stroke-width=\"5\"\n        opacity=\"0.88\">\n        <rect width=\"204\" height=\"60\" stroke=\"none\" />\n        <rect x=\"-2.5\" y=\"-2.5\" width=\"209\" height=\"65\" fill=\"none\" />\n      </g>\n      <text\n        class=\"type\"\n        transform=\"translate(669 573)\"\n        fill=\"#d6d6d6\"\n        font-size=\"16\"\n        font-family=\"OpenSans, Open Sans\"\n        letter-spacing=\"0.01em\">\n        <slot name=\"type\">{type}</slot>\n      </text>\n      <text\n        class=\"value\"\n        transform=\"translate(669 602)\"\n        fill=\"#fcfcfc\"\n        font-size=\"26\"\n        font-family=\"OpenSans-Semibold, Open Sans\"\n        font-weight=\"600\">\n        <slot name=\"value\">{`${value} ${types[type].unit}`}</slot>\n      </text>\n    </g>\n  </svg>\n</div>\n","<script lang=\"ts\">\n  let elt: HTMLElement;\n</script>\n\n<style>\n  div {\n    color: white;\n  }\n</style>\n\n<div bind:this={elt} class=\"hotspot\">Hello</div>\n","<script lang=\"ts\">\n  export let func: () => void;\n</script>\n\n<style>\n  div {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 2;\n    width: 80px;\n    cursor: pointer;\n  }\n</style>\n\n<div class=\"hotspot\" on:click={func}>\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"100%\"\n    height=\"100%\"\n    viewBox=\"0 0 95 95\">\n    <g id=\"Group_2\" data-name=\"Group 2\" transform=\"translate(-1406 -828)\">\n      <circle\n        id=\"Ellipse_1\"\n        data-name=\"Ellipse 1\"\n        cx=\"47.5\"\n        cy=\"47.5\"\n        r=\"47.5\"\n        transform=\"translate(1406 828)\"\n        fill=\"#1b191c\"\n        opacity=\"0.88\" />\n      <path\n        id=\"Path_1\"\n        data-name=\"Path 1\"\n        d=\"M846.277,2011.457l19.539-19.539,19.539,19.539\"\n        transform=\"translate(587.223 -1126.417)\"\n        fill=\"none\"\n        stroke=\"#f5f5f5\"\n        stroke-width=\"5\" />\n    </g>\n  </svg>\n</div>\n","'use strict';\n\n/**\n * @class\n * @classdesc Minimalistic event emitter mixin.\n */\nfunction EventEmitter() {}\n\n/**\n * Registers an event listener for the specified event. If the listener has\n * already been registered for the event, this is a no-op.\n *\n * @param {string} name The event name.\n * @param {function} fn The listener function.\n */\nEventEmitter.prototype.addEventListener = function(name, fn) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name] = eventMap[name] || [];\n  if (handlerList.indexOf(fn) < 0) {\n    handlerList.push(fn);\n  }\n};\n\n/**\n * Unregisters an event listener from the specified event. If the listener\n * hasn't been registered for the event, this is a no-op.\n *\n * @param {string} name The event name.\n * @param {function} fn The listener function.\n */\nEventEmitter.prototype.removeEventListener = function(name, fn) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name];\n  if (handlerList) {\n    var index = handlerList.indexOf(fn);\n    if (index >= 0) {\n      handlerList.splice(index, 1);\n    }\n  }\n};\n\n/**\n * Emits an event, causing all registered event listeners for that event to be\n * called in registration order.\n *\n * @param {string} name The event name.\n * @param {...*} var_args Arguments to call listeners with.\n */\nEventEmitter.prototype.emit = function(name, var_args) {\n  var eventMap = this.__events = this.__events || {};\n  var handlerList = eventMap[name];\n  var args = Array.prototype.slice.call(arguments, 1);\n  if (handlerList) {\n    for (var i = 0; i < handlerList.length; i++) {\n      var fn = handlerList[i];\n      fn.apply(this, args);\n    }\n  }\n};\n\n/**\n * Mixes in {@link EventEmitter} into a constructor function.\n *\n * @param {function} ctor The constructor function.\n */\nfunction eventEmitter(ctor) {\n  for (var prop in EventEmitter.prototype) {\n    if (EventEmitter.prototype.hasOwnProperty(prop)) {\n      ctor.prototype[prop] = EventEmitter.prototype[prop];\n    }\n  }\n}\n\nmodule.exports = eventEmitter;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction getNow() {\n  if (typeof performance !== 'undefined' && performance.now) {\n    return function performanceNow() {\n      return performance.now();\n    };\n  }\n  return function dateNow() {\n    return Date.now();\n  };\n}\n\nmodule.exports = getNow();\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar now = require('../util/now');\n\n\nfunction WorkTask(fn, cb) {\n  this.fn = fn;\n  this.cb = cb;\n  this.cfn = null;\n}\n\n\nfunction WorkQueue(opts) {\n  this._queue = [];\n  this._delay = opts && opts.delay || 0;\n  this._paused = opts && !!opts.paused || false;\n  this._currentTask = null;\n  this._lastFinished = null;\n}\n\n\nWorkQueue.prototype.length = function() {\n  return this._queue.length;\n};\n\n\nWorkQueue.prototype.push = function(fn, cb) {\n\n  var task = new WorkTask(fn, cb);\n\n  var cancel = this._cancel.bind(this, task);\n\n  // Push the task into the queue.\n  this._queue.push(task);\n\n  // Run the task if idle.\n  this._next();\n\n  return cancel;\n\n};\n\n\nWorkQueue.prototype.pause = function() {\n  if (!this._paused) {\n    this._paused = true;\n  }\n};\n\n\nWorkQueue.prototype.resume = function() {\n  if (this._paused) {\n    this._paused = false;\n    this._next();\n  }\n};\n\n\nWorkQueue.prototype._start = function(task) {\n\n  // Consistency check.\n  if (this._currentTask) {\n    throw new Error('WorkQueue: called start while running task');\n  }\n\n  // Mark queue as busy, so that concurrent tasks wait.\n  this._currentTask = task;\n\n  // Execute the task.\n  var finish = this._finish.bind(this, task);\n  task.cfn = task.fn(finish);\n\n  // Detect when a non-cancellable function has been queued.\n  if (typeof task.cfn !== 'function') {\n    throw new Error('WorkQueue: function is not cancellable');\n  }\n\n};\n\n\nWorkQueue.prototype._finish = function(task) {\n\n  var args = Array.prototype.slice.call(arguments, 1);\n\n  // Consistency check.\n  if (this._currentTask !== task) {\n    throw new Error('WorkQueue: called finish on wrong task');\n  }\n\n  // Call the task callback on the return values.\n  task.cb.apply(null, args);\n\n  // Mark as not busy and record task finish time, then advance to next task.\n  this._currentTask = null;\n  this._lastFinished = now();\n  this._next();\n\n};\n\n\nWorkQueue.prototype._cancel = function(task) {\n\n  var args = Array.prototype.slice.call(arguments, 1);\n\n  if (this._currentTask === task) {\n\n    // Cancel running task. Because cancel passes control to the _finish\n    // callback we passed into fn, the cleanup logic will be handled there.\n    task.cfn.apply(null, args);\n\n  } else {\n\n    // Remove task from queue.\n    var pos = this._queue.indexOf(task);\n    if (pos >= 0) {\n      this._queue.splice(pos, 1);\n      task.cb.apply(null, args);\n    }\n\n  }\n\n};\n\n\nWorkQueue.prototype._next = function() {\n\n  if (this._paused) {\n    // Do not start tasks while paused.\n    return;\n  }\n\n  if (!this._queue.length) {\n    // No tasks to run.\n    return;\n  }\n\n  if (this._currentTask) {\n    // Will be called again when the current task finishes.\n    return;\n  }\n\n  if (this._lastFinished != null) {\n    var elapsed = now() - this._lastFinished;\n    var remaining = this._delay - elapsed;\n    if (remaining > 0) {\n      // Too soon. Run again after the inter-task delay.\n      setTimeout(this._next.bind(this), remaining);\n      return;\n    }\n  }\n\n  // Run the next task.\n  var task = this._queue.shift();\n  this._start(task);\n\n};\n\n\nmodule.exports = WorkQueue;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Converts a {@link RectSpec} into an equivalent {@link Rect}.\n *\n * A {@link RectSpec} is a convenient user API format, providing default values\n * and the flexibility of specifying absolute, relative or mixed dimensions.\n *\n * A {@link Rect} is a more convenient format for the rendering pipeline. It is\n * always expressed in normalized coordinates, and all its properties are\n * guaranteed to be present.\n *\n * @param {number} totalWidth The total width of the rendering area in pixels.\n * @param {number} totalHeight The total height of the rendering area in pixels.\n * @param {RectSpec} spec The input spec, defaulting to the full rendering area\n *     if null or undefined.\n * @param {Rect} result The output spec. If the argument is present, it is\n *     filled in and returned; otherwise, a fresh object is returned.\n */\nfunction calcRect(totalWidth, totalHeight, spec, result) {\n\n  result = result || {};\n\n  var width;\n  if (spec != null && spec.absoluteWidth != null) {\n    width = spec.absoluteWidth / totalWidth;\n  } else if (spec != null && spec.relativeWidth != null) {\n    width = spec.relativeWidth;\n  } else {\n    width = 1;\n  }\n\n  var height;\n  if (spec && spec.absoluteHeight != null) {\n    height = spec.absoluteHeight / totalHeight;\n  } else if (spec != null && spec.relativeHeight != null) {\n    height = spec.relativeHeight;\n  } else {\n    height = 1;\n  }\n\n  var x;\n  if (spec != null && spec.absoluteX != null) {\n    x = spec.absoluteX / totalWidth;\n  } else if (spec != null && spec.relativeX != null) {\n    x = spec.relativeX;\n  } else {\n    x = 0;\n  }\n\n  var y;\n  if (spec != null && spec.absoluteY != null) {\n    y = spec.absoluteY / totalHeight;\n  } else if (spec != null && spec.relativeY != null) {\n    y = spec.relativeY;\n  } else {\n    y = 0;\n  }\n\n  result.x = x;\n  result.y = y;\n  result.width = width;\n  result.height = height;\n\n  return result;\n}\n\nmodule.exports = calcRect;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Transform a synchronous function into an asynchronous one.\nfunction async(fn) {\n  return function asynced(done) {\n    var err, ret;\n    try {\n      ret = fn();\n    } catch (e) {\n      err = e;\n    } finally {\n      if (err) {\n        done(err);\n      } else {\n        done(null, ret);\n      }\n    }\n  };\n}\n\nmodule.exports = async;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction once(fn) {\n  var called = false;\n  var value;\n  return function onced() {\n    if (!called) {\n      called = true;\n      value = fn.apply(null, arguments);\n    }\n    return value;\n  };\n}\n\nmodule.exports = once;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar once = require('./once');\n\n// A cancelable function is an asynchronous function (i.e., one whose last\n// argument is a callback receiving an error plus zero or more return values)\n// that (synchronously) returns a cancel() function. Calling cancel() should\n// abort the asynchronous operation and call the callback with the arguments\n// that were passed into cancel(). Calling cancel() twice, as with callbacks,\n// is not guaranteed to be safe.\n\n// Wrap a non-cancellable asynchronous function into a cancelable one.\n//\n// Calling cancel() on the returned function will not interrupt the execution\n// of the original function; it will merely ignore its return value.\n//\n// Usually, instead of wrapping your function, you want to implement cancel()\n// yourself in order to have some abort logic. This utility function provides a\n// straighforward solution for cases in which no custom abort logic is required.\nfunction cancelize(fn) {\n  return function cancelized() {\n    if (!arguments.length) {\n      throw new Error('cancelized: expected at least one argument');\n    }\n    var args = Array.prototype.slice.call(arguments, 0);\n    var done = args[args.length - 1] = once(args[args.length - 1]);\n\n    function cancel() {\n      done.apply(null, arguments);\n    }\n\n    fn.apply(null, args);\n\n    return cancel;\n  };\n}\n\nmodule.exports = cancelize;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Sets an object's own properties to undefined. This may be called by\n// destructors to avoid retaining references and help detect incorrect use of\n// destroyed instances.\nfunction clearOwnProperties(obj) {\n  for (var prop in obj) {\n    if (obj.hasOwnProperty(prop)) {\n      obj[prop] = undefined;\n    }\n  }\n}\n\nmodule.exports = clearOwnProperties;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class RendererRegistry\n * @classdesc\n *\n * A RendererRegistry maps pairs of {@link Geometry} and {@link View} type into\n * the appropriate {@link Renderer} class. It is used by a {@link Stage} to\n * determine the appropriate renderer for a {@link Layer}.\n *\n * See also {@link Stage#registerRenderer}.\n */\nfunction RendererRegistry() {\n  this._renderers = {};\n}\n\n/**\n * Registers a renderer for the given geometry and view type.\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class.\n */\nRendererRegistry.prototype.set = function(geometryType, viewType, Renderer) {\n  if (!this._renderers[geometryType]) {\n    this._renderers[geometryType] = {};\n  }\n  this._renderers[geometryType][viewType] = Renderer;\n};\n\n/**\n * Retrieves the renderer for the given geometry and view type.\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class, or null if no such renderer has been\n * registered.\n */\nRendererRegistry.prototype.get = function(geometryType, viewType) {\n  var Renderer = this._renderers[geometryType] &&\n      this._renderers[geometryType][viewType];\n  return Renderer || null;\n};\n\nmodule.exports = RendererRegistry;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar WorkQueue = require('../collections/WorkQueue');\nvar calcRect = require('../util/calcRect');\nvar async = require('../util/async');\nvar cancelize = require('../util/cancelize');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar RendererRegistry = require('./RendererRegistry');\n\nfunction forwardTileCmp(t1, t2) {\n  return t1.cmp(t2);\n}\n\nfunction reverseTileCmp(t1, t2) {\n  return -t1.cmp(t2);\n}\n\n/**\n * Signals that the stage has been rendered.\n *\n * @param {boolean} stable Whether all tiles were successfully rendered without\n *     missing textures or resorting to fallbacks.\n * @event Stage#renderComplete\n */\n\n/**\n * Signals that the contents of the stage have been invalidated and must be\n * rendered again.\n *\n * This is used by the {@link RenderLoop} implementation.\n *\n * @event Stage#renderInvalid\n */\n\n/**\n * @interface Stage\n * @classdesc\n *\n * A Stage is a container with the ability to render a stack of\n * {@link Layer layers}.\n *\n * This class should never be instantiated directly. Use {@link WebGlStage}\n * instead.\n *\n * @param {Object} opts\n * @param {boolean} [opts.progressive=false]\n *\n * Options listed here may be passed into the `opts` constructor argument of\n * subclasses.\n *\n * The `progressive` option controls whether resolution levels are loaded in\n * order, from lowest to highest. This results in a more pleasing effect when\n * zooming past several levels in a large panoramas, but consumes additional\n * bandwidth.\n */\nfunction Stage(opts) {\n  this._progressive = !!(opts && opts.progressive);\n\n  // The list of layers in display order (background to foreground).\n  this._layers = [];\n\n  // The list of renderers; the i-th renderer is for the i-th layer.\n  this._renderers = [];\n\n  // The lists of tiles to load and render, populated during render().\n  this._tilesToLoad = [];\n  this._tilesToRender = [];\n\n  // Temporary tile lists.\n  this._tmpVisible = [];\n  this._tmpChildren = [];\n\n  // Cached stage dimensions.\n  // Start with zero, which inhibits rendering until setSize() is called.\n  this._width = 0;\n  this._height = 0;\n\n  // Temporary variable for rect.\n  this._tmpRect = {};\n\n  // Temporary variable for size.\n  this._tmpSize = {};\n\n  // Work queue for createTexture.\n  this._createTextureWorkQueue = new WorkQueue();\n\n  // Function to emit event when render parameters have changed.\n  this._emitRenderInvalid = this._emitRenderInvalid.bind(this);\n\n  // The renderer registry maps each geometry/view pair into the respective\n  // Renderer class.\n  this._rendererRegistry = new RendererRegistry();\n}\n\neventEmitter(Stage);\n\n\n/**\n * Destructor.\n */\nStage.prototype.destroy = function() {\n  this.removeAllLayers();\n  clearOwnProperties(this);\n};\n\n\n/**\n * Registers a {@link Renderer} for the given {@link Geometry} and {@link View}\n * type.\n *\n * The {@link registerDefaultRenderers} utility function may be used to\n * register all known renderers for a stage type into that stage. Most users\n * will not need to register renderers, as {@link Viewer} does it for them.\n *\n * @param {string} geometryType The geometry type, as given by\n *     {@link Geometry#type}.\n * @param {string} viewType The view type, as given by {@link View#type}.\n * @param {*} Renderer The renderer class.\n */\nStage.prototype.registerRenderer = function(geometryType, viewType, Renderer) {\n  return this._rendererRegistry.set(geometryType, viewType, Renderer);\n};\n\n\n/**\n * Returns the underlying DOM element.\n *\n * Must be overridden by subclasses.\n *\n * @return {Element}\n */\nStage.prototype.domElement = function() {\n  throw new Error('Stage implementation must override domElement');\n};\n\n\n/**\n * Get the stage width.\n * @return {number}\n */\nStage.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the stage height.\n * @return {number}\n */\nStage.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the stage dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n *\n * @param {Size=} size\n */\nStage.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Set the stage dimensions.\n *\n * This contains the size update logic common to all stage types. Subclasses\n * must define the {@link Stage#setSizeForType} method to perform their own\n * logic.\n *\n * @param {Size} size\n */\nStage.prototype.setSize = function(size) {\n  this._width = size.width;\n  this._height = size.height;\n\n  this.setSizeForType(); // must be defined by subclasses.\n\n  this.emit('resize');\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Call {@link Stage#setSize} instead.\n *\n * This contains the size update logic specific to a stage type. It is called by\n * {@link Stage#setSize} after the base class has been updated to reflect the\n * new size, but before any events are emitted.\n *\n * @param {Size} size\n */\nStage.prototype.setSizeForType = function(size) {\n  throw new Error('Stage implementation must override setSizeForType');\n};\n\n\n/**\n * Loads an {@link Asset} from an image.\n * @param {string} url The image URL.\n * @param {?Rect} rect A {@link Rect} describing a portion of the image, or null\n *     to use the full image.\n * @param {function(?Error, Asset)} done The callback.\n * @return {function()} A function to cancel loading.\n */\nStage.prototype.loadImage = function() {\n  throw new Error('Stage implementation must override loadImage');\n};\n\n\nStage.prototype._emitRenderInvalid = function() {\n  this.emit('renderInvalid');\n};\n\n\n/**\n * Verifies that the layer is valid for this stage, throwing an exception\n * otherwise.\n *\n * @param {Layer} layer\n * @throws {Error} If the layer is not valid for this stage.\n */\nStage.prototype.validateLayer = function(layer) {\n  throw new Error('Stage implementation must override validateLayer');\n};\n\n\n/**\n * Returns a list of all {@link Layer layers} belonging to the stage. The\n * returned list is in display order, background to foreground.\n * @return {Layer[]}\n */\nStage.prototype.listLayers = function() {\n  // Return a copy to prevent unintended mutation by the caller.\n  return [].concat(this._layers);\n};\n\n\n/**\n * Return whether a {@link Layer layer} belongs to the stage.\n * @param {Layer} layer\n * @return {boolean}\n */\nStage.prototype.hasLayer = function(layer) {\n  return this._layers.indexOf(layer) >= 0;\n};\n\n\n/**\n * Adds a {@link Layer layer} into the stage.\n * @param {Layer} layer The layer to add.\n * @param {number|undefined} i The optional position, where 0 ≤ i ≤ n and n is\n *     the current number of layers. The default is n, which inserts at the\n *     top of the display stack.\n * @throws An error if the layer already belongs to the stage or if the position\n *     is invalid.\n */\nStage.prototype.addLayer = function(layer, i) {\n  if (this._layers.indexOf(layer) >= 0) {\n    throw new Error('Layer already in stage');\n  }\n\n  if (i == null) {\n    i = this._layers.length;\n  }\n  if (i < 0 || i > this._layers.length) {\n    throw new Error('Invalid layer position');\n  }\n\n  this.validateLayer(layer); // must be defined by subclasses.\n\n  var geometryType = layer.geometry().type;\n  var viewType = layer.view().type;\n  var rendererClass = this._rendererRegistry.get(geometryType, viewType);\n  if (!rendererClass) {\n    throw new Error('No ' + this.type + ' renderer avaiable for ' +\n        geometryType + ' geometry and ' + viewType + ' view');\n  }\n  var renderer = this.createRenderer(rendererClass);\n\n  this._layers.splice(i, 0, layer);\n  this._renderers.splice(i, 0, renderer);\n\n  // Listeners for render invalid.\n  layer.addEventListener('viewChange', this._emitRenderInvalid);\n  layer.addEventListener('effectsChange', this._emitRenderInvalid);\n  layer.addEventListener('fixedLevelChange', this._emitRenderInvalid);\n  layer.addEventListener('textureStoreChange', this._emitRenderInvalid);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Moves a {@link Layer layer} into a different position in the display stack.\n * @param {Layer} layer The layer to move.\n * @param {number} i The position, where 0 ≤ i ≤ n-1 and n is the current number\n *     of layers.\n * @throws An error if the layer does not belong to the stage or if the position\n *     is invalid.\n */\nStage.prototype.moveLayer = function(layer, i) {\n  var index = this._layers.indexOf(layer);\n  if (index < 0) {\n    throw new Error('No such layer in stage');\n  }\n\n  if (i < 0 || i >= this._layers.length) {\n    throw new Error('Invalid layer position');\n  }\n\n  layer = this._layers.splice(index, 1)[0];\n  var renderer = this._renderers.splice(index, 1)[0];\n\n  this._layers.splice(i, 0, layer);\n  this._renderers.splice(i, 0, renderer);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Removes a {@link Layer} from the stage.\n * @param {Layer} layer The layer to remove.\n * @throws An error if the layer does not belong to the stage.\n */\nStage.prototype.removeLayer = function(layer) {\n  var index = this._layers.indexOf(layer);\n  if (index < 0) {\n    throw new Error('No such layer in stage');\n  }\n\n  var removedLayer = this._layers.splice(index, 1)[0];\n  var renderer = this._renderers.splice(index, 1)[0];\n\n  this.destroyRenderer(renderer);\n\n  removedLayer.removeEventListener('viewChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('effectsChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('fixedLevelChange', this._emitRenderInvalid);\n  removedLayer.removeEventListener('textureStoreChange', this._emitRenderInvalid);\n\n  this._emitRenderInvalid();\n};\n\n\n/**\n * Removes all {@link Layer layers} from the stage.\n */\nStage.prototype.removeAllLayers = function() {\n  while (this._layers.length > 0) {\n    this.removeLayer(this._layers[0]);\n  }\n};\n\n\n/**\n * Called before a frame is rendered.\n *\n * Must be overridden by subclasses.\n */\nStage.prototype.startFrame = function() {\n  throw new Error('Stage implementation must override startFrame');\n};\n\n\n/**\n * Called after a frame is rendered.\n *\n * Must be overridden by subclasses.\n */\nStage.prototype.endFrame = function() {\n  throw new Error('Stage implementation must override endFrame');\n};\n\n\n/**\n * Render the current frame. Usually called from a {@link RenderLoop}.\n *\n * This contains the rendering logic common to all stage types. Subclasses\n * define the startFrame() and endFrame() methods to perform their own logic.\n */\nStage.prototype.render = function() {\n  var i, j;\n\n  var tilesToLoad = this._tilesToLoad;\n  var tilesToRender = this._tilesToRender;\n\n  var stableStage = true;\n  var stableLayer;\n\n  // Get the stage dimensions.\n  var width = this._width;\n  var height = this._height;\n\n  var rect = this._tmpRect;\n  var size = this._tmpSize;\n\n  if (width <= 0 || height <= 0) {\n    return;\n  }\n\n  this.startFrame(); // defined by subclasses\n\n  // Signal start of frame to the texture stores.\n  for (i = 0; i < this._layers.length; i++) {\n    this._layers[i].textureStore().startFrame();\n  }\n\n  // Render layers.\n  for (i = 0; i < this._layers.length; i++) {\n    var layer = this._layers[i];\n    var effects = layer.effects();\n    var view = layer.view();\n    var textureStore = layer.textureStore();\n    var renderer = this._renderers[i];\n    var depth = this._layers.length - i;\n    var tile, texture;\n\n    // Convert the rect effect into a normalized rect.\n    // TODO: avoid doing this on every frame.\n    calcRect(width, height, effects && effects.rect, rect);\n\n    if (rect.width <= 0 || rect.height <= 0) {\n      // Skip rendering on a null viewport.\n      continue;\n    }\n\n    // Update the view size.\n    size.width = rect.width * this._width;\n    size.height = rect.height * this._height;\n    view.setSize(size);\n\n    // Signal start of layer to the renderer.\n    renderer.startLayer(layer, rect);\n\n    // We render with both alpha blending and depth testing enabled. Thus, when\n    // rendering a subsequent pixel at the same location than an existing one,\n    // the subsequent pixel gets discarded unless it has smaller depth, and is\n    // otherwise composited with the existing pixel.\n    //\n    // When using fallback tiles to fill a gap in the preferred resolution\n    // level, we prefer higher resolution fallbacks to lower resolution ones.\n    // However, where fallbacks overlap, we want higher resolution ones to\n    // prevail, and we don't want multiple fallbacks to be composited with each\n    // other, as that would produce a bad result when semitransparent textures\n    // are involved.\n    //\n    // In order to achieve this within the constraints of alpha blending and\n    // depth testing, the depth of a tile must be inversely proportional to its\n    // resolution, and higher-resolution tiles must be rendered before lower-\n    // resolution ones.\n\n    // Collect the lists of tiles to load and render.\n    stableLayer = this._collectTiles(layer, textureStore);\n\n    // Mark all the tiles whose textures must be loaded.\n    // This will either trigger loading (for textures not yet loaded) or\n    // prevent unloading (for textures already loaded).\n    for (j = 0; j < tilesToLoad.length; j++) {\n      tile = tilesToLoad[j];\n      textureStore.markTile(tile);\n    }\n\n    // Render tiles.\n    for (j = 0; j < tilesToRender.length; j++) {\n      tile = tilesToRender[j];\n      texture = textureStore.texture(tile);\n      renderer.renderTile(tile, texture, layer, depth);\n    }\n\n    layer.emit('renderComplete', stableLayer);\n    if (!stableLayer) {\n      stableStage = false;\n    }\n\n    // Signal end of layer to the renderer.\n    renderer.endLayer(layer, rect);\n  }\n\n  // Signal end of frame to the texture stores.\n  for (i = 0; i < this._layers.length; i++) {\n    this._layers[i].textureStore().endFrame();\n  }\n\n  this.endFrame(); // defined by subclasses\n\n  this.emit('renderComplete', stableStage);\n};\n\nStage.prototype._collectTiles = function(layer, textureStore) {\n  var tilesToLoad = this._tilesToLoad;\n  var tilesToRender = this._tilesToRender;\n  var tmpVisible = this._tmpVisible;\n\n  tilesToLoad.length = 0;\n  tilesToRender.length = 0;\n  tmpVisible.length = 0;\n\n  layer.visibleTiles(tmpVisible);\n\n  var isStable = true;\n\n  for (var i = 0; i < tmpVisible.length; i++) {\n    var tile = tmpVisible[i];\n    var needsFallback;\n    this._collectTileToLoad(tile);\n    if (textureStore.texture(tile)) {\n      // The preferred texture is available.\n      // No fallback is required.\n      needsFallback = false;\n      this._collectTileToRender(tile);\n    } else {\n      // The preferred texture is unavailable.\n      // Collect children for rendering as a fallback.\n      needsFallback = this._collectChildren(tile, textureStore);\n      isStable = false;\n    }\n    // Collect all parents for loading, and the closest parent for rendering if\n    // a fallback is required.\n    this._collectParents(tile, textureStore, needsFallback);\n  }\n\n  // Sort tiles to load in ascending resolution order.\n  tilesToLoad.sort(forwardTileCmp);\n\n  // Sort tiles to render in descending resolution order.\n  tilesToRender.sort(reverseTileCmp);\n\n  return isStable;\n};\n\nStage.prototype._collectChildren = function(tile, textureStore) {\n  var tmpChildren = this._tmpChildren;\n\n  var needsFallback = true;\n\n  // Fall back as many levels as necessary on single-child geometries, but do\n  // not go beyond immediate children on multiple-child geometries, to avoid\n  // exploring an exponential number of tiles.\n  do {\n    tmpChildren.length = 0;\n    if (!tile.children(tmpChildren)) {\n      break;\n    }\n    needsFallback = false;\n    for (var i = 0; i < tmpChildren.length; i++) {\n      tile = tmpChildren[i];\n      if (textureStore.texture(tile)) {\n        this._collectTileToLoad(tile);\n        this._collectTileToRender(tile);\n      } else {\n        needsFallback = true;\n      }\n    }\n  } while (needsFallback && tmpChildren.length === 1)\n\n  return needsFallback;\n};\n\nStage.prototype._collectParents = function(tile, textureStore, needsFallback) {\n  // Recursively visit parent tiles until:\n  //   - all parents have been marked for loading, if progressive rendering is\n  //     enabled; and\n  //   - at least one parent has been marked for both loading and rendering, if\n  //     a fallback is required.\n  var needsLoading = this._progressive;\n  while ((needsLoading || needsFallback) && (tile = tile.parent()) != null) {\n    if (needsFallback) {\n      if (textureStore.texture(tile)) {\n        this._collectTileToRender(tile);\n        needsFallback = false;\n      } else if (!this._progressive) {\n        continue;\n      }\n    }\n    if (!this._collectTileToLoad(tile)) {\n      needsLoading = false;\n    }\n  }\n  return needsFallback;\n};\n\nStage.prototype._collectTileToLoad = function(tile) {\n  return this._collectTileIntoList(tile, this._tilesToLoad);\n};\n\nStage.prototype._collectTileToRender = function(tile) {\n  return this._collectTileIntoList(tile, this._tilesToRender);\n};\n\nStage.prototype._collectTileIntoList = function(tile, tileList) {\n  // TODO: Investigate whether it's worth it to make this better than O(n²).\n  var found = false;\n  for (var i = 0; i < tileList.length; i++) {\n    if (tile.equals(tileList[i])) {\n      found = true;\n      break;\n    }\n  }\n  if (!found) {\n    tileList.push(tile);\n  }\n  return !found;\n};\n\n/**\n * Create a texture for the given tile and asset. Called by {@link TextureStore}.\n * @param {Tile} tile\n * @param {Asset} asset\n * @param {Function} done\n */\nStage.prototype.createTexture = function(tile, asset, done) {\n\n  var self = this;\n\n  function makeTexture() {\n    return new self.TextureClass(self, tile, asset);\n  }\n\n  var fn = cancelize(async(makeTexture));\n\n  return this._createTextureWorkQueue.push(fn, function(err, texture) {\n    done(err, tile, asset, texture);\n  });\n\n};\n\n/**\n * The stage type, used to determine the appropriate renderer for a given\n * geometry and view.\n *\n * The sole known value is `\"webgl\".\n *\n * See also {@link Stage#registerRenderer}.\n *\n * @property {string}\n * @name Stage#type\n */\n\nmodule.exports = Stage;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// The global object.\nvar globalObject = (function() {\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return null;\n})();\n\nmodule.exports = globalObject;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar global = require('../util/global');\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar propertyMap = {\n  HTMLImageElement: ['naturalWidth', 'naturalHeight'],\n  HTMLCanvasElement: ['width', 'height'],\n  ImageBitmap: ['width', 'height']\n};\n\n/**\n * @class StaticAsset\n * @implements Asset\n * @classdesc\n *\n * An {@link Asset} whose pixel contents never change.\n *\n * @param {HTMLImageElement|HTMLCanvasElement|ImageBitmap} element The\n *     underlying pixel source.\n * @throws If the pixel source is unsupported.\n */\nfunction StaticAsset(element) {\n  var supported = false;\n  for (var type in propertyMap) {\n    if (global[type] && element instanceof global[type]) {\n      supported = true;\n      this._widthProp = propertyMap[type][0];\n      this._heightProp = propertyMap[type][1];\n      break;\n    }\n  }\n  if (!supported) {\n    throw new Error('Unsupported pixel source');\n  }\n\n  this._element = element;\n}\n\neventEmitter(StaticAsset);\n\n/**\n * Destructor.\n */\nStaticAsset.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\nStaticAsset.prototype.element = function() {\n  return this._element;\n};\n\nStaticAsset.prototype.width = function() {\n  return this._element[this._widthProp];\n};\n\nStaticAsset.prototype.height = function() {\n  return this._element[this._heightProp];\n};\n\nStaticAsset.prototype.timestamp = function() {\n  return 0;\n};\n\nStaticAsset.prototype.isDynamic = function() {\n  return false;\n};\n\nmodule.exports = StaticAsset;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Make ctor a subclass of superCtor.\n// Do not depend on ES5 Object.create semantics because of older browsers.\nfunction inherits(ctor, superCtor) {\n  ctor.super_ = superCtor;\n  var TempCtor = function() {};\n  TempCtor.prototype = superCtor.prototype;\n  ctor.prototype = new TempCtor();\n  ctor.prototype.constructor = ctor;\n}\n\nmodule.exports = inherits;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('./util/inherits');\n\n/**\n * @class NetworkError\n * @extends {Error}\n * @classdesc\n *\n * Signals an error that occurred while fetching a URL. This is used by\n * {@link Loader loaders} to distinguish network failures from other errors.\n */\nfunction NetworkError(message) {\n  // See: https://stackoverflow.com/questions/1382107/whats-a-good-way-to-extend-error-in-javascript\n  this.constructor.super_.apply(this, arguments);\n  this.message = message;\n}\n\ninherits(NetworkError, Error);\n\nmodule.exports = NetworkError;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar StaticAsset = require('../assets/Static');\nvar NetworkError = require('../NetworkError');\nvar global = require('../util/global');\nvar once = require('../util/once');\n\n// TODO: Move the load queue into the loader.\n\n// Options for createImageBitmap.\nvar createImageBitmapOpts = {\n  imageOrientation: 'flipY',\n  premultiplyAlpha: 'premultiply',\n  resizeQuality: 'high'\n};\n\n/**\n * @class HtmlImageLoader\n * @implements ImageLoader\n * @classdesc\n *\n * A {@link Loader} for HTML images.\n *\n * @param {Stage} stage The stage which is going to request images to be loaded.\n */\nfunction HtmlImageLoader(stage) {\n  this._stage = stage;\n}\n\n/**\n * Loads an {@link Asset} from an image.\n * @param {string} url The image URL.\n * @param {?Rect} rect A {@link Rect} describing a portion of the image, or null\n *     to use the full image.\n * @param {function(?Error, Asset)} done The callback.\n * @return {function()} A function to cancel loading.\n */\nHtmlImageLoader.prototype.loadImage = function(url, rect, done) {\n  var self = this;\n\n  var img = new Image();\n\n  // Allow cross-domain image loading.\n  // This is required to be able to create WebGL textures from images fetched\n  // from a different domain. Note that setting the crossorigin attribute to\n  // 'anonymous' will trigger a CORS preflight for cross-domain requests, but no\n  // credentials (cookies or HTTP auth) will be sent; to do so, the attribute\n  // would have to be set to 'use-credentials' instead. Unfortunately, this is\n  // not a safe choice, as it causes requests to fail when the response contains\n  // an Access-Control-Allow-Origin header with a wildcard. See the section\n  // \"Credentialed requests and wildcards\" on:\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS\n  img.crossOrigin = 'anonymous';\n\n  var x = rect && rect.x || 0;\n  var y = rect && rect.y || 0;\n  var width = rect && rect.width || 1;\n  var height = rect && rect.height || 1;\n\n  done = once(done);\n\n  img.onload = function() {\n    self._handleLoad(img, x, y, width, height, done);\n  };\n\n  img.onerror = function() {\n    self._handleError(url, done);\n  };\n\n  img.src = url;\n\n  function cancel() {\n    img.onload = img.onerror = null;\n    img.src = '';\n    done.apply(null, arguments);\n  }\n\n  return cancel;\n};\n\nHtmlImageLoader.prototype._handleLoad = function(img, x, y, width, height, done) {\n  if (x === 0 && y === 0 && width === 1 && height === 1) {\n    // Fast path for when cropping is not needed.\n    done(null, new StaticAsset(img));\n    return;\n  }\n\n  x *= img.naturalWidth;\n  y *= img.naturalHeight;\n  width *= img.naturalWidth;\n  height *= img.naturalHeight;\n\n  if (global.createImageBitmap) {\n    // Prefer to crop using createImageBitmap, which can potentially offload\n    // work to another thread and avoid blocking the user interface.\n    // Assume that the promise is never rejected.\n    global.createImageBitmap(img, x, y, width, height, createImageBitmapOpts)\n      .then(function(bitmap) {\n        done(null, new StaticAsset(bitmap));\n      });\n  } else {\n    // Fall back to cropping using a canvas, which can potentially block the\n    // user interface, but is the best we can do.\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var context = canvas.getContext('2d');\n    context.drawImage(img, x, y, width, height, 0, 0, width, height);\n    done(null, new StaticAsset(canvas));\n  }\n};\n\nHtmlImageLoader.prototype._handleError = function(url, done) {\n  // TODO: is there any way to distinguish a network error from other\n  // kinds of errors? For now we always return NetworkError since this\n  // prevents images to be retried continuously while we are offline.\n  done(new NetworkError('Network error: ' + url));\n};\n\nmodule.exports = HtmlImageLoader;\n","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.bowser=t():e.bowser=t()}(this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=90)}({17:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||\"\"},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||\"\"},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case\"NT\":return\"NT\";case\"XP\":return\"XP\";case\"NT 5.0\":return\"2000\";case\"NT 5.1\":return\"XP\";case\"NT 5.2\":return\"2003\";case\"NT 6.0\":return\"Vista\";case\"NT 6.1\":return\"7\";case\"NT 6.2\":return\"8\";case\"NT 6.3\":return\"8.1\";case\"NT 10.0\":return\"10\";default:return}},e.getMacOSVersionName=function(e){var t=e.split(\".\").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return\"Leopard\";case 6:return\"Snow Leopard\";case 7:return\"Lion\";case 8:return\"Mountain Lion\";case 9:return\"Mavericks\";case 10:return\"Yosemite\";case 11:return\"El Capitan\";case 12:return\"Sierra\";case 13:return\"High Sierra\";case 14:return\"Mojave\";case 15:return\"Catalina\";default:return}},e.getAndroidVersionName=function(e){var t=e.split(\".\").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?\"Cupcake\":1===t[0]&&t[1]>=6?\"Donut\":2===t[0]&&t[1]<2?\"Eclair\":2===t[0]&&2===t[1]?\"Froyo\":2===t[0]&&t[1]>2?\"Gingerbread\":3===t[0]?\"Honeycomb\":4===t[0]&&t[1]<1?\"Ice Cream Sandwich\":4===t[0]&&t[1]<4?\"Jelly Bean\":4===t[0]&&t[1]>=4?\"KitKat\":5===t[0]?\"Lollipop\":6===t[0]?\"Marshmallow\":7===t[0]?\"Nougat\":8===t[0]?\"Oreo\":9===t[0]?\"Pie\":void 0},e.getVersionPrecision=function(e){return e.split(\".\").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),s=e.getVersionPrecision(r),a=Math.max(i,s),o=0,u=e.map([t,r],(function(t){var r=a-e.getVersionPrecision(t),n=t+new Array(r+1).join(\".0\");return e.map(n.split(\".\"),(function(e){return new Array(20-e.length).join(\"0\")+e})).reverse()}));for(n&&(o=a-Math.min(i,s)),a-=1;a>=o;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===o)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(s));var o=function(){var e=s[t];\"object\"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=s.length;t<r;t+=1)o();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||\"\"},e}();t.default=i,e.exports=t.default},18:function(e,t,r){\"use strict\";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0;t.BROWSER_ALIASES_MAP={\"Amazon Silk\":\"amazon_silk\",\"Android Browser\":\"android\",Bada:\"bada\",BlackBerry:\"blackberry\",Chrome:\"chrome\",Chromium:\"chromium\",Electron:\"electron\",Epiphany:\"epiphany\",Firefox:\"firefox\",Focus:\"focus\",Generic:\"generic\",\"Google Search\":\"google_search\",Googlebot:\"googlebot\",\"Internet Explorer\":\"ie\",\"K-Meleon\":\"k_meleon\",Maxthon:\"maxthon\",\"Microsoft Edge\":\"edge\",\"MZ Browser\":\"mz\",\"NAVER Whale Browser\":\"naver\",Opera:\"opera\",\"Opera Coast\":\"opera_coast\",PhantomJS:\"phantomjs\",Puffin:\"puffin\",QupZilla:\"qupzilla\",QQ:\"qq\",QQLite:\"qqlite\",Safari:\"safari\",Sailfish:\"sailfish\",\"Samsung Internet for Android\":\"samsung_internet\",SeaMonkey:\"seamonkey\",Sleipnir:\"sleipnir\",Swing:\"swing\",Tizen:\"tizen\",\"UC Browser\":\"uc\",Vivaldi:\"vivaldi\",\"WebOS Browser\":\"webos\",WeChat:\"wechat\",\"Yandex Browser\":\"yandex\",Roku:\"roku\"};t.BROWSER_MAP={amazon_silk:\"Amazon Silk\",android:\"Android Browser\",bada:\"Bada\",blackberry:\"BlackBerry\",chrome:\"Chrome\",chromium:\"Chromium\",electron:\"Electron\",epiphany:\"Epiphany\",firefox:\"Firefox\",focus:\"Focus\",generic:\"Generic\",googlebot:\"Googlebot\",google_search:\"Google Search\",ie:\"Internet Explorer\",k_meleon:\"K-Meleon\",maxthon:\"Maxthon\",edge:\"Microsoft Edge\",mz:\"MZ Browser\",naver:\"NAVER Whale Browser\",opera:\"Opera\",opera_coast:\"Opera Coast\",phantomjs:\"PhantomJS\",puffin:\"Puffin\",qupzilla:\"QupZilla\",qq:\"QQ Browser\",qqlite:\"QQ Browser Lite\",safari:\"Safari\",sailfish:\"Sailfish\",samsung_internet:\"Samsung Internet for Android\",seamonkey:\"SeaMonkey\",sleipnir:\"Sleipnir\",swing:\"Swing\",tizen:\"Tizen\",uc:\"UC Browser\",vivaldi:\"Vivaldi\",webos:\"WebOS Browser\",wechat:\"WeChat\",yandex:\"Yandex Browser\"};t.PLATFORMS_MAP={tablet:\"tablet\",mobile:\"mobile\",desktop:\"desktop\",tv:\"tv\"};t.OS_MAP={WindowsPhone:\"Windows Phone\",Windows:\"Windows\",MacOS:\"macOS\",iOS:\"iOS\",Android:\"Android\",WebOS:\"WebOS\",BlackBerry:\"BlackBerry\",Bada:\"Bada\",Tizen:\"Tizen\",Linux:\"Linux\",ChromeOS:\"Chrome OS\",PlayStation4:\"PlayStation 4\",Roku:\"Roku\"};t.ENGINE_MAP={EdgeHTML:\"EdgeHTML\",Blink:\"Blink\",Trident:\"Trident\",Presto:\"Presto\",Gecko:\"Gecko\",WebKit:\"WebKit\"}},90:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},s=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),\"string\"!=typeof e)throw new Error(\"UserAgent should be a string\");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,n=[{key:\"BROWSER_MAP\",get:function(){return s.BROWSER_MAP}},{key:\"ENGINE_MAP\",get:function(){return s.ENGINE_MAP}},{key:\"OS_MAP\",get:function(){return s.OS_MAP}},{key:\"PLATFORMS_MAP\",get:function(){return s.PLATFORMS_MAP}}],(r=null)&&a(t.prototype,r),n&&a(t,n),e}();t.default=o,e.exports=t.default},91:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n=u(r(92)),i=u(r(93)),s=u(r(94)),a=u(r(95)),o=u(r(17));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||\"\"===e)throw new Error(\"UserAgent parameter can't be empty\");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(n.default,(function(t){if(\"function\"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error(\"Browser's test function is not valid\")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||\"\":this.getBrowser().name||\"\"},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(i.default,(function(t){if(\"function\"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error(\"Browser's test function is not valid\")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||\"\":t||\"\"},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||\"\":t||\"\"},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(s.default,(function(t){if(\"function\"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error(\"Browser's test function is not valid\")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||\"\":this.getEngine().name||\"\"},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(a.default,(function(t){if(\"function\"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error(\"Browser's test function is not valid\")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},s=0;if(Object.keys(e).forEach((function(t){var a=e[t];\"string\"==typeof a?(i[t]=a,s+=1):\"object\"==typeof a&&(r[t]=a,n+=1)})),n>0){var a=Object.keys(r),u=o.default.find(a,(function(e){return t.isOS(e)}));if(u){var d=this.satisfies(r[u]);if(void 0!==d)return d}var c=o.default.find(a,(function(e){return t.isPlatform(e)}));if(c){var f=this.satisfies(r[c]);if(void 0!==f)return f}}if(s>0){var l=Object.keys(i),h=o.default.find(l,(function(e){return t.isBrowser(e,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=o.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if(\"string\"==typeof i)return\">\"===e[0]||\"<\"===e[0]?(r=e.substr(1),\"=\"===e[1]?(n=!0,r=e.substr(2)):t=[],\">\"===e[0]?t.push(1):t.push(-1)):\"=\"===e[0]?r=e.substr(1):\"~\"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(o.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=d,e.exports=t.default},92:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n};var s=/version\\/(\\d+(\\.?_?\\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:\"Googlebot\"},r=i.default.getFirstMatch(/googlebot\\/(\\d+(\\.\\d+))/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:\"Opera\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:opera)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\\/|opios/i],describe:function(e){var t={name:\"Opera\"},r=i.default.getFirstMatch(/(?:opr|opios)[\\s/](\\S+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:\"Samsung Internet for Android\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:\"NAVER Whale Browser\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:whale)[\\s/](\\d+(?:\\.\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:\"MZ Browser\"},r=i.default.getFirstMatch(/(?:MZBrowser)[\\s/](\\d+(?:\\.\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:\"Focus\"},r=i.default.getFirstMatch(/(?:focus)[\\s/](\\d+(?:\\.\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:\"Swing\"},r=i.default.getFirstMatch(/(?:swing)[\\s/](\\d+(?:\\.\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:\"Opera Coast\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:coast)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\\/\\d+(?:.?_?\\d+)+/i],describe:function(e){var t={name:\"Opera Touch\"},r=i.default.getFirstMatch(/(?:opt)[\\s/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:\"Yandex Browser\"},r=i.default.getFirstMatch(/(?:yabrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:\"UC Browser\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:ucbrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:\"Maxthon\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:\"Epiphany\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:epiphany)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:\"Puffin\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:puffin)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:\"Sleipnir\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:sleipnir)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:\"K-Meleon\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/(?:k-meleon)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:\"WeChat\"},r=i.default.getFirstMatch(/(?:micromessenger)[\\s/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?\"QQ Browser Lite\":\"QQ Browser\"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:\"Internet Explorer\"},r=i.default.getFirstMatch(/(?:msie |rv:)(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\\sedg\\//i],describe:function(e){var t={name:\"Microsoft Edge\"},r=i.default.getFirstMatch(/\\sedg\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:\"Microsoft Edge\"},r=i.default.getSecondMatch(/edg([ea]|ios)\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:\"Vivaldi\"},r=i.default.getFirstMatch(/vivaldi\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:\"SeaMonkey\"},r=i.default.getFirstMatch(/seamonkey\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:\"Sailfish\"},r=i.default.getFirstMatch(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:\"Amazon Silk\"},r=i.default.getFirstMatch(/silk\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:\"PhantomJS\"},r=i.default.getFirstMatch(/phantomjs\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:\"SlimerJS\"},r=i.default.getFirstMatch(/slimerjs\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\\bbb\\d+/i,/rim\\stablet/i],describe:function(e){var t={name:\"BlackBerry\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/blackberry[\\d]+\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:\"WebOS Browser\"},r=i.default.getFirstMatch(s,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:\"Bada\"},r=i.default.getFirstMatch(/dolfin\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:\"Tizen\"},r=i.default.getFirstMatch(/(?:tizen\\s?)?browser\\/(\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:\"QupZilla\"},r=i.default.getFirstMatch(/(?:qupzilla)[\\s/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:\"Firefox\"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:\"Electron\"},r=i.default.getFirstMatch(/(?:electron)\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:\"Miui\"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:\"Chromium\"},r=i.default.getFirstMatch(/(?:chromium)[\\s/](\\d+(\\.?_?\\d+)+)/i,e)||i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:\"Chrome\"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:\"Google Search\"},r=i.default.getFirstMatch(/(?:GSA)\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:\"Android Browser\"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:\"PlayStation 4\"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:\"Safari\"},r=i.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search(\"\\\\(\")?/^(.*)\\/(.*)[ \\t]\\((.*)/:/^(.*)\\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18);var a=[{test:[/Roku\\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\\/DVP-(\\d+\\.\\d+)/i,e);return{name:s.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i,e);return{name:s.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:s.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\\//],describe:function(e){var t={name:s.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\\/)(\\d[\\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\\d+(\\.?_?\\d+)+)/i,e).replace(/[_\\s]/g,\".\"),r=i.default.getMacOSVersionName(t),n={name:s.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\\d+([_\\s]\\d+)*) like mac os x/i,e).replace(/[_\\s]/g,\".\");return{name:s.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\\s/-](\\d+(\\.\\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:s.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\\/(\\d+(\\.\\d+)*)/i,e),r={name:s.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\\bbb\\d+/i,/rim\\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\\d+\\/(\\d+([_\\s]\\d+)*)/i,e)||i.default.getFirstMatch(/\\bbb(\\d+)/i,e);return{name:s.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\\/(\\d+(\\.\\d+)*)/i,e);return{name:s.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\\s](\\d+(\\.\\d+)*)/i,e);return{name:s.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:s.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\\s](\\d+(\\.\\d+)*)/i,e);return{name:s.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18);var a=[{test:[/googlebot/i],describe:function(){return{type:\"bot\",vendor:\"Google\"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&\"Nova\",r={type:s.PLATFORMS_MAP.mobile,vendor:\"Huawei\"};return t&&(r.model=t),r}},{test:[/nexus\\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:\"Nexus\"}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:\"Apple\",model:\"iPad\"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:\"Apple\",model:\"iPad\"}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:\"Amazon\",model:\"Kindle Fire HD 7\"}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet,vendor:\"Amazon\"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:s.PLATFORMS_MAP.mobile,vendor:\"Apple\",model:t}}},{test:[/nexus\\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:\"Nexus\"}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return\"blackberry\"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:\"BlackBerry\"}}},{test:function(e){return\"bada\"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return\"windows phone\"===e.getBrowserName()},describe:function(){return{type:s.PLATFORMS_MAP.mobile,vendor:\"Microsoft\"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(\".\")[0]);return\"android\"===e.getOSName(!0)&&t>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){return\"android\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return\"macos\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop,vendor:\"Apple\"}}},{test:function(e){return\"windows\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return\"linux\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return\"playstation 4\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}},{test:function(e){return\"roku\"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){\"use strict\";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},s=r(18);var a=[{test:function(e){return\"microsoft edge\"===e.getBrowserName(!0)},describe:function(e){if(/\\sedg\\//i.test(e))return{name:s.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\\/(\\d+(\\.?_?\\d+)+)/i,e);return{name:s.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:s.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:s.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:s.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\\/537\\.36/i],describe:function(){return{name:s.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:s.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\\/(\\d+(\\.?_?\\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}})}));","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaultPixelRatio = 1;\n\nfunction pixelRatio() {\n  if (typeof window !== 'undefined') {\n    if (window.devicePixelRatio) {\n      return window.devicePixelRatio;\n    }\n    else {\n      var screen = window.screen;\n      if (screen && screen.deviceXDPI && screen.logicalXDPI) {\n        return screen.deviceXDPI / screen.logicalXDPI;\n      } else if (screen && screen.systemXDPI && screen.logicalXDPI) {\n        return screen.systemXDPI / screen.logicalXDPI;\n      }\n    }\n  }\n  return defaultPixelRatio;\n}\n\nmodule.exports = pixelRatio;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Returns whether n is a power of two.\nfunction ispot(n) {\n  return (n & (n - 1)) == 0;\n}\n\nmodule.exports = ispot;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n\nfunction prefixProperty(property) {\n\n  var style = document.documentElement.style;\n  var prefixList = ['Moz', 'Webkit', 'Khtml', 'O', 'ms'];\n\n  for (var i = 0; i < prefixList.length; i++) {\n    var prefix = prefixList[i];\n    var capitalizedProperty = property[0].toUpperCase() + property.slice(1);\n    var prefixedProperty = prefix + capitalizedProperty;\n\n    if (prefixedProperty in style) {\n      return prefixedProperty;\n    }\n  }\n\n  return property;\n\n}\n\n\nfunction getWithVendorPrefix(property) {\n  var prefixedProperty = prefixProperty(property);\n  return function getPropertyWithVendorPrefix(element) {\n    return element.style[prefixedProperty];\n  };\n\n}\n\n\nfunction setWithVendorPrefix(property) {\n  var prefixedProperty = prefixProperty(property);\n  return function setPropertyWithVendorPrefix(element, val) {\n    return (element.style[prefixedProperty] = val);\n  };\n}\n\n\nvar setTransform = setWithVendorPrefix('transform');\nvar setTransformOrigin = setWithVendorPrefix('transformOrigin');\n\n\nfunction setNullTransform(element) {\n  setTransform(element, 'translateZ(0)');\n}\n\n\nfunction setNullTransformOrigin(element) {\n  setTransformOrigin(element, '0 0 0');\n}\n\n\nfunction setAbsolute(element) {\n  element.style.position = 'absolute';\n}\n\n\nfunction setPixelPosition(element, x, y) {\n  element.style.left = x + 'px';\n  element.style.top = y + 'px';\n}\n\n\nfunction setPixelSize(element, width, height) {\n  element.style.width = width + 'px';\n  element.style.height = height + 'px';\n}\n\n\nfunction setNullSize(element) {\n  element.style.width = element.style.height = 0;\n}\n\n\nfunction setFullSize(element) {\n  element.style.width = element.style.height = '100%';\n}\n\n\nfunction setOverflowHidden(element) {\n  element.style.overflow = 'hidden';\n}\n\n\nfunction setOverflowVisible(element) {\n  element.style.overflow = 'visible';\n}\n\n\nfunction setNoPointerEvents(element) {\n  element.style.pointerEvents = 'none';\n}\n\n\nfunction setBlocking(element) {\n  element.style.backgroundColor = '#000';\n  element.style.opacity = '0';\n  element.style.filter = 'alpha(opacity=0)';\n}\n\n\nmodule.exports = {\n  prefixProperty: prefixProperty,\n  getWithVendorPrefix: getWithVendorPrefix,\n  setWithVendorPrefix: setWithVendorPrefix,\n  setTransform: setTransform,\n  setTransformOrigin: setTransformOrigin,\n  setNullTransform: setNullTransform,\n  setNullTransformOrigin: setNullTransformOrigin,\n  setAbsolute: setAbsolute,\n  setPixelPosition: setPixelPosition,\n  setPixelSize: setPixelSize,\n  setNullSize: setNullSize,\n  setFullSize: setFullSize,\n  setOverflowHidden: setOverflowHidden,\n  setOverflowVisible: setOverflowVisible,\n  setNoPointerEvents: setNoPointerEvents,\n  setBlocking: setBlocking\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Stage = require('./Stage');\nvar HtmlImageLoader = require('../loaders/HtmlImage');\nvar browser = require('bowser');\nvar inherits = require('../util/inherits');\nvar pixelRatio = require('../util/pixelRatio');\nvar ispot = require('../util/ispot');\nvar setAbsolute = require('../util/dom').setAbsolute;\nvar setFullSize = require('../util/dom').setFullSize;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// TODO(tjgq): Unify Stage and WebGlStage.\n\n// Browser-specific workarounds.\nvar browserQuirks = {\n  // Whether to use texImage2D instead of texSubImage2D when repainting an\n  // existing texture from a video element. On most browsers texSubImage2D is\n  // faster, but on Chrome the performance degrades significantly. See:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=612542\n  videoUseTexImage2D: browser.chrome\n};\n\n\nfunction initWebGlContext(canvas, opts) {\n  var options = {\n    alpha: true,\n    premultipliedAlpha: true,\n    antialias: !!(opts && opts.antialias),\n    preserveDrawingBuffer: !!(opts && opts.preserveDrawingBuffer)\n  };\n\n  var gl = (canvas.getContext) && (canvas.getContext('webgl', options) || canvas.getContext('experimental-webgl', options));\n\n  if (!gl) {\n    throw new Error('Could not get WebGL context');\n  }\n\n  if (opts.wrapContext) {\n    gl = opts.wrapContext(gl);\n  }\n\n  return gl;\n}\n\n/**\n * @class WebGlStage\n * @extends Stage\n * @classdesc\n *\n * A {@link Stage} implementation using WebGl.\n *\n * @param {Object} opts\n * @param {boolean} [opts.antialias=false]\n * @param {boolean} [opts.preserveDrawingBuffer=false]\n * @param {boolean} [opts.generateMipmaps=false]\n * @param {function} [opts.wrapContext]\n *\n * The `antialias` and `preserveDrawingBuffer` options control the WebGL\n * context attributes of the same name. The `alpha` and `premultipliedAlpha`\n * WebGL context attributes are set to their default true value and cannot\n * be overriden; this allows semitransparent textures to be composited with\n * the page. See:\n * https://www.khronos.org/registry/webgl/specs/1.0/#WEBGLCONTEXTATTRIBUTES\n *\n * The `generateMipmaps` option controls texture mipmap generation. Mipmaps\n * may improve rendering quality, at the cost of increased memory usage.\n * Due to technical limitations, they are only generated for textures whose\n * dimensions are a power of two. See:\n * https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n *\n * The `wrapContext` option is a function that receives and returns a\n * WebGLRenderingContext. The stage will use its return value as the context.\n * This is useful when used together with WebGLDebugUtils to debug WebGL issues.\n * See https://www.khronos.org/webgl/wiki/Debugging.\n *\n * Also see the available {@link Stage} options.\n */\nfunction WebGlStage(opts) {\n  opts = opts || {};\n\n  var self = this;\n\n  this.constructor.super_.call(this, opts);\n\n  this._generateMipmaps = opts.generateMipmaps != null ?\n    opts.generateMipmaps : false;\n\n  this._loader = new HtmlImageLoader(this);\n\n  this._domElement = document.createElement('canvas');\n\n  setAbsolute(this._domElement);\n  setFullSize(this._domElement);\n\n  this._gl = initWebGlContext(this._domElement, opts);\n\n  this._handleContextLoss = function() {\n    self.emit('webglcontextlost');\n    self._gl = null;\n  };\n\n  // Handle WebGl context loss.\n  this._domElement.addEventListener('webglcontextlost', this._handleContextLoss);\n\n  // WebGl renderers are singletons for a given stage. This list stores the\n  // existing renderers so they can be reused across layers with the same\n  // geometry and view type.\n  this._rendererInstances = [];\n}\n\ninherits(WebGlStage, Stage);\n\n\n/**\n * Destructor.\n */\nWebGlStage.prototype.destroy = function() {\n  this._domElement.removeEventListener('webglcontextlost', this._handleContextLoss);\n  // Delegate clearing own properties to the Stage destructor.\n  this.constructor.super_.prototype.destroy.call(this);\n};\n\n\n/**\n * Returns the underlying DOM element.\n *\n * @return {Element}\n */\nWebGlStage.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * Returns the underlying WebGL rendering context.\n *\n * @return {WebGLRenderingContext }\n */\nWebGlStage.prototype.webGlContext = function() {\n  return this._gl;\n};\n\n\nWebGlStage.prototype.setSizeForType = function() {\n  // Update the size of the canvas coordinate space.\n  //\n  // The size is obtained by taking the stage dimensions, which are set in CSS\n  // pixels, and multiplying them by the device pixel ratio. Crucially, this\n  // must be the only place where the WebGL rendering pipeline accesses the\n  // pixel ratio; subsequent uses should reference the `drawingBufferWidth` and\n  // `drawingBufferHeight` properties on the WebGLRenderingContext. Failing to\n  // do so will break the rendering if the pixel ratio changes but the stage\n  // size does not, e.g. when moving the window across screens.\n  var ratio = pixelRatio();\n  this._domElement.width = ratio * this._width;\n  this._domElement.height = ratio * this._height;\n};\n\n\nWebGlStage.prototype.loadImage = function(url, rect, done) {\n  return this._loader.loadImage(url, rect, done);\n};\n\n\nWebGlStage.prototype.maxTextureSize = function() {\n  return this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE);\n};\n\n\nWebGlStage.prototype.validateLayer = function(layer) {\n  var tileSize = layer.geometry().maxTileSize();\n  var maxTextureSize = this.maxTextureSize();\n  if (tileSize > maxTextureSize) {\n    throw new Error('Layer has level with tile size larger than maximum texture size (' + tileSize + ' vs. ' + maxTextureSize + ')');\n  }\n};\n\n\nWebGlStage.prototype.createRenderer = function(Renderer) {\n  var rendererInstances = this._rendererInstances;\n  for (var i = 0; i < rendererInstances.length; i++) {\n    if (rendererInstances[i] instanceof Renderer) {\n      return rendererInstances[i];\n    }\n  }\n  var renderer = new Renderer(this._gl);\n  rendererInstances.push(renderer);\n  return renderer;\n};\n\n\nWebGlStage.prototype.destroyRenderer = function(renderer) {\n  var rendererInstances = this._rendererInstances;\n  if (this._renderers.indexOf(renderer) < 0) {\n    renderer.destroy();\n    var index = rendererInstances.indexOf(renderer);\n    if (index >= 0) {\n      rendererInstances.splice(index, 1);\n    }\n  }\n};\n\n\nWebGlStage.prototype.startFrame = function() {\n\n  var gl = this._gl;\n\n  if (!gl) {\n    throw new Error('Bad WebGL context - maybe context was lost?');\n  }\n\n  // Set the WebGL viewport.\n  gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n  // Clear framebuffer.\n  gl.clearColor(0.0, 0.0, 0.0, 0.0);\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n  // Enable depth testing.\n  gl.enable(gl.DEPTH_TEST);\n\n  // Enable blending. ONE and ONE_MINUS_SRC_ALPHA are the right choices for\n  // premultiplied textures.\n  gl.enable(gl.BLEND);\n  gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n};\n\n\nWebGlStage.prototype.endFrame = function() {};\n\n\nWebGlStage.prototype.takeSnapshot = function(options) {\n\n  // Validate passed argument\n  if (typeof options !== 'object' || options == null) {\n    options = {};\n  }\n\n  var quality = options.quality;\n\n  // Set default quality if it is not passed\n  if (typeof quality == 'undefined') {\n    quality = 75;\n  }\n\n  // Throw if quality is of invlid type or out of bounds\n  if (typeof quality !== 'number' || quality < 0 || quality > 100) {\n    throw new Error('WebGLStage: Snapshot quality needs to be a number between 0 and 100');\n  }\n\n  // Canvas method \"toDataURL\" needs to be called in the same\n  // context as where the actual rendering is done. Hence this.\n  this.render();\n\n  // Return the snapshot\n  return this._domElement.toDataURL('image/jpeg', quality / 100);\n}\n\n\nWebGlStage.type = WebGlStage.prototype.type = 'webgl';\n\n\nfunction WebGlTexture(stage, tile, asset) {\n  this._stage = stage;\n  this._gl = stage._gl;\n  this._texture = null;\n  this._timestamp = null;\n  this._width = this._height = null;\n  this.refresh(tile, asset);\n}\n\n\nWebGlTexture.prototype.refresh = function(tile, asset) {\n\n  var gl = this._gl;\n  var stage = this._stage;\n  var texture;\n\n  // Check whether the texture needs to be updated.\n  var timestamp = asset.timestamp();\n  if (timestamp === this._timestamp) {\n    return;\n  }\n\n  // Get asset element.\n  var element = asset.element();\n\n  // Get asset dimensions.\n  var width = asset.width();\n  var height = asset.height();\n\n  if (width !== this._width || height !== this._height) {\n\n    // If the texture dimensions have changed since the last refresh, create\n    // a new texture with the correct size.\n\n    // Check if texture dimensions would exceed the maximum texture size.\n    var maxSize = stage.maxTextureSize();\n    if (width > maxSize) {\n      throw new Error('Texture width larger than max size (' + width + ' vs. ' + maxSize + ')');\n    }\n    if (height > maxSize) {\n      throw new Error('Texture height larger than max size (' + height + ' vs. ' + maxSize + ')');\n    }\n\n    // Delete the current texture if it exists.\n    // This is necessary for Chrome on Android. If it isn't done the textures\n    // do not render when the size changes.\n    if (this._texture) {\n      gl.deleteTexture(texture);\n    }\n\n    // The texture must be premultiplied by alpha to ensure correct blending of\n    // semitransparent textures. For details, see:\n    // http://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\n    texture = this._texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, element);\n\n  } else {\n\n    // If the texture dimensions remain the same, repaint the existing texture.\n    // Repainting with texSubImage2D is usually faster than with texImage2D,\n    // except in the case noted in browserQuirks.\n\n    texture = this._texture;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\n    if (element instanceof HTMLVideoElement && browserQuirks.videoUseTexImage2D) {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, element);\n    } else {\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, element);\n    }\n\n  }\n\n  // Generate mipmap if the corresponding stage option is set and the texture\n  // dimensions are powers of two.\n  if (stage._generateMipmaps && ispot(width) && ispot(height)) {\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n    gl.generateMipmap(gl.TEXTURE_2D);\n  } else {\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  }\n\n  // Clamp texture to edges.\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n  // Unbind texture.\n  gl.bindTexture(gl.TEXTURE_2D, null);\n\n  // Update texture dimensions and timestamp.\n  this._timestamp = timestamp;\n  this._width = width;\n  this._height = height;\n\n};\n\n\nWebGlTexture.prototype.destroy = function() {\n  if (this._texture) {\n    this._gl.deleteTexture(this._texture);\n  }\n  clearOwnProperties(this);\n};\n\n\nWebGlStage.TextureClass = WebGlStage.prototype.TextureClass = WebGlTexture;\n\n\nmodule.exports = WebGlStage;\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x2 Matrix\r\n * @module mat2\r\n */\n\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Create a new mat2 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out A new 2x2 matrix\r\n */\n\nexport function fromValues(m00, m01, m10, m11) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Set the components of a mat2 to the given values\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out\r\n */\n\nexport function set(out, m00, m01, m10, m11) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m10;\n  out[3] = m11;\n  return out;\n}\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache\n  // some values\n  if (out === a) {\n    var a1 = a[1];\n    out[1] = a[2];\n    out[2] = a1;\n  } else {\n    out[0] = a[0];\n    out[1] = a[2];\n    out[2] = a[1];\n    out[3] = a[3];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3]; // Calculate the determinant\n\n  var det = a0 * a3 - a2 * a1;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = a3 * det;\n  out[1] = -a1 * det;\n  out[2] = -a2 * det;\n  out[3] = a0 * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {mat2} out\r\n */\n\nexport function adjoint(out, a) {\n  // Caching this value is nessecary if out == a\n  var a0 = a[0];\n  out[0] = a[3];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a0;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[2] * a[1];\n}\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  return out;\n}\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  return out;\n}\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.scale(dest, dest, vec);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {ReadonlyMat2} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {ReadonlyMat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3]);\n}\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {ReadonlyMat2} L the lower triangular matrix\r\n * @param {ReadonlyMat2} D the diagonal matrix\r\n * @param {ReadonlyMat2} U the upper triangular matrix\r\n * @param {ReadonlyMat2} a the input matrix to factorize\r\n */\n\nexport function LDU(L, D, U, a) {\n  L[2] = a[2] / a[0];\n  U[0] = a[0];\n  U[1] = a[1];\n  U[3] = a[3] - L[2] * U[1];\n  return [L, D, U];\n}\n/**\r\n * Adds two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @returns {mat2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2} a The first matrix.\r\n * @param {ReadonlyMat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {ReadonlyMat2} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2} out the receiving vector\r\n * @param {ReadonlyMat2} a the first operand\r\n * @param {ReadonlyMat2} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2x3 Matrix\r\n * @module mat2d\r\n * @description\r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, b,\r\n *  c, d,\r\n *  tx, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, b, 0,\r\n *  c, d, 0,\r\n *  tx, ty, 1]\r\n * </pre>\r\n * The last column is ignored so the array is shorter and operations are faster.\r\n */\n\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(6);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[4] = 0;\n    out[5] = 0;\n  }\n\n  out[0] = 1;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  return out;\n}\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Create a new mat2d with the given values\r\n *\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} A new mat2d\r\n */\n\nexport function fromValues(a, b, c, d, tx, ty) {\n  var out = new glMatrix.ARRAY_TYPE(6);\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Set the components of a mat2d to the given values\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} out\r\n */\n\nexport function set(out, a, b, c, d, tx, ty) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  out[4] = tx;\n  out[5] = ty;\n  return out;\n}\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\n\nexport function invert(out, a) {\n  var aa = a[0],\n      ab = a[1],\n      ac = a[2],\n      ad = a[3];\n  var atx = a[4],\n      aty = a[5];\n  var det = aa * ad - ab * ac;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = ad * det;\n  out[1] = -ab * det;\n  out[2] = -ac * det;\n  out[3] = aa * det;\n  out[4] = (ac * aty - ad * atx) * det;\n  out[5] = (ab * atx - aa * aty) * det;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  return a[0] * a[3] - a[1] * a[2];\n}\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  out[0] = a0 * b0 + a2 * b1;\n  out[1] = a1 * b0 + a3 * b1;\n  out[2] = a0 * b2 + a2 * b3;\n  out[3] = a1 * b2 + a3 * b3;\n  out[4] = a0 * b4 + a2 * b5 + a4;\n  out[5] = a1 * b4 + a3 * b5 + a5;\n  return out;\n}\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  out[0] = a0 * c + a2 * s;\n  out[1] = a1 * c + a3 * s;\n  out[2] = a0 * -s + a2 * c;\n  out[3] = a1 * -s + a3 * c;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function scale(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0 * v0;\n  out[1] = a1 * v0;\n  out[2] = a2 * v1;\n  out[3] = a3 * v1;\n  out[4] = a4;\n  out[5] = a5;\n  return out;\n}\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to translate\r\n * @param {ReadonlyVec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\n\nexport function translate(out, a, v) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var v0 = v[0],\n      v1 = v[1];\n  out[0] = a0;\n  out[1] = a1;\n  out[2] = a2;\n  out[3] = a3;\n  out[4] = a0 * v0 + a2 * v1 + a4;\n  out[5] = a1 * v0 + a3 * v1 + a5;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = -s;\n  out[3] = c;\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.scale(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = v[1];\n  out[4] = 0;\n  out[5] = 0;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.translate(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat2d} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = v[0];\n  out[5] = v[1];\n  return out;\n}\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat2d(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {ReadonlyMat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], 1);\n}\n/**\r\n * Adds two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  return out;\n}\n/**\r\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2d} out the receiving vector\r\n * @param {ReadonlyMat2d} a the first operand\r\n * @param {ReadonlyMat2d} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2d} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat2d} a The first matrix.\r\n * @param {ReadonlyMat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));\n}\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat2d.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {ReadonlyMat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to translate\r\n * @param {ReadonlyVec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to rotate\r\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyVec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Calculates a 3x3 matrix from the given quaternion\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\r\n *\r\n * @returns {mat3} out\r\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {ReadonlyMat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {ReadonlyMat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {ReadonlyMat3} a the first operand\r\n * @param {ReadonlyMat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat3} a The first matrix.\r\n * @param {ReadonlyMat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {ReadonlyMat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyVec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {ReadonlyQuat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {ReadonlyVec3} v Translation vector\r\n * @param {ReadonlyVec3} s Scaling vector\r\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {ReadonlyQuat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {ReadonlyVec3} eye Position of the viewer\r\n * @param {ReadonlyVec3} center Point the viewer is looking at\r\n * @param {ReadonlyVec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {ReadonlyMat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {ReadonlyMat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {ReadonlyMat4} a the first operand\r\n * @param {ReadonlyMat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyMat4} a The first matrix.\r\n * @param {ReadonlyMat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {ReadonlyVec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the first operand\r\n * @param {ReadonlyVec3} b the second operand\r\n * @param {ReadonlyVec3} c the third operand\r\n * @param {ReadonlyVec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec3} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {ReadonlyVec3} a The vec3 point to rotate\r\n * @param {ReadonlyVec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {ReadonlyVec3} a The first operand\r\n * @param {ReadonlyVec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec3} a The first vector.\r\n * @param {ReadonlyVec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {ReadonlyVec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {ReadonlyVec4} result the receiving vector\r\n * @param {ReadonlyVec4} U the first vector\r\n * @param {ReadonlyVec4} V the second vector\r\n * @param {ReadonlyVec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the first operand\r\n * @param {ReadonlyVec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {ReadonlyVec4} a the vector to transform\r\n * @param {ReadonlyQuat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec4} a The first vector.\r\n * @param {ReadonlyVec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyVec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {ReadonlyQuat} a     Origin unit quaternion\r\n * @param  {ReadonlyQuat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {ReadonlyQuat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyMat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {ReadonlyQuat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {ReadonlyQuat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {ReadonlyQuat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat} a The first quaternion.\r\n * @param {ReadonlyQuat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat} a The first vector.\r\n * @param {ReadonlyQuat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {ReadonlyVec3} a the initial vector\r\n * @param {ReadonlyVec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {ReadonlyQuat} a the first operand\r\n * @param {ReadonlyQuat} b the second operand\r\n * @param {ReadonlyQuat} c the third operand\r\n * @param {ReadonlyQuat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\r\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\r\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as quat from \"./quat.js\";\nimport * as mat4 from \"./mat4.js\";\n/**\r\n * Dual Quaternion<br>\r\n * Format: [real, dual]<br>\r\n * Quaternion format: XYZW<br>\r\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\r\n * @module quat2\r\n */\n\n/**\r\n * Creates a new identity dual quat\r\n *\r\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\r\n */\n\nexport function create() {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    dq[0] = 0;\n    dq[1] = 0;\n    dq[2] = 0;\n    dq[4] = 0;\n    dq[5] = 0;\n    dq[6] = 0;\n    dq[7] = 0;\n  }\n\n  dq[3] = 1;\n  return dq;\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to clone\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function clone(a) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = a[0];\n  dq[1] = a[1];\n  dq[2] = a[2];\n  dq[3] = a[3];\n  dq[4] = a[4];\n  dq[5] = a[5];\n  dq[6] = a[6];\n  dq[7] = a[7];\n  return dq;\n}\n/**\r\n * Creates a new dual quat initialized with the given values\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  dq[4] = x2;\n  dq[5] = y2;\n  dq[6] = z2;\n  dq[7] = w2;\n  return dq;\n}\n/**\r\n * Creates a new dual quat from the given values (quat and translation)\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component (translation)\r\n * @param {Number} y2 Y component (translation)\r\n * @param {Number} z2 Z component (translation)\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\n\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n  var dq = new glMatrix.ARRAY_TYPE(8);\n  dq[0] = x1;\n  dq[1] = y1;\n  dq[2] = z1;\n  dq[3] = w1;\n  var ax = x2 * 0.5,\n      ay = y2 * 0.5,\n      az = z2 * 0.5;\n  dq[4] = ax * w1 + ay * z1 - az * y1;\n  dq[5] = ay * w1 + az * x1 - ax * z1;\n  dq[6] = az * w1 + ax * y1 - ay * x1;\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\n  return dq;\n}\n/**\r\n * Creates a dual quat from a quaternion and a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q a normalized quaternion\r\n * @param {ReadonlyVec3} t tranlation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotationTranslation(out, q, t) {\n  var ax = t[0] * 0.5,\n      ay = t[1] * 0.5,\n      az = t[2] * 0.5,\n      bx = q[0],\n      by = q[1],\n      bz = q[2],\n      bw = q[3];\n  out[0] = bx;\n  out[1] = by;\n  out[2] = bz;\n  out[3] = bw;\n  out[4] = ax * bw + ay * bz - az * by;\n  out[5] = ay * bw + az * bx - ax * bz;\n  out[6] = az * bw + ax * by - ay * bx;\n  out[7] = -ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Creates a dual quat from a translation\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyVec3} t translation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromTranslation(out, t) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = t[0] * 0.5;\n  out[5] = t[1] * 0.5;\n  out[6] = t[2] * 0.5;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a dual quat from a quaternion\r\n *\r\n * @param {ReadonlyQuat2} dual quaternion receiving operation result\r\n * @param {ReadonlyQuat} q the quaternion\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\n\nexport function fromRotation(out, q) {\n  out[0] = q[0];\n  out[1] = q[1];\n  out[2] = q[2];\n  out[3] = q[3];\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Creates a new dual quat from a matrix (4x4)\r\n *\r\n * @param {quat2} out the dual quaternion\r\n * @param {ReadonlyMat4} a the matrix\r\n * @returns {quat2} dual quat receiving operation result\r\n * @function\r\n */\n\nexport function fromMat4(out, a) {\n  //TODO Optimize this\n  var outer = quat.create();\n  mat4.getRotation(outer, a);\n  var t = new glMatrix.ARRAY_TYPE(3);\n  mat4.getTranslation(t, a);\n  fromRotationTranslation(out, outer, t);\n  return out;\n}\n/**\r\n * Copy the values from one dual quat to another\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the source dual quaternion\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Set a dual quat to the identity dual quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @returns {quat2} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  out[4] = 0;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  return out;\n}\n/**\r\n * Set the components of a dual quat to the given values\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n  out[0] = x1;\n  out[1] = y1;\n  out[2] = z1;\n  out[3] = w1;\n  out[4] = x2;\n  out[5] = y2;\n  out[6] = z2;\n  out[7] = w2;\n  return out;\n}\n/**\r\n * Gets the real part of a dual quat\r\n * @param  {quat} out real part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} real part\r\n */\n\nexport var getReal = quat.copy;\n/**\r\n * Gets the dual part of a dual quat\r\n * @param  {quat} out dual part\r\n * @param  {ReadonlyQuat2} a Dual Quaternion\r\n * @return {quat} dual part\r\n */\n\nexport function getDual(out, a) {\n  out[0] = a[4];\n  out[1] = a[5];\n  out[2] = a[6];\n  out[3] = a[7];\n  return out;\n}\n/**\r\n * Set the real component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the real part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport var setReal = quat.copy;\n/**\r\n * Set the dual component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat} q a quaternion representing the dual part\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function setDual(out, q) {\n  out[4] = q[0];\n  out[5] = q[1];\n  out[6] = q[2];\n  out[7] = q[3];\n  return out;\n}\n/**\r\n * Gets the translation of a normalized dual quat\r\n * @param  {vec3} out translation\r\n * @param  {ReadonlyQuat2} a Dual Quaternion to be decomposed\r\n * @return {vec3} translation\r\n */\n\nexport function getTranslation(out, a) {\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3];\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  return out;\n}\n/**\r\n * Translates a dual quat by the given vector\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to translate\r\n * @param {ReadonlyVec3} v vector to translate by\r\n * @returns {quat2} out\r\n */\n\nexport function translate(out, a, v) {\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3],\n      bx1 = v[0] * 0.5,\n      by1 = v[1] * 0.5,\n      bz1 = v[2] * 0.5,\n      ax2 = a[4],\n      ay2 = a[5],\n      az2 = a[6],\n      aw2 = a[7];\n  out[0] = ax1;\n  out[1] = ay1;\n  out[2] = az1;\n  out[3] = aw1;\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the X axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateX(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Y axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateY(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around the Z axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7],\n      ax1 = ax * bw + aw * bx + ay * bz - az * by,\n      ay1 = ay * bw + aw * by + az * bx - ax * bz,\n      az1 = az * bw + aw * bz + ax * by - ay * bx,\n      aw1 = aw * bw - ax * bx - ay * by - az * bz;\n  quat.rotateZ(out, a, rad);\n  bx = out[0];\n  by = out[1];\n  bz = out[2];\n  bw = out[3];\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (a * q)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatAppend(out, a, q) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n  ax = a[4];\n  ay = a[5];\n  az = a[6];\n  aw = a[7];\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n  return out;\n}\n/**\r\n * Rotates a dual quat by a given quaternion (q * a)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat} q quaternion to rotate by\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @returns {quat2} out\r\n */\n\nexport function rotateByQuatPrepend(out, q, a) {\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3],\n      bx = a[0],\n      by = a[1],\n      bz = a[2],\n      bw = a[3];\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n  bx = a[4];\n  by = a[5];\n  bz = a[6];\n  bw = a[7];\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n  return out;\n}\n/**\r\n * Rotates a dual quat around a given axis. Does the normalisation automatically\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the dual quaternion to rotate\r\n * @param {ReadonlyVec3} axis the axis to rotate around\r\n * @param {Number} rad how far the rotation should be\r\n * @returns {quat2} out\r\n */\n\nexport function rotateAroundAxis(out, a, axis, rad) {\n  //Special case for rad = 0\n  if (Math.abs(rad) < glMatrix.EPSILON) {\n    return copy(out, a);\n  }\n\n  var axisLength = Math.hypot(axis[0], axis[1], axis[2]);\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  var bx = s * axis[0] / axisLength;\n  var by = s * axis[1] / axisLength;\n  var bz = s * axis[2] / axisLength;\n  var bw = Math.cos(rad);\n  var ax1 = a[0],\n      ay1 = a[1],\n      az1 = a[2],\n      aw1 = a[3];\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n  var ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Adds two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  return out;\n}\n/**\r\n * Multiplies two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {quat2} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax0 = a[0],\n      ay0 = a[1],\n      az0 = a[2],\n      aw0 = a[3],\n      bx1 = b[4],\n      by1 = b[5],\n      bz1 = b[6],\n      bw1 = b[7],\n      ax1 = a[4],\n      ay1 = a[5],\n      az1 = a[6],\n      aw1 = a[7],\n      bx0 = b[0],\n      by0 = b[1],\n      bz0 = b[2],\n      bw0 = b[3];\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\n  return out;\n}\n/**\r\n * Alias for {@link quat2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a dual quat by a scalar number\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the dual quat to scale\r\n * @param {Number} b amount to scale the dual quat by\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  return out;\n}\n/**\r\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\r\n *\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = quat.dot;\n/**\r\n * Performs a linear interpolation between two dual quats's\r\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {ReadonlyQuat2} a the first operand\r\n * @param {ReadonlyQuat2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var mt = 1 - t;\n  if (dot(a, b) < 0) t = -t;\n  out[0] = a[0] * mt + b[0] * t;\n  out[1] = a[1] * mt + b[1] * t;\n  out[2] = a[2] * mt + b[2] * t;\n  out[3] = a[3] * mt + b[3] * t;\n  out[4] = a[4] * mt + b[4] * t;\n  out[5] = a[5] * mt + b[5] * t;\n  out[6] = a[6] * mt + b[6] * t;\n  out[7] = a[7] * mt + b[7] * t;\n  return out;\n}\n/**\r\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quat to calculate inverse of\r\n * @returns {quat2} out\r\n */\n\nexport function invert(out, a) {\n  var sqlen = squaredLength(a);\n  out[0] = -a[0] / sqlen;\n  out[1] = -a[1] / sqlen;\n  out[2] = -a[2] / sqlen;\n  out[3] = a[3] / sqlen;\n  out[4] = -a[4] / sqlen;\n  out[5] = -a[5] / sqlen;\n  out[6] = -a[6] / sqlen;\n  out[7] = a[7] / sqlen;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a dual quat\r\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {ReadonlyQuat2} a quat to calculate conjugate of\r\n * @returns {quat2} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  out[4] = -a[4];\n  out[5] = -a[5];\n  out[6] = -a[6];\n  out[7] = a[7];\n  return out;\n}\n/**\r\n * Calculates the length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\n\nexport var length = quat.length;\n/**\r\n * Alias for {@link quat2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a dual quat\r\n *\r\n * @param {ReadonlyQuat2} a dual quat to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = quat.squaredLength;\n/**\r\n * Alias for {@link quat2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a dual quat\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {ReadonlyQuat2} a dual quaternion to normalize\r\n * @returns {quat2} out\r\n * @function\r\n */\n\nexport function normalize(out, a) {\n  var magnitude = squaredLength(a);\n\n  if (magnitude > 0) {\n    magnitude = Math.sqrt(magnitude);\n    var a0 = a[0] / magnitude;\n    var a1 = a[1] / magnitude;\n    var a2 = a[2] / magnitude;\n    var a3 = a[3] / magnitude;\n    var b0 = a[4];\n    var b1 = a[5];\n    var b2 = a[6];\n    var b3 = a[7];\n    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = (b0 - a0 * a_dot_b) / magnitude;\n    out[5] = (b1 - a1 * a_dot_b) / magnitude;\n    out[6] = (b2 - a2 * a_dot_b) / magnitude;\n    out[7] = (b3 - a3 * a_dot_b) / magnitude;\n  }\n\n  return out;\n}\n/**\r\n * Returns a string representation of a dual quatenion\r\n *\r\n * @param {ReadonlyQuat2} a dual quaternion to represent as a string\r\n * @returns {String} string representation of the dual quat\r\n */\n\nexport function str(a) {\n  return \"quat2(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \")\";\n}\n/**\r\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quaternion.\r\n * @param {ReadonlyQuat2} b the second dual quaternion.\r\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\n}\n/**\r\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyQuat2} a the first dual quat.\r\n * @param {ReadonlyQuat2} b the second dual quat.\r\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));\n}","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {ReadonlyVec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {ReadonlyVec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the first operand\r\n * @param {ReadonlyVec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {ReadonlyVec2} a the vector to transform\r\n * @param {ReadonlyMat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {ReadonlyVec2} a The vec2 point to rotate\r\n * @param {ReadonlyVec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {ReadonlyVec2} a The first operand\r\n * @param {ReadonlyVec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {ReadonlyVec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {ReadonlyVec2} a The first vector.\r\n * @param {ReadonlyVec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\nmodule.exports = clamp;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// These are used to set the WebGl depth for a tile.\nvar MAX_LAYERS = 256; // Max number of layers per stage.\nvar MAX_LEVELS = 256; // Max number of levels per layer.\n\nvar clamp = require('../util/clamp');\nvar vec4 = require('gl-matrix').vec4;\nvar vec3 = require('gl-matrix').vec3;\nvar mat4 = require('gl-matrix').mat4;\n\n\nfunction createShader(gl, type, src) {\n  var shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw gl.getShaderInfoLog(shader);\n  }\n  return shader;\n}\n\n\nfunction createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList) {\n\n  var vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexSrc);\n  var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentSrc);\n\n  var shaderProgram = gl.createProgram();\n\n  gl.attachShader(shaderProgram, vertexShader);\n  gl.attachShader(shaderProgram, fragmentShader);\n  gl.linkProgram(shaderProgram);\n\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    throw gl.getProgramInfoLog(shaderProgram);\n  }\n\n  for (var i = 0; i < attribList.length; i++) {\n    var attrib = attribList[i];\n    shaderProgram[attrib] = gl.getAttribLocation(shaderProgram, attrib);\n    if (shaderProgram[attrib] === -1) {\n      throw new Error('Shader program has no ' + attrib + ' attribute');\n    }\n  }\n\n  for (var j = 0; j < uniformList.length; j++) {\n    var uniform = uniformList[j];\n    shaderProgram[uniform] = gl.getUniformLocation(shaderProgram, uniform);\n    if (shaderProgram[uniform] === -1) {\n      throw new Error('Shader program has no ' + uniform + ' uniform');\n    }\n  }\n\n  return shaderProgram;\n}\n\n\nfunction destroyShaderProgram(gl, shaderProgram) {\n  var shaderList = gl.getAttachedShaders(shaderProgram);\n  for (var i = 0; i < shaderList.length; i++) {\n    var shader = shaderList[i];\n    gl.detachShader(shaderProgram, shader);\n    gl.deleteShader(shader);\n  }\n  gl.deleteProgram(shaderProgram);\n}\n\n\nfunction createConstantBuffer(gl, target, usage, value) {\n  var buffer = gl.createBuffer();\n  gl.bindBuffer(target, buffer);\n  gl.bufferData(target, value, usage);\n  return buffer;\n}\n\n\nfunction createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords) {\n  return {\n    vertexIndices: createConstantBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, new Uint16Array(vertexIndices)),\n    vertexPositions: createConstantBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, new Float32Array(vertexPositions)),\n    textureCoords: createConstantBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, new Float32Array(textureCoords))\n  };\n}\n\n\nfunction destroyConstantBuffers(gl, constantBuffers) {\n  gl.deleteBuffer(constantBuffers.vertexIndices);\n  gl.deleteBuffer(constantBuffers.vertexPositions);\n  gl.deleteBuffer(constantBuffers.textureCoords);\n}\n\n\nfunction enableAttributes(gl, shaderProgram) {\n  var numAttrs = gl.getProgramParameter(shaderProgram, gl.ACTIVE_ATTRIBUTES);\n  for (var i = 0; i < numAttrs; i++) {\n    gl.enableVertexAttribArray(i);\n  }\n}\n\n\nfunction disableAttributes(gl, shaderProgram) {\n  var numAttrs = gl.getProgramParameter(shaderProgram, gl.ACTIVE_ATTRIBUTES);\n  for (var i = 0; i < numAttrs; i++) {\n    gl.disableVertexAttribArray(i);\n  }\n}\n\n\nfunction setTexture(gl, shaderProgram, texture) {\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(gl.TEXTURE_2D, texture._texture);\n  gl.uniform1i(shaderProgram.uSampler, 0);\n}\n\n\nfunction setDepth(gl, shaderProgram, layerZ, tileZ) {\n  var depth = (((layerZ + 1) * MAX_LEVELS) - tileZ) / (MAX_LEVELS * MAX_LAYERS);\n  gl.uniform1f(shaderProgram.uDepth, depth);\n}\n\n\nvar defaultOpacity = 1.0;\nvar defaultColorOffset = vec4.create();\nvar defaultColorMatrix = mat4.create();\nmat4.identity(defaultColorMatrix);\n\nfunction setupPixelEffectUniforms(gl, effects, uniforms) {\n  var opacity = defaultOpacity;\n  if (effects && effects.opacity != null) {\n    opacity = effects.opacity;\n  }\n  gl.uniform1f(uniforms.opacity, opacity);\n\n  var colorOffset = defaultColorOffset;\n  if (effects && effects.colorOffset) {\n    colorOffset = effects.colorOffset;\n  }\n  gl.uniform4fv(uniforms.colorOffset, colorOffset);\n\n  var colorMatrix = defaultColorMatrix;\n  if (effects && effects.colorMatrix) {\n    colorMatrix = effects.colorMatrix;\n  }\n  gl.uniformMatrix4fv(uniforms.colorMatrix, false, colorMatrix);\n}\n\n\n// Temporary vectors for setViewport.\nvar translateVector = vec3.create();\nvar scaleVector = vec3.create();\n\n\n// Sets the WebGL viewport and returns a viewport clamping compensation matrix.\n//\n// Negative viewport origin coordinates cause rendering issues. Letting the\n// viewport dimensions extend beyond the visible area do not seem to cause\n// rendering issues, but they may still have an impact on performance.\n// Therefore, when the scene's rect is not fully contained in the rendering\n// area, we clamp the viewport to the rendering area, and return a compensation\n// matrix to scale and translate vertices accordingly.\nfunction setViewport(gl, layer, rect, viewportMatrix) {\n  if (rect.x === 0 && rect.width === 1 && rect.y === 0 && rect.height === 1) {\n    // Fast path for full rect.\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    mat4.identity(viewportMatrix);\n    return;\n  }\n\n  var offsetX = rect.x;\n  var clampedOffsetX = clamp(offsetX, 0, 1);\n  var leftExcess = clampedOffsetX - offsetX;\n  var maxClampedWidth = 1 - clampedOffsetX;\n  var clampedWidth = clamp(rect.width - leftExcess, 0, maxClampedWidth);\n  var rightExcess = rect.width - clampedWidth;\n\n  var offsetY = 1 - rect.height - rect.y;\n  var clampedOffsetY = clamp(offsetY, 0, 1);\n  var bottomExcess = clampedOffsetY - offsetY;\n  var maxClampedHeight = 1 - clampedOffsetY;\n  var clampedHeight = clamp(rect.height - bottomExcess, 0, maxClampedHeight);\n  var topExcess = rect.height - clampedHeight;\n\n  vec3.set(\n    scaleVector,\n    rect.width / clampedWidth,\n    rect.height / clampedHeight,\n    1);\n\n  vec3.set(\n    translateVector,\n    (rightExcess - leftExcess) / clampedWidth,\n    (topExcess - bottomExcess) / clampedHeight,\n    0);\n\n  mat4.identity(viewportMatrix);\n  mat4.translate(viewportMatrix, viewportMatrix, translateVector);\n  mat4.scale(viewportMatrix, viewportMatrix, scaleVector);\n\n  gl.viewport(gl.drawingBufferWidth * clampedOffsetX,\n              gl.drawingBufferHeight * clampedOffsetY,\n              gl.drawingBufferWidth * clampedWidth,\n              gl.drawingBufferHeight * clampedHeight);\n}\n\nmodule.exports = {\n  createShaderProgram: createShaderProgram,\n  destroyShaderProgram: destroyShaderProgram,\n  createConstantBuffers: createConstantBuffers,\n  destroyConstantBuffers: destroyConstantBuffers,\n  enableAttributes: enableAttributes,\n  disableAttributes: disableAttributes,\n  setTexture: setTexture,\n  setDepth: setDepth,\n  setViewport: setViewport,\n  setupPixelEffectUniforms: setupPixelEffectUniforms\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'attribute vec3 aVertexPosition;',\n'attribute vec2 aTextureCoord;',\n\n'uniform float uDepth;',\n'uniform mat4 uViewportMatrix;',\n'uniform mat4 uProjMatrix;',\n\n'varying vec2 vTextureCoord;',\n\n'void main(void) {',\n'  gl_Position = uViewportMatrix * uProjMatrix * vec4(aVertexPosition.xy, 0.0, 1.0);',\n'  gl_Position.z = uDepth * gl_Position.w;',\n'  vTextureCoord = aTextureCoord;',\n'}'\n].join('\\n');\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'#ifdef GL_FRAGMENT_PRECISION_HIGH',\n'precision highp float;',\n'#else',\n'precision mediump float;',\n'#endif',\n\n'uniform sampler2D uSampler;',\n'uniform float uOpacity;',\n'uniform vec4 uColorOffset;',\n'uniform mat4 uColorMatrix;',\n\n'varying vec2 vTextureCoord;',\n\n'void main(void) {',\n'  vec4 color = texture2D(uSampler, vTextureCoord) * uColorMatrix + uColorOffset;',\n'  gl_FragColor = vec4(color.rgba * uOpacity);',\n'}'\n].join('\\n');\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mat4 = require('gl-matrix').mat4;\nvar vec3 = require('gl-matrix').vec3;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar WebGlCommon = require('./WebGlCommon');\nvar createConstantBuffers = WebGlCommon.createConstantBuffers;\nvar destroyConstantBuffers = WebGlCommon.destroyConstantBuffers;\nvar createShaderProgram = WebGlCommon.createShaderProgram;\nvar destroyShaderProgram = WebGlCommon.destroyShaderProgram;\nvar enableAttributes = WebGlCommon.enableAttributes;\nvar disableAttributes = WebGlCommon.disableAttributes;\nvar setViewport = WebGlCommon.setViewport;\nvar setupPixelEffectUniforms = WebGlCommon.setupPixelEffectUniforms;\n\nvar setDepth = WebGlCommon.setDepth;\nvar setTexture = WebGlCommon.setTexture;\n\nvar vertexSrc = require('../shaders/vertexNormal');\nvar fragmentSrc = require('../shaders/fragmentNormal');\n\nvar vertexIndices = [0, 1, 2, 0, 2, 3];\nvar vertexPositions = [-0.5, -0.5, 0.0, 0.5, -0.5, 0.0, 0.5, 0.5, 0.0, -0.5, 0.5, 0.0];\nvar textureCoords = [0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0];\n\nvar attribList = ['aVertexPosition', 'aTextureCoord'];\nvar uniformList = [\n  'uDepth', 'uOpacity', 'uSampler', 'uProjMatrix', 'uViewportMatrix',\n  'uColorOffset', 'uColorMatrix'\n];\n\n\nfunction WebGlBaseRenderer(gl) {\n  this.gl = gl;\n\n  // The projection matrix positions the tiles in world space.\n  // We compute it in Javascript because lack of precision in the vertex shader\n  // causes seams to appear between adjacent tiles at large zoom levels.\n  this.projMatrix = mat4.create();\n\n  // The viewport matrix responsible for viewport clamping.\n  // See setViewport() for an explanation of how it works.\n  this.viewportMatrix = mat4.create();\n\n  // Translation and scale vectors for tiles.\n  this.translateVector = vec3.create();\n  this.scaleVector = vec3.create();\n\n  this.constantBuffers = createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords);\n\n  this.shaderProgram = createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList);\n}\n\nWebGlBaseRenderer.prototype.destroy = function() {\n  destroyConstantBuffers(this.gl, this.constantBuffers);\n  destroyShaderProgram(this.gl, this.shaderProgram);\n  clearOwnProperties(this);\n};\n\nWebGlBaseRenderer.prototype.startLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var viewportMatrix = this.viewportMatrix;\n\n  gl.useProgram(shaderProgram);\n\n  enableAttributes(gl, shaderProgram);\n\n  setViewport(gl, layer, rect, viewportMatrix);\n  gl.uniformMatrix4fv(shaderProgram.uViewportMatrix, false, viewportMatrix);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.vertexPositions);\n  gl.vertexAttribPointer(shaderProgram.aVertexPosition, 3, gl.FLOAT, gl.FALSE, 0, 0);\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.textureCoords);\n  gl.vertexAttribPointer(shaderProgram.aTextureCoord, 2, gl.FLOAT, gl.FALSE, 0, 0);\n\n  setupPixelEffectUniforms(gl, layer.effects(), {\n    opacity: shaderProgram.uOpacity,\n    colorOffset: shaderProgram.uColorOffset,\n    colorMatrix: shaderProgram.uColorMatrix\n  });\n};\n\n\nWebGlBaseRenderer.prototype.endLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  disableAttributes(gl, shaderProgram);\n};\n\n\nWebGlBaseRenderer.prototype.renderTile = function(tile, texture, layer, layerZ) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var projMatrix = this.projMatrix;\n  var translateVector = this.translateVector;\n  var scaleVector = this.scaleVector;\n\n  translateVector[0] = tile.centerX();\n  translateVector[1] = tile.centerY();\n  translateVector[2] = -0.5;\n\n  scaleVector[0] = tile.scaleX();\n  scaleVector[1] = tile.scaleY();\n  scaleVector[2] = 1.0;\n\n  mat4.copy(projMatrix, layer.view().projection());\n  mat4.rotateX(projMatrix, projMatrix, tile.rotX());\n  mat4.rotateY(projMatrix, projMatrix, tile.rotY());\n  mat4.translate(projMatrix, projMatrix, translateVector);\n  mat4.scale(projMatrix, projMatrix, scaleVector);\n\n  gl.uniformMatrix4fv(shaderProgram.uProjMatrix, false, projMatrix);\n\n  setDepth(gl, shaderProgram, layerZ, tile.z);\n\n  setTexture(gl, shaderProgram, texture);\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, constantBuffers.vertexIndices);\n  gl.drawElements(gl.TRIANGLES, vertexIndices.length, gl.UNSIGNED_SHORT, 0);\n};\n\n\nmodule.exports = WebGlBaseRenderer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlBaseRenderer = require('./WebGlBase');\nvar inherits = require('../util/inherits');\n\n/**\n * @class WebGlCubeRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link CubeGeometry} and {@link RectilinearView}, appropriate\n * for a {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlCubeRenderer() {\n  this.constructor.super_.apply(this, arguments);\n}\n\ninherits(WebGlCubeRenderer, WebGlBaseRenderer);\n\nmodule.exports = WebGlCubeRenderer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlBaseRenderer = require('./WebGlBase');\nvar inherits = require('../util/inherits');\n\n/**\n * @class WebGlFlatRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link FlatGeometry} and {@link FlatView}, appropriate for a\n * {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlFlatRenderer() {\n  this.constructor.super_.apply(this, arguments);\n}\n\ninherits(WebGlFlatRenderer, WebGlBaseRenderer);\n\nmodule.exports = WebGlFlatRenderer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'attribute vec3 aVertexPosition;',\n\n'uniform float uDepth;',\n'uniform mat4 uViewportMatrix;',\n'uniform mat4 uInvProjMatrix;',\n\n'varying vec4 vRay;',\n\n'void main(void) {',\n'  vRay = uInvProjMatrix * vec4(aVertexPosition.xy, 1.0, 1.0);',\n'  gl_Position = uViewportMatrix * vec4(aVertexPosition.xy, uDepth, 1.0);',\n'}'\n].join('\\n');\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = [\n'#ifdef GL_FRAGMENT_PRECISION_HIGH',\n'precision highp float;',\n'#else',\n'precision mediump float',\n'#endif',\n\n'uniform sampler2D uSampler;',\n'uniform float uOpacity;',\n'uniform float uTextureX;',\n'uniform float uTextureY;',\n'uniform float uTextureWidth;',\n'uniform float uTextureHeight;',\n'uniform vec4 uColorOffset;',\n'uniform mat4 uColorMatrix;',\n\n'varying vec4 vRay;',\n\n'const float PI = 3.14159265358979323846264;',\n\n'void main(void) {',\n'  float r = inversesqrt(vRay.x * vRay.x + vRay.y * vRay.y + vRay.z * vRay.z);',\n'  float phi  = acos(vRay.y * r);',\n'  float theta = atan(vRay.x, -1.0*vRay.z);',\n'  float s = 0.5 + 0.5 * theta / PI;',\n'  float t = 1.0 - phi / PI;',\n\n'  s = s * uTextureWidth + uTextureX;',\n'  t = t * uTextureHeight + uTextureY;',\n\n'  vec4 color = texture2D(uSampler, vec2(s, t)) * uColorMatrix + uColorOffset;',\n'  gl_FragColor = vec4(color.rgba * uOpacity);',\n'}'\n].join('\\n');\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mat4 = require('gl-matrix').mat4;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar WebGlCommon = require('./WebGlCommon');\nvar createConstantBuffers = WebGlCommon.createConstantBuffers;\nvar destroyConstantBuffers = WebGlCommon.destroyConstantBuffers;\nvar createShaderProgram = WebGlCommon.createShaderProgram;\nvar destroyShaderProgram = WebGlCommon.destroyShaderProgram;\nvar enableAttributes = WebGlCommon.enableAttributes;\nvar disableAttributes = WebGlCommon.disableAttributes;\nvar setViewport = WebGlCommon.setViewport;\nvar setupPixelEffectUniforms = WebGlCommon.setupPixelEffectUniforms;\n\nvar setDepth = WebGlCommon.setDepth;\nvar setTexture = WebGlCommon.setTexture;\n\nvar vertexSrc = require('../shaders/vertexEquirect');\nvar fragmentSrc = require('../shaders/fragmentEquirect');\n\nvar vertexIndices = [0, 1, 2, 0, 2, 3];\nvar vertexPositions = [-1.0, -1.0, 0.0, 1.0, -1.0, 0.0, 1.0, 1.0, 0.0, -1.0, 1.0, 0.0];\nvar textureCoords = [0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0];\n\nvar attribList = ['aVertexPosition'];\nvar uniformList = [\n  'uDepth', 'uOpacity', 'uSampler', 'uInvProjMatrix', 'uViewportMatrix',\n  'uColorOffset', 'uColorMatrix', 'uTextureX', 'uTextureY', 'uTextureWidth',\n  'uTextureHeight'\n];\n\n\n/**\n * @class WebGlEquirectRenderer\n * @implements Renderer\n * @classdesc\n *\n * A renderer for {@link EquirectGeometry} and {@link RectilinearView},\n * appropriate for {@link WebGlStage}.\n *\n * Most users do not need to instantiate this class. Renderers are created and\n * destroyed by {@link Stage} as necessary.\n */\nfunction WebGlEquirectRenderer(gl) {\n  this.gl = gl;\n\n  // The inverse projection matrix.\n  this.invProjMatrix = mat4.create();\n\n  // The viewport matrix responsible for viewport clamping.\n  // See setViewport() for an explanation of how it works.\n  this.viewportMatrix = mat4.create();\n\n  this.constantBuffers = createConstantBuffers(gl, vertexIndices, vertexPositions, textureCoords);\n\n  this.shaderProgram = createShaderProgram(gl, vertexSrc, fragmentSrc, attribList, uniformList);\n}\n\nWebGlEquirectRenderer.prototype.destroy = function() {\n  destroyConstantBuffers(this.gl, this.constantBuffers);\n  destroyShaderProgram(this.gl, this.shaderProgram);\n  clearOwnProperties(this);\n};\n\n\nWebGlEquirectRenderer.prototype.startLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n  var invProjMatrix = this.invProjMatrix;\n  var viewportMatrix = this.viewportMatrix;\n\n  gl.useProgram(shaderProgram);\n\n  enableAttributes(gl, shaderProgram);\n\n  setViewport(gl, layer, rect, viewportMatrix);\n  gl.uniformMatrix4fv(shaderProgram.uViewportMatrix, false, viewportMatrix);\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.vertexPositions);\n  gl.vertexAttribPointer(shaderProgram.aVertexPosition, 3, gl.FLOAT, gl.FALSE, 0, 0);\n  gl.bindBuffer(gl.ARRAY_BUFFER, constantBuffers.textureCoords);\n\n  // Compute and set the inverse projection matrix.\n  mat4.copy(invProjMatrix, layer.view().projection());\n  mat4.invert(invProjMatrix, invProjMatrix);\n\n  gl.uniformMatrix4fv(shaderProgram.uInvProjMatrix, false, invProjMatrix);\n\n  // Compute and set the texture scale and crop offsets.\n  var textureCrop = layer.effects().textureCrop || {};\n  var textureX = textureCrop.x != null ? textureCrop.x : 0;\n  var textureY = textureCrop.y != null ? textureCrop.y : 0;\n  var textureWidth = textureCrop.width != null ? textureCrop.width : 1;\n  var textureHeight = textureCrop.height != null ? textureCrop.height : 1;\n\n  gl.uniform1f(shaderProgram.uTextureX, textureX);\n  gl.uniform1f(shaderProgram.uTextureY, textureY);\n  gl.uniform1f(shaderProgram.uTextureWidth, textureWidth);\n  gl.uniform1f(shaderProgram.uTextureHeight, textureHeight);\n\n  setupPixelEffectUniforms(gl, layer.effects(), {\n    opacity: shaderProgram.uOpacity,\n    colorOffset: shaderProgram.uColorOffset,\n    colorMatrix: shaderProgram.uColorMatrix\n  });\n};\n\n\nWebGlEquirectRenderer.prototype.endLayer = function(layer, rect) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  disableAttributes(gl, shaderProgram);\n};\n\n\nWebGlEquirectRenderer.prototype.renderTile = function(tile, texture, layer, layerZ) {\n  var gl = this.gl;\n  var shaderProgram = this.shaderProgram;\n  var constantBuffers = this.constantBuffers;\n\n  setDepth(gl, shaderProgram, layerZ, tile.z);\n\n  setTexture(gl, shaderProgram, texture);\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, constantBuffers.vertexIndices);\n  gl.drawElements(gl.TRIANGLES, vertexIndices.length, gl.UNSIGNED_SHORT, 0);\n};\n\n\nmodule.exports = WebGlEquirectRenderer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WebGlCube = require('./WebGlCube');\nvar WebGlFlat = require('./WebGlFlat');\nvar WebGlEquirect = require('./WebGlEquirect');\n\n/**\n * Registers all known renderers for the given stage type into that stage.\n * Most users will not need to register renderers, as {@link Viewer} does it for\n * them.\n *\n * @param {Stage} stage The stage where the renderers are to be registered.\n * @throws An error if the stage type is unknown.\n */\nfunction registerDefaultRenderers(stage) {\n  switch (stage.type) {\n    case 'webgl':\n      stage.registerRenderer('flat', 'flat', WebGlFlat);\n      stage.registerRenderer('cube', 'rectilinear', WebGlCube);\n      stage.registerRenderer('equirect', 'rectilinear', WebGlEquirect);\n      break;\n    default:\n      throw new Error('Unknown stage type: ' + stage.type);\n  }\n}\n\nmodule.exports = registerDefaultRenderers;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Jenkins one-at-a-time hash\n// http://www.burtleburtle.net/bob/hash/doobs.html\n// Input: an array of integers\n// Output: an integer\n\nfunction hash() {\n  var h = 0;\n  for (var i = 0; i < arguments.length; i++) {\n    var k = arguments[i];\n    h += k;\n    h += k << 10;\n    h ^= k >> 6;\n  }\n  h += h << 3;\n  h ^= h >> 11;\n  h += h << 15;\n  return h >= 0 ? h : -h;\n}\n\nmodule.exports = hash;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Modulo operation\n *\n * @memberof util\n * @param {Number} dividend\n * @param {Number} divisor\n * @returns {Number} Value in range `[0,divisor[`\n */\nfunction mod(a, b) {\n  return (+a % (b = +b) + b) % b;\n}\n\nmodule.exports = mod;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\nvar defaultCapacity = 64;\n\n// A set data structure for elements implementing hash() and equals().\n// The capacity, if given, is just a hint; the set is allowed to exceed it, but\n// performance may suffer.\nfunction Set(capacity) {\n  if (capacity != null &&\n      (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 1)) {\n    throw new Error('Set: invalid capacity');\n  }\n  this._capacity = this._capacity || defaultCapacity;\n\n  this._buckets = [];\n  for (var i = 0; i < this._capacity; i++) {\n    this._buckets.push([]);\n  }\n  this._size = 0;\n}\n\n// Adds an element, replacing an existing element.\n// Returns the replaced element, or null if no element was replaced.\nSet.prototype.add = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      bucket[i] = element;\n      return existingElement;\n    }\n  }\n  bucket.push(element);\n  this._size++;\n  return null;\n};\n\n// Removes an element.\n// Returns the removed element, or null if the element was not found.\nSet.prototype.remove = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      // Splice manually to avoid Array#splice return value allocation.\n      for (var j = i; j < bucket.length - 1; j++) {\n        bucket[j] = bucket[j+1];\n      }\n      bucket.length = bucket.length - 1;\n      this._size--;\n      return existingElement;\n    }\n  }\n  return null;\n};\n\n// Returns whether an element is in the set.\nSet.prototype.has = function(element) {\n  var h = mod(element.hash(), this._capacity);\n  var bucket = this._buckets[h];\n  for (var i = 0; i < bucket.length; i++) {\n    var existingElement = bucket[i];\n    if (element.equals(existingElement)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of elements in the set.\nSet.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all elements from the set.\nSet.prototype.clear = function() {\n  for (var i = 0; i < this._capacity; i++) {\n    this._buckets[i].length = 0;\n  }\n  this._size = 0;\n};\n\n// Calls fn(element) for each element in the set, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the set is mutated during iteration.\nSet.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._capacity; i++) {\n    var bucket = this._buckets[i];\n    for (var j = 0; j < bucket.length; j++) {\n      fn(bucket[j]);\n      count += 1;\n    }\n  }\n  return count;\n};\n\nmodule.exports = Set;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Set = require('./collections/Set');\n\n/**\n * @class TileSearcher\n * @classdesc\n *\n * A TileSearcher performs searches for visible tiles.\n */\nfunction TileSearcher() {\n  // Stack of tiles to be explored.\n  this._stack = [];\n\n  // Set of already explored tiles.\n  this._visited = new Set();\n\n  // Tile vertices. Allocated by Tile#vertices on first use.\n  this._vertices = null;\n}\n\n/**\n * Performs a search for visible tiles by starting at a given tile and\n * recursively exploring neighbors until no more visible tiles are found.\n *\n * @param {View} view The view used to deem whether a tile is visible.\n * @param {Tile} tile The starting tile.\n * @param {Tile[]} result An array to append the visible tiles to, including the\n *     starting tile when visible. Existing array members are preserved.\n * @return {number} The number of visible tiles found.\n */\nTileSearcher.prototype.search = function(view, startingTile, result) {\n  var stack = this._stack;\n  var visited = this._visited;\n  var vertices = this._vertices;\n\n  var count = 0;\n\n  // Clear internal state.\n  this._clear();\n\n  stack.push(startingTile);\n\n  while (stack.length > 0) {\n    var tile = stack.pop();\n\n    if (visited.has(tile)) {\n      // Skip already visited tile.\n      continue;\n    }\n\n    if (!view.intersects(tile.vertices(vertices))) {\n      // Skip non-visible tile.\n      continue;\n    }\n\n    // Mark tile as visited.\n    visited.add(tile);\n\n    // Add neighbors to the stack of tiles to explore.\n    var neighbors = tile.neighbors();\n    for (var i = 0; i < neighbors.length; i++) {\n      stack.push(neighbors[i]);\n    }\n\n    // Add to result.\n    result.push(tile);\n\n    count++;\n  }\n\n  // Reuse the vertices array in future searches.\n  this._vertices = vertices;\n\n  // Clear internal state.\n  this._clear();\n\n  return count;\n};\n\nTileSearcher.prototype._clear = function() {\n  this._stack.length = 0;\n  this._visited.clear();\n};\n\nmodule.exports = TileSearcher;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\n// An LruMap holds up to a maximum number of key-value pairs, ordered by their\n// time of insertion. When the addition of a key-value pair would cause the\n// capacity to be exceeded, the oldest key-value pair in the set is evicted.\n// As a special case, an LruMap with zero capacity always rejects the insertion\n// of a key-value pair.\n//\n// Keys must implement hash() and equals(). Note that the implementation doesn't\n// currently use hash(), but a future version might.\nfunction LruMap(capacity) {\n  if (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 0) {\n    throw new Error('LruMap: invalid capacity');\n  }\n  this._capacity = capacity;\n\n  // Keys and values are stored in circular arrays ordered by decreasing age.\n  // Start is the index of the oldest key/value and size is the number of valid\n  // key/values; the region containing valid keys/values may wrap around.\n  this._keys = new Array(this._capacity);\n  this._values = new Array(this._capacity);\n  this._start = 0;\n  this._size = 0;\n}\n\nLruMap.prototype._index = function(i) {\n  return mod(this._start + i, this._capacity);\n};\n\n// Returns the value associated to the specified key, or null if not found.\nLruMap.prototype.get = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    var existingKey = this._keys[this._index(i)];\n    if (key.equals(existingKey)) {\n      return this._values[this._index(i)];\n    }\n  }\n  return null;\n};\n\n// Associates the specified value with the specified key, possibly replacing the\n// currently associated value. The key-value pair becomes the newest. If the map\n// is at capacity, the oldest key-value pair is removed. Returns the removed\n// key, or null otherwise. If the capacity is zero, does nothing and returns\n// the key.\nLruMap.prototype.set = function(key, value) {\n  if (this._capacity === 0) {\n    return key;\n  }\n  this.del(key);\n  var evictedKey =\n      this._size === this._capacity ? this._keys[this._index(0)] : null;\n  this._keys[this._index(this._size)] = key;\n  this._values[this._index(this._size)] = value;\n  if (this._size < this._capacity) {\n    this._size++;\n  } else {\n    this._start = this._index(1);\n  }\n  return evictedKey;\n};\n\n// Removes the key-value pair associated with the specified key.\n// Returns the removed value, or null if not found.\nLruMap.prototype.del = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    if (key.equals(this._keys[this._index(i)])) {\n      var existingValue = this._values[this._index(i)];\n      for (var j = i; j < this._size - 1; j++) {\n        this._keys[this._index(j)] = this._keys[this._index(j + 1)];\n        this._values[this._index(j)] = this._values[this._index(j + 1)];\n      }\n      this._size--;\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Returns whether there is a value associated with the specified key.\nLruMap.prototype.has = function(key) {\n  for (var i = 0; i < this._size; i++) {\n    if (key.equals(this._keys[this._index(i)])) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of key-value pairs in the map.\nLruMap.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all key-value pairs from the map.\nLruMap.prototype.clear = function() {\n  this._keys.length = 0;\n  this._values.length = 0;\n  this._start = 0;\n  this._size = 0;\n};\n\n// Calls fn(key, value) for each item in the map, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the map is mutated during iteration.\nLruMap.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._size; i++) {\n    fn(this._keys[this._index(i)], this._values[this._index(i)]);\n    count += 1;\n  }\n  return count;\n};\n\nmodule.exports = LruMap;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction Level(levelProperties) {\n  this._fallbackOnly = !!levelProperties.fallbackOnly;\n}\n\nLevel.prototype.numHorizontalTiles = function() {\n  return Math.ceil(this.width() / this.tileWidth());\n};\n\nLevel.prototype.numVerticalTiles = function() {\n  return Math.ceil(this.height() / this.tileHeight());\n};\n\nLevel.prototype.fallbackOnly = function() {\n  return this._fallbackOnly;\n};\n\nmodule.exports = Level;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction cmp(x, y) {\n  if (x < y) {\n    return -1;\n  }\n  if (x > y) {\n    return 1;\n  }\n  return 0;\n}\n\nmodule.exports = cmp;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar cmp = require('../util/cmp');\n\nfunction makeLevelList(levelPropertiesList, LevelClass) {\n  var list = [];\n\n  for (var i = 0; i < levelPropertiesList.length; i++) {\n    list.push(new LevelClass(levelPropertiesList[i]));\n  }\n\n  list.sort(function(level1, level2) {\n    return cmp(level1.width(), level2.width());\n  });\n\n  return list;\n}\n\nfunction makeSelectableLevelList(levelList) {\n  var list = [];\n\n  for (var i = 0; i < levelList.length; i++) {\n    if (!levelList[i]._fallbackOnly) {\n      list.push(levelList[i]);\n    }\n  }\n\n  if (!list.length) {\n    throw new Error('No selectable levels in list');\n  }\n\n  return list;\n}\n\nmodule.exports = {\n  makeLevelList: makeLevelList,\n  makeSelectableLevelList: makeSelectableLevelList\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction type(x) {\n  var typ = typeof x;\n  if (typ === 'object') {\n    if (x === null) {\n      return 'null';\n    }\n    if (Object.prototype.toString.call(x) === '[object Array]') {\n      return 'array';\n    }\n    if (Object.prototype.toString.call(x) === '[object RegExp]') {\n      return 'regexp';\n    }\n  }\n  return typ;\n}\n\nmodule.exports = type;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar TileSearcher = require('../TileSearcher');\nvar LruMap = require('../collections/LruMap');\nvar Level = require('./Level');\nvar makeLevelList = require('./common').makeLevelList;\nvar makeSelectableLevelList = require('./common').makeSelectableLevelList;\nvar clamp = require('../util/clamp');\nvar cmp = require('../util/cmp');\nvar type = require('../util/type');\nvar vec3 = require('gl-matrix').vec3;\nvar vec4 = require('gl-matrix').vec4;\n\nvar neighborsCacheSize = 64;\n\n// Initials for cube faces.\nvar faceList = 'fudlrb';\n\n// Rotation of each face, relative to the front face.\nvar faceRotation = {\n  f: { x: 0, y: 0 },\n  b: { x: 0, y: Math.PI },\n  l: { x: 0, y: Math.PI/2 },\n  r: { x: 0, y: -Math.PI/2 },\n  u: { x: Math.PI/2, y: 0 },\n  d: { x: -Math.PI/2, y: 0 }\n};\n\n// Zero vector.\nvar origin = vec3.create();\n\n// Rotate a vector in ZXY order.\nfunction rotateVector(vec, z, x, y) {\n  if (z) {\n    vec3.rotateZ(vec, vec, origin, z);\n  }\n  if (x) {\n    vec3.rotateX(vec, vec, origin, x);\n  }\n  if (y) {\n    vec3.rotateY(vec, vec, origin, y);\n  }\n}\n\n// Normalized vectors pointing to the center of each face.\nvar faceVectors = {};\nfor (var i = 0; i < faceList.length; i++) {\n  var face = faceList[i];\n  var rotation = faceRotation[face];\n  var v = vec3.fromValues(0,  0, -1);\n  rotateVector(v, 0, rotation.x, rotation.y);\n  faceVectors[face] = v;\n}\n\n// Map each face to its adjacent faces.\n// The order is as suggested by the front face.\nvar adjacentFace = {\n  f: [ 'l', 'r', 'u', 'd' ],\n  b: [ 'r', 'l', 'u', 'd' ],\n  l: [ 'b', 'f', 'u', 'd' ],\n  r: [ 'f', 'b', 'u', 'd' ],\n  u: [ 'l', 'r', 'b', 'f' ],\n  d: [ 'l', 'r', 'f', 'b' ]\n};\n\n// Offsets to apply to the (x,y) coordinates of a tile to get its neighbors.\nvar neighborOffsets = [\n  [  0,  1 ], // top\n  [  1,  0 ], // right\n  [  0, -1 ], // bottom\n  [ -1,  0 ]  // left\n];\n\n\n/**\n * @class CubeTile\n * @implements Tile\n * @classdesc\n *\n * A tile in a @{CubeGeometry}.\n */\nfunction CubeTile(face, x, y, z, geometry) {\n  this.face = face;\n  this.x = x;\n  this.y = y;\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nCubeTile.prototype.rotX = function() {\n  return faceRotation[this.face].x;\n};\n\n\nCubeTile.prototype.rotY = function() {\n  return faceRotation[this.face].y;\n};\n\n\nCubeTile.prototype.centerX = function() {\n  return (this.x + 0.5) / this._level.numHorizontalTiles() - 0.5;\n};\n\n\nCubeTile.prototype.centerY = function() {\n  return 0.5 - (this.y + 0.5) / this._level.numVerticalTiles();\n};\n\n\nCubeTile.prototype.scaleX = function() {\n  return 1 / this._level.numHorizontalTiles();\n};\n\n\nCubeTile.prototype.scaleY = function() {\n  return 1 / this._level.numVerticalTiles();\n};\n\n\nCubeTile.prototype.vertices = function(result) {\n  if (!result) {\n    result = [vec3.create(), vec3.create(), vec3.create(), vec3.create()];\n  }\n\n  var rot = faceRotation[this.face];\n\n  function makeVertex(vec, x, y) {\n    vec3.set(vec, x, y, -0.5);\n    rotateVector(vec, 0, rot.x, rot.y);\n  }\n\n  var left = this.centerX() - this.scaleX() / 2;\n  var right = this.centerX() + this.scaleX() / 2;\n  var bottom = this.centerY() - this.scaleY() / 2;\n  var top = this.centerY() + this.scaleY() / 2;\n\n  makeVertex(result[0], left, top);\n  makeVertex(result[1], right, top);\n  makeVertex(result[2], right, bottom);\n  makeVertex(result[3], left, bottom);\n\n  return result;\n};\n\n\nCubeTile.prototype.parent = function() {\n\n  if (this.z === 0) {\n    return null;\n  }\n\n  var face = this.face;\n  var z = this.z;\n  var x = this.x;\n  var y = this.y;\n\n  var geometry = this._geometry;\n  var level = geometry.levelList[z];\n  var parentLevel = geometry.levelList[z-1];\n\n  var tileX = Math.floor(x / level.numHorizontalTiles() * parentLevel.numHorizontalTiles());\n  var tileY = Math.floor(y / level.numVerticalTiles() * parentLevel.numVerticalTiles());\n  var tileZ = z-1;\n\n  return new CubeTile(face, tileX, tileY, tileZ, geometry);\n\n};\n\n\nCubeTile.prototype.children = function(result) {\n\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n\n  var face = this.face;\n  var z = this.z;\n  var x = this.x;\n  var y = this.y;\n\n  var geometry = this._geometry;\n  var level = geometry.levelList[z];\n  var childLevel = geometry.levelList[z+1];\n\n  var nHoriz = childLevel.numHorizontalTiles() / level.numHorizontalTiles();\n  var nVert = childLevel.numVerticalTiles() / level.numVerticalTiles();\n\n  result = result || [];\n\n  for (var h = 0; h < nHoriz; h++) {\n    for (var v = 0; v < nVert; v++) {\n      var tileX = nHoriz * x + h;\n      var tileY = nVert * y + v;\n      var tileZ = z+1;\n      result.push(new CubeTile(face, tileX, tileY, tileZ, geometry));\n    }\n  }\n\n  return result;\n\n};\n\n\nCubeTile.prototype.neighbors = function() {\n\n  var geometry = this._geometry;\n  var cache = geometry._neighborsCache;\n\n  // Satisfy from cache when available.\n  var cachedResult = cache.get(this);\n  if (cachedResult) {\n    return cachedResult;\n  }\n\n  var vec = geometry._vec;\n\n  var face = this.face;\n  var x = this.x;\n  var y = this.y;\n  var z = this.z;\n  var level = this._level;\n\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  var result = [];\n\n  for (var i = 0; i < neighborOffsets.length; i++) {\n    var xOffset = neighborOffsets[i][0];\n    var yOffset = neighborOffsets[i][1];\n\n    var newX = x + xOffset;\n    var newY = y + yOffset;\n    var newZ = z;\n    var newFace = face;\n\n    if (newX < 0 || newX >= numX || newY < 0 || newY >= numY) {\n\n      // If the neighboring tile belongs to a different face, calculate a\n      // vector pointing to the edge between the two faces at the point the\n      // tile and its neighbor meet, and convert it into tile coordinates for\n      // the neighboring face.\n\n      var xCoord = this.centerX();\n      var yCoord = this.centerY();\n\n      // First, calculate the vector as if the initial tile belongs to the\n      // front face, so that the tile x,y coordinates map directly into the\n      // x,y axes.\n\n      if (newX < 0) {\n        vec3.set(vec, -0.5, yCoord, -0.5);\n        newFace = adjacentFace[face][0];\n      } else if (newX >= numX) {\n        vec3.set(vec, 0.5, yCoord, -0.5);\n        newFace = adjacentFace[face][1];\n      } else if (newY < 0) {\n        vec3.set(vec, xCoord, 0.5, -0.5);\n        newFace = adjacentFace[face][2];\n      } else if (newY >= numY) {\n        vec3.set(vec, xCoord, -0.5, -0.5);\n        newFace = adjacentFace[face][3];\n      }\n\n      var rot;\n\n      // Then, rotate the vector into the actual face the initial tile\n      // belongs to.\n\n      rot = faceRotation[face];\n      rotateVector(vec, 0, rot.x, rot.y);\n\n      // Finally, rotate the vector from the neighboring face into the front\n      // face. Again, this is so that the neighboring tile x,y coordinates\n      // map directly into the x,y axes.\n\n      rot = faceRotation[newFace];\n      rotateVector(vec, 0, -rot.x, -rot.y);\n\n      // Calculate the neighboring tile coordinates.\n\n      newX = clamp(Math.floor((0.5 + vec[0]) * numX), 0, numX - 1);\n      newY = clamp(Math.floor((0.5 - vec[1]) * numY), 0, numY - 1);\n    }\n\n    result.push(new CubeTile(newFace, newX, newY, newZ, geometry));\n  }\n\n  // Store into cache to satisfy future requests.\n  cache.set(this, result);\n\n  return result;\n\n};\n\n\nCubeTile.prototype.hash = function() {\n  return hash(faceList.indexOf(this.face), this.z, this.y, this.x);\n};\n\n\nCubeTile.prototype.equals = function(that) {\n  return (this._geometry === that._geometry &&\n      this.face === that.face &&\n      this.z === that.z &&\n      this.y === that.y &&\n      this.x === that.x);\n};\n\n\nCubeTile.prototype.cmp = function(that) {\n  return (cmp(this.z, that.z) ||\n  cmp(faceList.indexOf(this.face), faceList.indexOf(that.face)) ||\n  cmp(this.y, that.y) || cmp(this.x, that.x));\n};\n\n\nCubeTile.prototype.str = function() {\n  return 'CubeTile(' + tile.face + ', ' + tile.x + ', ' + tile.y + ', ' + tile.z + ')';\n};\n\n\nfunction CubeLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n\n  this._size = levelProperties.size;\n  this._tileSize = levelProperties.tileSize;\n\n  if (this._size % this._tileSize !== 0) {\n    throw new Error('Level size is not multiple of tile size: ' +\n                    this._size + ' ' + this._tileSize);\n  }\n}\n\ninherits(CubeLevel, Level);\n\n\nCubeLevel.prototype.width = function() {\n  return this._size;\n};\n\n\nCubeLevel.prototype.height = function() {\n  return this._size;\n};\n\n\nCubeLevel.prototype.tileWidth = function() {\n  return this._tileSize;\n};\n\n\nCubeLevel.prototype.tileHeight = function() {\n  return this._tileSize;\n};\n\n\nCubeLevel.prototype._validateWithParentLevel = function(parentLevel) {\n\n  var width = this.width();\n  var height = this.height();\n  var tileWidth = this.tileWidth();\n  var tileHeight = this.tileHeight();\n  var numHorizontal = this.numHorizontalTiles();\n  var numVertical = this.numVerticalTiles();\n\n  var parentWidth = parentLevel.width();\n  var parentHeight = parentLevel.height();\n  var parentTileWidth = parentLevel.tileWidth();\n  var parentTileHeight = parentLevel.tileHeight();\n  var parentNumHorizontal = parentLevel.numHorizontalTiles();\n  var parentNumVertical = parentLevel.numVerticalTiles();\n\n  if (width % parentWidth !== 0) {\n    throw new Error('Level width must be multiple of parent level: ' +\n                    width + ' vs. ' + parentWidth);\n  }\n\n  if (height % parentHeight !== 0) {\n    throw new Error('Level height must be multiple of parent level: ' +\n                    height + ' vs. ' + parentHeight);\n  }\n\n  if (numHorizontal % parentNumHorizontal !== 0) {\n    throw new Error('Number of horizontal tiles must be multiple of parent level: ' +\n      numHorizontal + \" (\" + width + '/' + tileWidth + ')' + \" vs. \" +\n      parentNumHorizontal + \" (\" + parentWidth + '/' + parentTileWidth + ')');\n  }\n\n  if (numVertical % parentNumVertical !== 0) {\n    throw new Error('Number of vertical tiles must be multiple of parent level: ' +\n      numVertical + \" (\" + height + '/' + tileHeight + ')' + \" vs. \" +\n      parentNumVertical + \" (\" + parentHeight + '/' + parentTileHeight + ')');\n  }\n\n};\n\n\n/**\n * @class CubeGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for tiled cube images with\n * multiple resolution levels.\n *\n * The following restrictions apply:\n *   - All tiles in a level must be square and form a rectangular grid;\n *   - The size of a level must be a multiple of the tile size;\n *   - The size of a level must be a multiple of the parent level size;\n *   - The number of tiles in a level must be a multiple of the number of tiles\n *     in the parent level.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].size Cube face size in pixels\n * @param {number} levelPropertiesList[].tileSize Tile size in pixels\n */\nfunction CubeGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = makeLevelList(levelPropertiesList, CubeLevel);\n  this.selectableLevelList = makeSelectableLevelList(this.levelList);\n\n  for (var i = 1; i < this.levelList.length; i++) {\n    this.levelList[i]._validateWithParentLevel(this.levelList[i-1]);\n  }\n\n  this._tileSearcher = new TileSearcher(this);\n\n  this._neighborsCache = new LruMap(neighborsCacheSize);\n\n  this._vec = vec4.create();\n\n  this._viewSize = {};\n}\n\n\nCubeGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nCubeGeometry.prototype.levelTiles = function(level, result) {\n\n  var levelIndex = this.levelList.indexOf(level);\n  var maxX = level.numHorizontalTiles() - 1;\n  var maxY = level.numVerticalTiles() - 1;\n\n  result = result || [];\n\n  for (var f = 0; f < faceList.length; f++) {\n    var face = faceList[f];\n    for (var x = 0; x <= maxX; x++) {\n      for (var y = 0; y <= maxY; y++) {\n        result.push(new CubeTile(face, x, y, levelIndex, this));\n      }\n    }\n  }\n\n  return result;\n\n};\n\n\nCubeGeometry.prototype._closestTile = function(view, level) {\n  var ray = this._vec;\n\n  // Compute a view ray into the central screen point.\n  vec4.set(ray, 0, 0, 1, 1);\n  vec4.transformMat4(ray, ray, view.inverseProjection());\n\n  var minAngle = Infinity;\n  var closestFace = null;\n\n  // Find the face whose vector makes a minimal angle with the view ray.\n  // This is the face into which the view ray points.\n  for (var face in faceVectors) {\n    var vector = faceVectors[face];\n    // For a small angle between two normalized vectors, angle ~ 1-cos(angle).\n    var angle = 1 - vec3.dot(vector, ray);\n    if (angle < minAngle) {\n      minAngle = angle;\n      closestFace = face;\n    }\n  }\n\n  // Project view ray onto cube, i.e., normalize the coordinate with\n  // largest absolute value to ±0.5.\n  var max = Math.max(Math.abs(ray[0]), Math.abs(ray[1]), Math.abs(ray[2])) / 0.5;\n  for (var i = 0; i < 3; i++) {\n    ray[i] = ray[i] / max;\n  }\n\n  // Rotate view ray into front face.\n  var rot = faceRotation[closestFace];\n  rotateVector(ray, 0, -rot.x, -rot.y);\n\n  // Get the desired zoom level.\n  var tileZ = this.levelList.indexOf(level);\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  // Find the coordinates of the tile that the view ray points into.\n  var tileX = clamp(Math.floor((0.5 + ray[0]) * numX), 0, numX - 1);\n  var tileY = clamp(Math.floor((0.5 - ray[1]) * numY), 0, numY - 1);\n\n  return new CubeTile(closestFace, tileX, tileY, tileZ, this);\n};\n\n\nCubeGeometry.prototype.visibleTiles = function(view, level, result) {\n  var viewSize = this._viewSize;\n  var tileSearcher = this._tileSearcher;\n\n  result = result || [];\n\n  view.size(viewSize);\n  if (viewSize.width === 0 || viewSize.height === 0) {\n    // No tiles are visible if the viewport is empty.\n    return result;\n  }\n\n  var startingTile = this._closestTile(view, level);\n  var count = tileSearcher.search(view, startingTile, result);\n  if (!count) {\n    throw new Error('Starting tile is not visible');\n  }\n\n  return result;\n};\n\n\nCubeGeometry.Tile = CubeGeometry.prototype.Tile = CubeTile;\nCubeGeometry.type = CubeGeometry.prototype.type = 'cube';\nCubeTile.type = CubeTile.prototype.type = 'cube';\n\n\nmodule.exports = CubeGeometry;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar TileSearcher = require('../TileSearcher');\nvar LruMap = require('../collections/LruMap');\nvar Level = require('./Level');\nvar makeLevelList = require('./common').makeLevelList;\nvar makeSelectableLevelList = require('./common').makeSelectableLevelList;\nvar clamp = require('../util/clamp');\nvar mod = require('../util/mod');\nvar cmp = require('../util/cmp');\nvar type = require('../util/type');\nvar vec2 = require('gl-matrix').vec2;\nvar vec4 = require('gl-matrix').vec4;\n\nvar neighborsCacheSize = 64;\n\n// Offsets to apply to the (x,y) coordinates of a tile to get its neighbors.\nvar neighborOffsets = [\n  [  0,  1 ], // top\n  [  1,  0 ], // right\n  [  0, -1 ], // bottom\n  [ -1,  0 ]  // left\n];\n\n\n/**\n * @class FlatTile\n * @implements Tile\n * @classdesc\n *\n * A tile in a {@link FlatGeometry}.\n */\nfunction FlatTile(x, y, z, geometry) {\n  this.x = x;\n  this.y = y;\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nFlatTile.prototype.rotX = function() {\n  return 0;\n};\n\n\nFlatTile.prototype.rotY = function() {\n  return 0;\n};\n\n\nFlatTile.prototype.centerX = function() {\n  var levelWidth = this._level.width();\n  var tileWidth = this._level.tileWidth();\n  return (this.x * tileWidth + 0.5 * this.width()) / levelWidth - 0.5;\n};\n\n\nFlatTile.prototype.centerY = function() {\n  var levelHeight = this._level.height();\n  var tileHeight = this._level.tileHeight();\n  return 0.5 - (this.y * tileHeight + 0.5 * this.height()) / levelHeight;\n};\n\n\nFlatTile.prototype.scaleX = function() {\n  var levelWidth = this._level.width();\n  return this.width() / levelWidth;\n};\n\n\nFlatTile.prototype.scaleY = function() {\n  var levelHeight = this._level.height();\n  return this.height() / levelHeight;\n};\n\n\nFlatTile.prototype.width = function() {\n  var levelWidth = this._level.width();\n  var tileWidth = this._level.tileWidth();\n  if (this.x === this._level.numHorizontalTiles() - 1) {\n    var widthRemainder = mod(levelWidth, tileWidth);\n    return widthRemainder || tileWidth;\n  } else {\n    return tileWidth;\n  }\n};\n\n\nFlatTile.prototype.height = function() {\n  var levelHeight = this._level.height();\n  var tileHeight = this._level.tileHeight();\n  if (this.y === this._level.numVerticalTiles() - 1) {\n    var heightRemainder = mod(levelHeight, tileHeight);\n    return heightRemainder || tileHeight;\n  } else {\n    return tileHeight;\n  }\n};\n\n\nFlatTile.prototype.levelWidth = function() {\n  return this._level.width();\n};\n\n\nFlatTile.prototype.levelHeight = function() {\n  return this._level.height();\n};\n\n\nFlatTile.prototype.vertices = function(result) {\n  if (!result) {\n    result = [vec2.create(), vec2.create(), vec2.create(), vec2.create()];\n  }\n\n  var left = this.centerX() - this.scaleX() / 2;\n  var right = this.centerX() + this.scaleX() / 2;\n  var bottom = this.centerY() - this.scaleY() / 2;\n  var top = this.centerY() + this.scaleY() / 2;\n\n  vec2.set(result[0], left, top);\n  vec2.set(result[1], right, top);\n  vec2.set(result[2], right, bottom);\n  vec2.set(result[3], left, bottom);\n\n  return result;\n};\n\n\nFlatTile.prototype.parent = function() {\n\n\n  if (this.z === 0) {\n    return null;\n  }\n\n  var geometry = this._geometry;\n\n  var z = this.z - 1;\n  // TODO: Currently assuming each level is double the size of previous one.\n  // Fix to support other multiples.\n  var x = Math.floor(this.x / 2);\n  var y = Math.floor(this.y / 2);\n\n  return new FlatTile(x, y, z, geometry);\n\n};\n\n\nFlatTile.prototype.children = function(result) {\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n\n  var geometry = this._geometry;\n  var z = this.z + 1;\n\n  result = result || [];\n\n  // TODO: Currently assuming each level is double the size of previous one.\n  // Fix to support other multiples.\n  result.push(new FlatTile(2*this.x  , 2*this.y  , z, geometry));\n  result.push(new FlatTile(2*this.x  , 2*this.y+1, z, geometry));\n  result.push(new FlatTile(2*this.x+1, 2*this.y  , z, geometry));\n  result.push(new FlatTile(2*this.x+1, 2*this.y+1, z, geometry));\n\n  return result;\n\n};\n\n\nFlatTile.prototype.neighbors = function() {\n\n  var geometry = this._geometry;\n  var cache = geometry._neighborsCache;\n\n  // Satisfy from cache when available.\n  var cachedResult = cache.get(this);\n  if (cachedResult) {\n    return cachedResult;\n  }\n\n  var x = this.x;\n  var y = this.y;\n  var z = this.z;\n  var level = this._level;\n\n  var numX = level.numHorizontalTiles() - 1;\n  var numY = level.numVerticalTiles() - 1;\n\n  var result = [];\n\n  for (var i = 0; i < neighborOffsets.length; i++) {\n    var xOffset = neighborOffsets[i][0];\n    var yOffset = neighborOffsets[i][1];\n\n    var newX = x + xOffset;\n    var newY = y + yOffset;\n    var newZ = z;\n\n    if (0 <= newX && newX <= numX && 0 <= newY && newY <= numY) {\n      result.push(new FlatTile(newX, newY, newZ, geometry));\n    }\n  }\n\n  // Store into cache to satisfy future requests.\n  cache.set(this, result);\n\n  return result;\n\n};\n\n\nFlatTile.prototype.hash = function() {\n  return hash(this.z, this.y, this.x);\n};\n\n\nFlatTile.prototype.equals = function(that) {\n  return (this._geometry === that._geometry &&\n      this.z === that.z && this.y === that.y && this.x === that.x);\n};\n\n\nFlatTile.prototype.cmp = function(that) {\n  return (cmp(this.z, that.z) || cmp(this.y, that.y) || cmp(this.x, that.x));\n};\n\n\nFlatTile.prototype.str = function() {\n  return 'FlatTile(' + tile.x + ', ' + tile.y + ', ' + tile.z + ')';\n};\n\n\nfunction FlatLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n\n  this._width = levelProperties.width;\n  this._height = levelProperties.height;\n  this._tileWidth = levelProperties.tileWidth;\n  this._tileHeight = levelProperties.tileHeight;\n}\n\ninherits(FlatLevel, Level);\n\n\nFlatLevel.prototype.width = function() {\n  return this._width;\n};\n\n\nFlatLevel.prototype.height = function() {\n  return this._height;\n};\n\n\nFlatLevel.prototype.tileWidth = function() {\n  return this._tileWidth;\n};\n\n\nFlatLevel.prototype.tileHeight = function() {\n  return this._tileHeight;\n};\n\n\nFlatLevel.prototype._validateWithParentLevel = function(parentLevel) {\n\n  var width = this.width();\n  var height = this.height();\n  var tileWidth = this.tileWidth();\n  var tileHeight = this.tileHeight();\n\n  var parentWidth = parentLevel.width();\n  var parentHeight = parentLevel.height();\n  var parentTileWidth = parentLevel.tileWidth();\n  var parentTileHeight = parentLevel.tileHeight();\n\n  if (width % parentWidth !== 0) {\n    return new Error('Level width must be multiple of parent level: ' +\n                     width + ' vs. ' + parentWidth);\n  }\n\n  if (height % parentHeight !== 0) {\n    return new Error('Level height must be multiple of parent level: ' +\n                     height + ' vs. ' + parentHeight);\n  }\n\n  if (tileWidth % parentTileWidth !== 0) {\n    return new Error('Level tile width must be multiple of parent level: ' +\n                     tileWidth + ' vs. ' + parentTileWidth);\n  }\n\n  if (tileHeight % parentTileHeight !== 0) {\n    return new Error('Level tile height must be multiple of parent level: ' +\n                     tileHeight + ' vs. ' + parentTileHeight);\n  }\n\n};\n\n\n/**\n * @class FlatGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for tiled flat images with\n * multiple resolution levels.\n *\n * The following restrictions apply:\n *   - All tiles must be square, except when in the last row or column position,\n *     and must form a rectangular grid;\n *   - The width and height of a level must be multiples of the parent level\n *     width and height.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].width Level width in pixels\n * @param {number} levelPropertiesList[].tileWidth Tile width in pixels for\n *                 square tiles\n * @param {number} levelPropertiesList[].height Level height in pixels\n * @param {number} levelPropertiesList[].tileHeight Tile height in pixels for\n *                 square tiles\n */\nfunction FlatGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = makeLevelList(levelPropertiesList, FlatLevel);\n  this.selectableLevelList = makeSelectableLevelList(this.levelList);\n\n  for (var i = 1; i < this.levelList.length; i++) {\n    this.levelList[i]._validateWithParentLevel(this.levelList[i-1]);\n  }\n\n  this._tileSearcher = new TileSearcher(this);\n\n  this._neighborsCache = new LruMap(neighborsCacheSize);\n\n  this._vec = vec4.create();\n\n  this._viewSize = {};\n}\n\n\nFlatGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nFlatGeometry.prototype.levelTiles = function(level, result) {\n\n  var levelIndex = this.levelList.indexOf(level);\n  var maxX = level.numHorizontalTiles() - 1;\n  var maxY = level.numVerticalTiles() - 1;\n\n  if (!result) {\n    result = [];\n  }\n\n  for (var x = 0; x <= maxX; x++) {\n    for (var y = 0; y <= maxY; y++) {\n      result.push(new FlatTile(x, y, levelIndex, this));\n    }\n  }\n\n  return result;\n\n};\n\n\nFlatGeometry.prototype._closestTile = function(view, level) {\n  var ray = this._vec;\n\n  // Compute a view ray into the central screen point.\n  vec4.set(ray, 0, 0, 1, 1);\n  vec4.transformMat4(ray, ray, view.inverseProjection());\n\n  // Compute the image coordinates that the view ray points into.\n  var x = 0.5 + ray[0];\n  var y = 0.5 - ray[1];\n\n  // Get the desired zoom level.\n  var tileZ = this.levelList.indexOf(level);\n  var levelWidth = level.width();\n  var levelHeight = level.height();\n  var tileWidth = level.tileWidth();\n  var tileHeight = level.tileHeight();\n  var numX = level.numHorizontalTiles();\n  var numY = level.numVerticalTiles();\n\n  // Find the coordinates of the tile that the view ray points into.\n  var tileX = clamp(Math.floor(x * levelWidth / tileWidth), 0, numX - 1);\n  var tileY = clamp(Math.floor(y * levelHeight / tileHeight), 0, numY - 1);\n\n  return new FlatTile(tileX, tileY, tileZ, this);\n};\n\n\nFlatGeometry.prototype.visibleTiles = function(view, level, result) {\n  var viewSize = this._viewSize;\n  var tileSearcher = this._tileSearcher;\n\n  result = result || [];\n\n  view.size(viewSize);\n  if (viewSize.width === 0 || viewSize.height === 0) {\n    // No tiles are visible if the viewport is empty.\n    return result;\n  }\n\n  var startingTile = this._closestTile(view, level);\n  var count = tileSearcher.search(view, startingTile, result);\n  if (!count) {\n    throw new Error('Starting tile is not visible');\n  }\n\n  return result;\n};\n\n\nFlatGeometry.Tile = FlatGeometry.prototype.Tile = FlatTile;\nFlatGeometry.type = FlatGeometry.prototype.type = 'flat';\nFlatTile.type = FlatTile.prototype.type = 'flat';\n\n\nmodule.exports = FlatGeometry;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar inherits = require('../util/inherits');\nvar hash = require('../util/hash');\nvar cmp = require('../util/cmp');\nvar common = require('./common');\nvar Level = require('./Level');\nvar type = require('../util/type');\n\n\n/**\n * @class EquirectTile\n * @implements Tile\n * @classdesc\n *\n * A tile in an @{EquirectGeometry}.\n */\nfunction EquirectTile(z, geometry) {\n  this.z = z;\n  this._geometry = geometry;\n  this._level = geometry.levelList[z];\n}\n\n\nEquirectTile.prototype.rotX = function() {\n  return 0;\n};\n\n\nEquirectTile.prototype.rotY = function() {\n  return 0;\n};\n\n\nEquirectTile.prototype.centerX = function() {\n  return 0.5;\n};\n\n\nEquirectTile.prototype.centerY = function() {\n  return 0.5;\n};\n\n\nEquirectTile.prototype.scaleX = function() {\n  return 1;\n};\n\n\nEquirectTile.prototype.scaleY = function() {\n  return 1;\n};\n\n\nEquirectTile.prototype.parent = function() {\n  if (this.z === 0) {\n    return null;\n  }\n  return new EquirectTile(this.z - 1, this._geometry);\n};\n\n\nEquirectTile.prototype.children = function(result) {\n  if (this.z === this._geometry.levelList.length - 1) {\n    return null;\n  }\n  result = result || [];\n  result.push(new EquirectTile(this.z + 1, this._geometry));\n  return result;\n};\n\n\nEquirectTile.prototype.neighbors = function() {\n  return [];\n};\n\n\nEquirectTile.prototype.hash = function() {\n  return hash(this.z);\n};\n\n\nEquirectTile.prototype.equals = function(that) {\n  return this._geometry === that._geometry && this.z === that.z;\n};\n\n\nEquirectTile.prototype.cmp = function(that) {\n  return cmp(this.z, that.z);\n};\n\n\nEquirectTile.prototype.str = function() {\n  return 'EquirectTile(' + tile.z + ')';\n};\n\n\nfunction EquirectLevel(levelProperties) {\n  this.constructor.super_.call(this, levelProperties);\n  this._width = levelProperties.width;\n}\n\ninherits(EquirectLevel, Level);\n\n\nEquirectLevel.prototype.width = function() {\n  return this._width;\n};\n\n\nEquirectLevel.prototype.height = function() {\n  return this._width/2;\n};\n\n\nEquirectLevel.prototype.tileWidth = function() {\n  return this._width;\n};\n\n\nEquirectLevel.prototype.tileHeight = function() {\n  return this._width/2;\n};\n\n\n/**\n * @class EquirectGeometry\n * @implements Geometry\n * @classdesc\n *\n * A {@link Geometry} implementation suitable for equirectangular images with a\n * 2:1 aspect ratio.\n *\n * @param {Object[]} levelPropertiesList Level description\n * @param {number} levelPropertiesList[].width Level width in pixels\n*/\nfunction EquirectGeometry(levelPropertiesList) {\n  if (type(levelPropertiesList) !== 'array') {\n    throw new Error('Level list must be an array');\n  }\n\n  this.levelList = common.makeLevelList(levelPropertiesList, EquirectLevel);\n  this.selectableLevelList = common.makeSelectableLevelList(this.levelList);\n}\n\n\nEquirectGeometry.prototype.maxTileSize = function() {\n  var maxTileSize = 0;\n  for (var i = 0; i < this.levelList.length; i++) {\n    var level = this.levelList[i];\n    maxTileSize = Math.max(maxTileSize, level.tileWidth, level.tileHeight);\n  }\n  return maxTileSize;\n};\n\n\nEquirectGeometry.prototype.levelTiles = function(level, result) {\n  var levelIndex = this.levelList.indexOf(level);\n  result = result || [];\n  result.push(new EquirectTile(levelIndex, this));\n  return result;\n};\n\n\nEquirectGeometry.prototype.visibleTiles = function(view, level, result) {\n  var tile = new EquirectTile(this.levelList.indexOf(level), this);\n  result = result || [];\n  result.length = 0;\n  result.push(tile);\n};\n\n\nEquirectGeometry.Tile = EquirectGeometry.prototype.Tile = EquirectTile;\nEquirectGeometry.type = EquirectGeometry.prototype.type = 'equirect';\nEquirectTile.type = EquirectTile.prototype.type = 'equirect';\n\n\nmodule.exports = EquirectGeometry;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * Convert fov\n *\n * For example, to convert from hfov to vfov one would call \n * `convert(hfov, width, height)`\n *\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction convert(fov, fromDimension, toDimension) {\n  return 2 * Math.atan(toDimension * Math.tan(fov / 2) / fromDimension);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction htov(fov, width, height) {\n  return convert(fov, width, height);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction htod(fov, width, height) {\n  return convert(fov, width, Math.sqrt(width * width + height * height));\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction vtoh(fov, width, height) {\n  return convert(fov, height, width);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction vtod(fov, width, height) {\n  return convert(fov, height, Math.sqrt(width * width + height * height));\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction dtoh(fov, width, height) {\n  return convert(fov, Math.sqrt(width * width + height * height), width);\n}\n\n/**\n * @param {number} fov\n * @param {number} fromDimension\n * @param {number} toDimension\n * @return {number}\n * @memberof util.convertFov\n */\nfunction dtov(fov, width, height) {\n  return convert(fov, Math.sqrt(width * width + height * height), height);\n}\n\n/**\n * @namespace util.convertFov\n */\nmodule.exports = {\n  convert: convert,\n  htov: htov,\n  htod: htod,\n  vtoh: vtoh,\n  vtod: vtod,\n  dtoh: dtoh,\n  dtov: dtov\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction real(x) {\n  return typeof x === 'number' && isFinite(x);\n}\n\nmodule.exports = real;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Convert a number to a string in decimal notation.\nfunction decimal(x) {\n  // Double-precision floats have 15 significant decimal digits.\n  return x.toPrecision(15);\n}\n\nmodule.exports = decimal;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n  * Compose multiple functions\n  *\n  * `compose(f, g)` returns `function(x) { return f(g(x)); }`\n  *\n  * @memberof util\n  * @param {Function[]} functions The functions to compose\n  * @return {Function}\n  */\nfunction compose() {\n  var fnList = arguments;\n  return function composed(initialArg) {\n    var ret = initialArg;\n    for (var i = 0; i < fnList.length; i++) {\n      var fn = fnList[i];\n      ret = fn.call(null, ret);\n    }\n    return ret;\n  };\n}\n\nmodule.exports = compose;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar mat4 = require('gl-matrix').mat4;\nvar vec4 = require('gl-matrix').vec4;\nvar pixelRatio = require('../util/pixelRatio');\nvar convertFov = require('../util/convertFov');\nvar mod = require('../util/mod');\nvar real = require('../util/real');\nvar clamp = require('../util/clamp');\nvar decimal = require('../util/decimal');\nvar compose = require('../util/compose');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// Default viewport dimensions.\n// Start with zero to ensure that those values are handled correctly.\nvar defaultWidth = 0;\nvar defaultHeight = 0;\n\n// Default view parameters.\nvar defaultYaw = 0;\nvar defaultPitch = 0;\nvar defaultRoll = 0;\nvar defaultFov = Math.PI/4;\nvar defaultProjectionCenterX = 0;\nvar defaultProjectionCenterY = 0;\n\n// A fov of exactly 0 or π breaks some computations, so we constrain it to the\n// [fovLimitEpsilon, π - fovLimitEpsilon] interval. We use 6 decimal places for\n// the epsilon value to avoid broken rendering due to loss of precision in\n// floating point computations.\nvar fovLimitEpsilon = 0.000001;\n\n\n/**\n * @interface RectilinearViewParams\n *\n * A camera configuration for a {@link RectilinearView}.\n *\n * @property {number} yaw The yaw angle, in the [-π, π] range.\n *     When `yaw < 0`, the view rotates to the left.\n *     When `yaw > 0`, the view rotates to the right.\n *\n * @property {number} pitch The pitch angle, in the [-π, π] range.\n *     When `pitch < 0`, the view rotates downwards.\n *     When `pitch > 0`, the view rotates upwards.\n *\n * @property {number} roll The roll angle, in the [-π, π] range.\n *     When `roll < 0`, the view rotates clockwise.\n *     When `roll > 0`, the view rotates counter-clockwise.\n *\n * @property {fov} fov The vertical field of view, in the [0, π] range.\n */\n\n\n/**\n * @interface RectilinearViewCoords\n *\n * The position of a point in a 360° image.\n *\n * @property {number} yaw The yaw angle, in the [-π, π] range.\n * @property {number} pitch The pitch angle, in the [-π, π] range.\n */\n\n\n/**\n * @typedef {function} RectilinearViewLimiter\n *\n * View limiter for a {@link RectilinearView}.\n *\n * A view limiter is a function that receives a {@link RectilinearViewParams}\n * object, optionally modifies it in place, and returns it. It can be used to\n * enforce constraints on the view parameters.\n *\n * See {@link RectilinearView.limit} for commonly used limiters. They may be\n * composed together or with user-defined limiters with {@link util.compose}.\n *\n * @param {RectilinearViewParams} params\n * @return {RectilinearViewParams}\n */\n\n/**\n * @class RectilinearView\n * @implements View\n * @classdesc\n *\n * A {@link View} implementing a rectilinear projection for 360° images.\n *\n * @param {RectilinearViewParams=} params The initial view parameters. If\n *     unspecified, defaults to `{yaw: 0, pitch: 0, roll: 0, fov: Math.PI/4 }`.\n * @param {RectilinearViewLimiter=} limiter The view limiter. If unspecified,\n *     no view limiting is applied. See {@link RectilinearView.limit} for\n *     commonly used limiters.\n */\nfunction RectilinearView(params, limiter) {\n  // The initial values for the view parameters.\n  this._yaw = params && params.yaw != null ? params.yaw : defaultYaw;\n  this._pitch = params && params.pitch != null ? params.pitch : defaultPitch;\n  this._roll = params && params.roll != null ? params.roll : defaultRoll;\n  this._fov = params && params.fov != null ? params.fov : defaultFov;\n  this._width = params && params.width != null ?\n    params.width : defaultWidth;\n  this._height = params && params.height != null ?\n    params.height : defaultHeight;\n  this._projectionCenterX = params && params.projectionCenterX != null ?\n    params.projectionCenterX : defaultProjectionCenterX;\n  this._projectionCenterY = params && params.projectionCenterY != null ?\n    params.projectionCenterY : defaultProjectionCenterY;\n\n  // The initial value for the view limiter.\n  this._limiter = limiter || null;\n\n  // The last calculated projection matrix and its inverse.\n  this._projMatrix = mat4.create();\n  this._invProjMatrix = mat4.create();\n\n  // The last calculated view frustum.\n  this._frustum = [\n    vec4.create(), // left\n    vec4.create(), // right\n    vec4.create(), // bottom\n    vec4.create(), // top\n    vec4.create()  // camera\n  ];\n\n  // Whether the projection matrices and the view frustum need to be updated.\n  this._projectionChanged = true;\n\n  // Temporary variables used for calculations.\n  this._params = {};\n  this._fovs = {};\n  this._tmpVec = vec4.create();\n\n  // Force view limiting on initial parameters.\n  this._update();\n}\n\neventEmitter(RectilinearView);\n\n\n/**\n * Destructor.\n */\nRectilinearView.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n\n/**\n * Get the yaw angle.\n * @return {number}\n */\nRectilinearView.prototype.yaw = function() {\n  return this._yaw;\n};\n\n\n/**\n * Get the pitch angle.\n * @return {number}\n */\nRectilinearView.prototype.pitch = function() {\n  return this._pitch;\n};\n\n\n/**\n * Get the roll angle.\n * @return {number}\n */\nRectilinearView.prototype.roll = function() {\n  return this._roll;\n};\n\n\nRectilinearView.prototype.projectionCenterX = function() {\n  return this._projectionCenterX;\n};\n\n\nRectilinearView.prototype.projectionCenterY = function() {\n  return this._projectionCenterY;\n};\n\n\n/**\n * Get the fov value.\n * @return {number}\n */\nRectilinearView.prototype.fov = function() {\n  return this._fov;\n};\n\n\n/**\n * Get the viewport width.\n * @return {number}\n */\nRectilinearView.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the viewport height.\n * @return {number}\n */\nRectilinearView.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the viewport dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {Size=} size\n * @return {Size}\n */\nRectilinearView.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Get the view parameters. If an argument is supplied, it is filled in with the\n * result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {RectilinearViewParams=} obj\n * @return {RectilinearViewParams}\n */\nRectilinearView.prototype.parameters = function(params) {\n  params = params || {};\n  params.yaw = this._yaw;\n  params.pitch = this._pitch;\n  params.roll = this._roll;\n  params.fov = this._fov;\n  return params;\n};\n\n\n/**\n * Get the view limiter, or null if unset.\n * @return {?RectilinearViewLimiter}\n */\nRectilinearView.prototype.limiter = function() {\n  return this._limiter;\n};\n\n\n/**\n * Set the yaw angle.\n * @param {number} yaw\n */\nRectilinearView.prototype.setYaw = function(yaw) {\n  this._resetParams();\n  this._params.yaw = yaw;\n  this._update(this._params);\n};\n\n\n/**\n * Set the pitch angle.\n * @param {number} pitch\n */\nRectilinearView.prototype.setPitch = function(pitch) {\n  this._resetParams();\n  this._params.pitch = pitch;\n  this._update(this._params);\n};\n\n\n/**\n * Set the roll angle.\n * @param {number} roll\n */\nRectilinearView.prototype.setRoll = function(roll) {\n  this._resetParams();\n  this._params.roll = roll;\n  this._update(this._params);\n};\n\n\n/**\n * Set the fov value.\n * @param {number} fov\n */\nRectilinearView.prototype.setFov = function(fov) {\n  this._resetParams();\n  this._params.fov = fov;\n  this._update(this._params);\n};\n\n\nRectilinearView.prototype.setProjectionCenterX = function(projectionCenterX) {\n  this._resetParams();\n  this._params.projectionCenterX = projectionCenterX;\n  this._update(this._params);\n};\n\n\nRectilinearView.prototype.setProjectionCenterY = function(projectionCenterY) {\n  this._resetParams();\n  this._params.projectionCenterY = projectionCenterY;\n  this._update(this._params);\n};\n\n\n/**\n * Add yawOffset to the current yaw value.\n * @param {number} yawOffset\n */\nRectilinearView.prototype.offsetYaw = function(yawOffset) {\n  this.setYaw(this._yaw + yawOffset);\n};\n\n\n/**\n * Add pitchOffset to the current pitch value.\n * @param {number} pitchOffset\n */\nRectilinearView.prototype.offsetPitch = function(pitchOffset) {\n  this.setPitch(this._pitch + pitchOffset);\n};\n\n\n/**\n * Add rollOffset to the current roll value.\n * @param {number} rollOffset\n */\nRectilinearView.prototype.offsetRoll = function(rollOffset) {\n  this.setRoll(this._roll + rollOffset);\n};\n\n\n/**\n * Add fovOffset to the current fov value.\n * @param {number} fovOffset\n */\nRectilinearView.prototype.offsetFov = function(fovOffset) {\n  this.setFov(this._fov + fovOffset);\n};\n\n\n/**\n * Set the viewport dimensions.\n * @param {Size} size\n */\nRectilinearView.prototype.setSize = function(size) {\n  this._resetParams();\n  this._params.width = size.width;\n  this._params.height = size.height;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view parameters. Unspecified parameters are left unchanged.\n * @param {RectilinearViewParameters} params\n */\nRectilinearView.prototype.setParameters = function(params) {\n  this._resetParams();\n  this._params.yaw = params.yaw;\n  this._params.pitch = params.pitch;\n  this._params.roll = params.roll;\n  this._params.fov = params.fov;\n  this._params.projectionCenterX = params.projectionCenterX;\n  this._params.projectionCenterY = params.projectionCenterY;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view limiter.\n * @param {?RectilinearViewLimiter} limiter The new limiter, or null to unset.\n */\nRectilinearView.prototype.setLimiter = function(limiter) {\n  this._limiter = limiter || null;\n  this._update();\n};\n\n\nRectilinearView.prototype._resetParams = function() {\n  var params = this._params;\n  params.yaw = null;\n  params.pitch = null;\n  params.roll = null;\n  params.fov = null;\n  params.width = null;\n  params.height = null;\n};\n\n\nRectilinearView.prototype._update = function(params) {\n\n  // Avoid object allocation when no parameters are supplied.\n  if (params == null) {\n    this._resetParams();\n    params = this._params;\n  }\n\n  // Save old parameters for later comparison.\n  var oldYaw = this._yaw;\n  var oldPitch = this._pitch;\n  var oldRoll = this._roll;\n  var oldFov = this._fov;\n  var oldProjectionCenterX = this._projectionCenterX;\n  var oldProjectionCenterY = this._projectionCenterY;\n  var oldWidth = this._width;\n  var oldHeight = this._height;\n\n  // Fill in object with the new set of parameters to pass into the limiter.\n  params.yaw = params.yaw != null ? params.yaw : oldYaw;\n  params.pitch = params.pitch != null ? params.pitch : oldPitch;\n  params.roll = params.roll != null ? params.roll : oldRoll;\n  params.fov = params.fov != null ? params.fov : oldFov;\n  params.width = params.width != null ? params.width : oldWidth;\n  params.height = params.height != null ? params.height : oldHeight;\n  params.projectionCenterX = params.projectionCenterX != null ?\n    params.projectionCenterX : oldProjectionCenterX;\n  params.projectionCenterY = params.projectionCenterY != null ?\n    params.projectionCenterY : oldProjectionCenterY;\n\n  // Apply view limiting when defined.\n  if (this._limiter) {\n    params = this._limiter(params);\n    if (!params) {\n      throw new Error('Bad view limiter');\n    }\n  }\n\n  // Normalize parameters.\n  params = this._normalize(params);\n\n  // Grab the limited parameters.\n  var newYaw = params.yaw;\n  var newPitch = params.pitch;\n  var newRoll = params.roll;\n  var newFov = params.fov;\n  var newWidth = params.width;\n  var newHeight = params.height;\n  var newProjectionCenterX = params.projectionCenterX;\n  var newProjectionCenterY = params.projectionCenterY;\n\n  // Consistency check.\n  if (!real(newYaw) || !real(newPitch) || !real(newRoll) ||\n      !real(newFov) || !real(newWidth) || !real(newHeight) ||\n      !real(newProjectionCenterX) || !real(newProjectionCenterY)) {\n    throw new Error('Bad view - suspect a broken limiter');\n  }\n\n  // Update parameters.\n  this._yaw = newYaw;\n  this._pitch = newPitch;\n  this._roll = newRoll;\n  this._fov = newFov;\n  this._width = newWidth;\n  this._height = newHeight;\n  this._projectionCenterX = newProjectionCenterX;\n  this._projectionCenterY = newProjectionCenterY;\n\n  // Check whether the parameters changed and emit the corresponding events.\n  if (newYaw !== oldYaw || newPitch !== oldPitch || newRoll !== oldRoll ||\n      newFov !== oldFov || newWidth !== oldWidth || newHeight !== oldHeight ||\n      newProjectionCenterX !== oldProjectionCenterX ||\n      newProjectionCenterY !== oldProjectionCenterY) {\n    this._projectionChanged = true;\n    this.emit('change');\n  }\n  if (newWidth !== oldWidth || newHeight !== oldHeight) {\n    this.emit('resize');\n  }\n\n};\n\n\nRectilinearView.prototype._normalize = function(params) {\n\n  this._normalizeCoordinates(params);\n\n  // Make sure that neither the horizontal nor the vertical fields of view\n  // exceed π - fovLimitEpsilon.\n  var hfovPi = convertFov.htov(Math.PI, params.width, params.height);\n  var maxFov = isNaN(hfovPi) ? Math.PI : Math.min(Math.PI, hfovPi);\n  params.fov = clamp(params.fov, fovLimitEpsilon, maxFov - fovLimitEpsilon);\n\n  return params;\n};\n\n\nRectilinearView.prototype._normalizeCoordinates = function(params) {\n  // Constrain yaw, pitch and roll to the [-π, π] interval.\n  if ('yaw' in params) {\n    params.yaw = mod(params.yaw - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  if ('pitch' in params) {\n    params.pitch = mod(params.pitch - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  if ('roll' in params) {\n    params.roll = mod(params.roll - Math.PI, -2*Math.PI) + Math.PI;\n  }\n  return params;\n};\n\n\n/**\n * Normalize view coordinates so that they are the closest to the current view.\n * Useful for tweening the view through the shortest path. If a result argument\n * is supplied, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {RectilinearViewCoords} result The result argument for the normalized\n *     view coordinates.\n */\nRectilinearView.prototype.normalizeToClosest = function(coords, result) {\n\n  var viewYaw = this._yaw;\n  var viewPitch = this._pitch;\n\n  var coordYaw = coords.yaw;\n  var coordPitch = coords.pitch;\n\n  // Check if the yaw is closer after subtracting or adding a full circle.\n  var prevYaw = coordYaw - 2*Math.PI;\n  var nextYaw = coordYaw + 2*Math.PI;\n  if (Math.abs(prevYaw - viewYaw) < Math.abs(coordYaw - viewYaw)) {\n    coordYaw = prevYaw;\n  }\n  else if (Math.abs(nextYaw - viewYaw) < Math.abs(coordYaw - viewYaw)) {\n    coordYaw = nextYaw;\n  }\n\n  // Check if the pitch is closer after subtracting or adding a full circle.\n  var prevPitch = coordPitch - 2*Math.PI;\n  var nextPitch = coordPitch + 2*Math.PI;\n  if (Math.abs(prevPitch - viewPitch) < Math.abs(coordPitch - viewPitch)) {\n    coordPitch = prevPitch;\n  }\n  else if (Math.abs(prevPitch - viewPitch) < Math.abs(coordPitch - viewPitch)) {\n    coordPitch = nextPitch;\n  }\n\n  result = result || {};\n  result.yaw = coordYaw;\n  result.pitch = coordPitch;\n  return result;\n\n};\n\n\nRectilinearView.prototype.updateWithControlParameters = function(parameters) {\n  // axisScaledX and axisScaledY are scaled according to their own axis\n  // x and y are scaled by the same value\n\n  // If the viewport dimensions are zero, assume a square viewport\n  // when converting from hfov to vfov.\n  var vfov = this._fov;\n  var hfov = convertFov.vtoh(vfov, this._width, this._height);\n  if (isNaN(hfov)) {\n    hfov = vfov;\n  }\n\n  // TODO: revisit this after we rethink the control parameters.\n  this.offsetYaw(parameters.axisScaledX * hfov + parameters.x * 2 * hfov + parameters.yaw);\n  this.offsetPitch(parameters.axisScaledY * vfov + parameters.y * 2 * hfov + parameters.pitch);\n  this.offsetRoll(-parameters.roll);\n  this.offsetFov(parameters.zoom * vfov);\n};\n\n\nRectilinearView.prototype._updateProjection = function() {\n  var projMatrix = this._projMatrix;\n  var invProjMatrix = this._invProjMatrix;\n  var frustum = this._frustum;\n\n  if (this._projectionChanged) {\n    var width = this._width;\n    var height = this._height;\n\n    var vfov = this._fov;\n    var hfov = convertFov.vtoh(vfov, width, height);\n    var aspect = width / height;\n\n    var projectionCenterX = this._projectionCenterX;\n    var projectionCenterY = this._projectionCenterY;\n\n    if (projectionCenterX !== 0 || projectionCenterY !== 0) {\n      var offsetAngleX = Math.atan(projectionCenterX * 2 * Math.tan(hfov/2));\n      var offsetAngleY = Math.atan(projectionCenterY * 2 * Math.tan(vfov/2));\n      var fovs = this._fovs;\n      fovs.leftDegrees = (hfov/2 + offsetAngleX) * 180/Math.PI;\n      fovs.rightDegrees = (hfov/2 - offsetAngleX) * 180/Math.PI;\n      fovs.upDegrees = (vfov/2 + offsetAngleY) * 180/Math.PI;\n      fovs.downDegrees = (vfov/2 - offsetAngleY) * 180/Math.PI;\n      mat4.perspectiveFromFieldOfView(projMatrix, fovs, -1, 1);\n    } else {\n      mat4.perspective(projMatrix, vfov, aspect, -1, 1);\n    }\n\n    mat4.rotateZ(projMatrix, projMatrix, this._roll);\n    mat4.rotateX(projMatrix, projMatrix, this._pitch);\n    mat4.rotateY(projMatrix, projMatrix, this._yaw);\n\n    mat4.invert(invProjMatrix, projMatrix);\n\n    this._matrixToFrustum(projMatrix, frustum);\n\n    this._projectionChanged = false;\n  }\n};\n\n\nRectilinearView.prototype._matrixToFrustum = function(p, f) {\n  // Extract frustum planes from projection matrix.\n  // http://www8.cs.umu.se/kurser/5DV051/HT12/lab/plane_extraction.pdf\n  vec4.set(f[0], p[3] + p[0], p[7] + p[4], p[11] + p[8],  0); // left\n  vec4.set(f[1], p[3] - p[0], p[7] - p[4], p[11] - p[8],  0); // right\n  vec4.set(f[2], p[3] + p[1], p[7] + p[5], p[11] + p[9],  0); // top\n  vec4.set(f[3], p[3] - p[1], p[7] - p[5], p[11] - p[9],  0); // bottom\n  vec4.set(f[4], p[3] + p[2], p[7] + p[6], p[11] + p[10], 0); // camera\n};\n\n\n/**\n * Returns the projection matrix for the current view.\n * @returns {mat4}\n */\nRectilinearView.prototype.projection = function() {\n  this._updateProjection();\n  return this._projMatrix;\n};\n\n\n/**\n * Returns the inverse projection matrix for the current view.\n * @returns {mat4}\n */\nRectilinearView.prototype.inverseProjection = function() {\n  this._updateProjection();\n  return this._invProjMatrix;\n};\n\n\n/**\n * Return whether the view frustum intersects the given rectangle.\n *\n * This function may return false positives, but never false negatives.\n * It is used for frustum culling, i.e., excluding invisible tiles from the\n * rendering process.\n *\n * @param {vec2[]} rectangle The vertices of the rectangle.\n */\nRectilinearView.prototype.intersects = function(rectangle) {\n  this._updateProjection();\n\n  var frustum = this._frustum;\n  var vertex = this._tmpVec;\n\n  // Check whether the rectangle is on the outer side of any of the frustum\n  // planes. This is a sufficient condition, though not necessary, for the\n  // rectangle to be completely outside the frustum.\n  for (var i = 0; i < frustum.length; i++) {\n    var plane = frustum[i];\n    var inside = false;\n    for (var j = 0; j < rectangle.length; j++) {\n      var corner = rectangle[j];\n      vec4.set(vertex, corner[0], corner[1], corner[2], 0);\n      if (vec4.dot(plane, vertex) >= 0) {\n        inside = true;\n      }\n    }\n    if (!inside) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Select the level that should be used to render the view.\n * @param {Level[]} levelList the list of levels from which to select.\n * @return {Level} the selected level.\n */\nRectilinearView.prototype.selectLevel = function(levelList) {\n\n  // Multiply the viewport width by the device pixel ratio to get the required\n  // horizontal resolution in pixels.\n  //\n  // Calculate the fraction of a cube face that would be visible given the\n  // current vertical field of view. Then, for each level, multiply by the\n  // level height to get the height in pixels of the portion that would be\n  // visible.\n  //\n  // Search for the smallest level that satifies the the required height,\n  // falling back on the largest level if none do.\n\n  var requiredPixels = pixelRatio() * this._height;\n  var coverFactor = Math.tan(0.5 * this._fov);\n\n  for (var i = 0; i < levelList.length; i++) {\n    var level = levelList[i];\n    if (coverFactor * level.height() >= requiredPixels) {\n      return level;\n    }\n  }\n\n  return levelList[levelList.length - 1];\n\n};\n\n\n/**\n * Convert view parameters into screen position. If a result argument is\n * provided, it is filled in and returned. Otherwise, a fresh object is filled\n * in and returned.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {Coords=} result The result argument for the screen coordinates.\n * @return {Coords}\n */\nRectilinearView.prototype.coordinatesToScreen = function(coords, result) {\n  var ray = this._tmpVec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Undefined on a null viewport.\n  if (width <= 0 || height <= 0) {\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  // Compute view ray pointing into the (yaw, pitch) direction.\n  var yaw = coords.yaw;\n  var pitch = coords.pitch;\n  var x = Math.sin(yaw) * Math.cos(pitch);\n  var y = -Math.sin(pitch);\n  var z = -Math.cos(yaw) * Math.cos(pitch);\n  vec4.set(ray, x, y, z, 1);\n\n  // Project view ray onto clip space.\n  vec4.transformMat4(ray, ray, this.projection());\n\n  // w in clip space equals -z in camera space.\n  if (ray[3] >= 0) {\n    // Point is in front of camera.\n    // Convert to viewport coordinates.\n    result.x = width * (ray[0] / ray[3] + 1) / 2;\n    result.y = height * (1 - ray[1] / ray[3]) / 2;\n  } else {\n    // Point is behind camera.\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  return result;\n};\n\n\n/**\n * Convert screen coordinates into view coordinates. If a result argument is\n * provided, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {Coords} coords The screen coordinates.\n * @param {RectilinearViewCoords=} result The view coordinates.\n * @return {RectilinearViewCoords}\n */\nRectilinearView.prototype.screenToCoordinates = function(coords, result) {\n  var ray = this._tmpVec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Convert viewport coordinates to clip space.\n  var vecx = 2 * coords.x / width - 1;\n  var vecy = 1 - 2 * coords.y / height;\n  vec4.set(ray, vecx, vecy, 1, 1);\n\n  // Project back to world space.\n  vec4.transformMat4(ray, ray, this.inverseProjection());\n\n  // Convert to spherical coordinates.\n  var r = Math.sqrt(ray[0] * ray[0] + ray[1] * ray[1] + ray[2] * ray[2]);\n  result.yaw = Math.atan2(ray[0], -ray[2]);\n  result.pitch = Math.acos(ray[1] / r) - Math.PI/2;\n\n  this._normalizeCoordinates(result);\n\n  return result;\n};\n\n\n/**\n * Calculate the perspective transform required to position an element with\n * perspective.\n *\n * @param {RectilinearViewCoords} coords The view coordinates.\n * @param {number} radius Radius of the sphere embedding the element.\n * @param {string} extraTransforms Extra transformations to be applied after\n *     the element is positioned. This may be used to rotate the element.\n * @return {string} The CSS 3D transform to be applied to the element.\n */\nRectilinearView.prototype.coordinatesToPerspectiveTransform = function(\n    coords, radius, extraTransforms) {\n  extraTransforms = extraTransforms || \"\";\n\n  var height = this._height;\n  var width = this._width;\n  var fov = this._fov;\n  var perspective = 0.5 * height / Math.tan(fov / 2);\n\n  var transform = '';\n\n  // Center hotspot in screen.\n  transform += 'translateX(' + decimal(width/2) + 'px) ';\n  transform += 'translateY(' + decimal(height/2) + 'px) ';\n  transform += 'translateX(-50%) translateY(-50%) ';\n\n  // Set the perspective depth.\n  transform += 'perspective(' + decimal(perspective) + 'px) ';\n  transform += 'translateZ(' + decimal(perspective) + 'px) ';\n\n  // Set the camera rotation.\n  transform += 'rotateZ(' + decimal(-this._roll) + 'rad) ';\n  transform += 'rotateX(' + decimal(-this._pitch) + 'rad) ';\n  transform += 'rotateY(' + decimal(this._yaw) + 'rad) ';\n\n  // Set the hotspot rotation.\n  transform += 'rotateY(' + decimal(-coords.yaw) + 'rad) ';\n  transform += 'rotateX(' + decimal(coords.pitch) + 'rad) ';\n\n  // Move back to sphere.\n  transform += 'translateZ(' + decimal(-radius) + 'px) ';\n\n  // Apply the extra transformations\n  transform += extraTransforms + ' ';\n\n  return transform;\n};\n\n\n/**\n * Factory functions for view limiters. See {@link RectilinearViewLimiter}.\n * @namespace\n */\nRectilinearView.limit = {\n\n  /**\n   * Returns a view limiter that constrains the yaw angle.\n   * @param {number} min The minimum yaw value.\n   * @param {number} max The maximum yaw value.\n   * @return {RectilinearViewLimiter}\n   */\n  yaw: function(min, max) {\n    return function limitYaw(params) {\n      params.yaw = clamp(params.yaw, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the pitch angle.\n   * @param {number} min The minimum pitch value.\n   * @param {number} max The maximum pitch value.\n   * @return {RectilinearViewLimiter}\n   */\n  pitch: function(min, max) {\n    return function limitPitch(params) {\n      params.pitch = clamp(params.pitch, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the roll angle.\n   * @param {number} min The minimum roll value.\n   * @param {number} max The maximum roll value.\n   * @return {RectilinearViewLimiter}\n   */\n  roll: function(min, max) {\n    return function limitRoll(params) {\n      params.roll = clamp(params.roll, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the horizontal field of view.\n   * @param {number} min The minimum horizontal field of view.\n   * @param {number} max The maximum horizontal field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  hfov: function(min, max) {\n    return function limitHfov(params) {\n      var width = params.width;\n      var height = params.height;\n      if (width > 0 && height > 0) {\n        var vmin = convertFov.htov(min, width, height);\n        var vmax = convertFov.htov(max, width, height);\n        params.fov = clamp(params.fov, vmin, vmax);\n      }\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the vertical field of view.\n   * @param {number} min The minimum vertical field of view.\n   * @param {number} max The maximum vertical field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  vfov: function(min, max) {\n    return function limitVfov(params) {\n      params.fov = clamp(params.fov, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that prevents zooming in beyond the given\n   * resolution.\n   * @param {number} size The cube face width in pixels or, equivalently, one\n   *     fourth of the equirectangular width in pixels.\n   * @return {RectilinearViewLimiter}\n   */\n  resolution: function(size) {\n    return function limitResolution(params) {\n      var height = params.height;\n      if (height) {\n        var requiredPixels = pixelRatio() * height;\n        var minFov = 2 * Math.atan(requiredPixels / size);\n        params.fov = clamp(params.fov, minFov, Infinity);\n      }\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that limits the horizontal and vertical field of\n   * view, prevents zooming in past the image resolution, and limits the pitch\n   * range to prevent the camera wrapping around at the poles. These are the\n   * most common view constraints for a 360° panorama.\n   * @param {number} maxResolution The cube face width in pixels or,\n   *     equivalently, one fourth of the equirectangular width in pixels.\n   * @param {number} maxVFov The maximum vertical field of view.\n   * @param {number} [maxHFov=maxVFov] The maximum horizontal field of view.\n   * @return {RectilinearViewLimiter}\n   */\n  traditional: function(maxResolution, maxVFov, maxHFov) {\n    maxHFov = maxHFov != null ? maxHFov : maxVFov;\n\n    return compose(\n      RectilinearView.limit.resolution(maxResolution),\n      RectilinearView.limit.vfov(0, maxVFov),\n      RectilinearView.limit.hfov(0, maxHFov),\n      RectilinearView.limit.pitch(-Math.PI/2, Math.PI/2));\n  }\n\n};\n\n\nRectilinearView.type = RectilinearView.prototype.type = 'rectilinear';\n\n\nmodule.exports = RectilinearView;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar mat4 = require('gl-matrix').mat4;\nvar vec4 = require('gl-matrix').vec4;\nvar pixelRatio = require('../util/pixelRatio');\nvar real = require('../util/real');\nvar clamp = require('../util/clamp');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n// Default viewport dimensions.\n// Start with zero to ensure that those values are handled correctly.\nvar defaultWidth = 0;\nvar defaultHeight = 0;\n\n// Default view parameters.\nvar defaultX = 0.5;\nvar defaultY = 0.5;\nvar defaultZoom = 1;\n\n// Constant values used to simplify the frustum culling logic.\n// planeAxes[i] indicates the coordinate value that defines a frustum plane.\n// planeCmp[i] indicates how point and plane coordinates should be compared\n// to determine whether the point is on the outer side of the plane.\nvar planeAxes = [\n  1, // top\n  0, // right\n  1, // bottom\n  0  // left\n];\nvar planeCmp = [\n  -1, // top\n  -1, // right\n   1, // bottom\n   1  // left\n];\n\n// A zoom of exactly 0 breaks some computations, so we force a minimum positive\n// value. We use 6 decimal places for the epsilon value to avoid broken\n// rendering due to loss of precision in floating point computations.\nvar zoomLimitEpsilon = 0.000001;\n\n\n/**\n * @interface FlatViewParams\n *\n * A camera configuration for a {@link FlatView}.\n *\n * @property {number} x The horizontal coordinate of the image point displayed\n *     at the viewport center, in the [0, 1] range.\n *     When `x === 0.5`, the image is centered horizontally.\n *     When `x === 0`, the left edge of the image is at the viewport center.\n *     When `x === 1`, the right edge of the image is at the viewport center.\n * @property {number} y The vertical coordinate of the image point displayed at\n *     the viewport center, in the [0, 1] range.\n *     When `y === 0.5`, the image is centered vertically.\n *     When `y === 0`, the top edge of the image is at the viewport center.\n *     When `y === 1`, the bottom edge of the image is at the viewport center.\n * @property {number} zoom The horizontal zoom, in the [0, ∞) range.\n *     When `zoom === 1`, the viewport is as wide as the image.\n *     When `zoom < 1`, the image is zoomed in.\n *     When `zoom > 1`, the image is zoomed out.\n * @property {number} mediaAspectRatio The image aspect ratio.\n *     When `mediaAspectRatio === 1`, the image width equals its height.\n *     When `mediaAspectRatio < 1`, the image width is less than its height.\n *     When `mediaAspectRatio > 1`, the image height is less than its width.\n */\n\n\n/**\n * @interface FlatViewCoords\n *\n * The position of a point in a flat image.\n *\n * @property {number} x The horizontal coordinate, in the [0, 1] range.\n * @property {number} y The vertical coordinate, in the [0, 1] range.\n */\n\n\n/**\n * @typedef {function} FlatViewLimiter\n *\n * View limiter for a {@link FlatView}.\n *\n * A view limiter is a function that receives a {@link FlatViewParams} object,\n * optionally modifies it in place, and returns it. It can be used to enforce\n * constraints on the view parameters.\n *\n * See {@link FlatView.limit} for commonly used limiters. They may be composed\n * together or with user-defined limiters with {@link util.compose}.\n *\n * @param {FlatViewParams} params\n * @return {FlatViewParams}\n */\n\n\n/**\n * @class FlatView\n * @implements View\n * @classdesc\n *\n * A {@link View} implementing an orthogonal projection for flat images.\n *\n * @param {FlatViewParams} params The initial view parameters. The\n *     `mediaAspectRatio` parameter must always be set. The other parameters\n *     default to `{x: 0.5, y: 0.5, z: 1 }` if unspecified.\n * @param {FlatViewLimiter=} limiter The view limiter. If unspecified, no view\n *     limiting is applied. See {@link FlatView.limit} for commonly used\n *     limiters.\n */\nfunction FlatView(params, limiter) {\n  // Require an aspect ratio to be specified.\n  if (!(params && params.mediaAspectRatio != null)) {\n    throw new Error('mediaAspectRatio must be defined');\n  }\n\n  // The initial values for the view parameters.\n  this._x = params && params.x != null ? params.x : defaultX;\n  this._y = params && params.y != null ? params.y : defaultY;\n  this._zoom = params && params.zoom != null ? params.zoom : defaultZoom;\n  this._mediaAspectRatio = params.mediaAspectRatio;\n  this._width = params && params.width != null ?\n    params.width : defaultWidth;\n  this._height = params && params.height != null ?\n    params.height : defaultHeight;\n\n  // The initial value for the view limiter.\n  this._limiter = limiter || null;\n\n  // The last calculated projection matrix and its inverse.\n  this._projMatrix = mat4.create();\n  this._invProjMatrix = mat4.create();\n\n  // The last calculated view frustum.\n  this._frustum = [\n    0, // top\n    0, // right\n    0, // bottom\n    0  // left\n  ];\n\n  // Whether the projection matrices and view frustum need to be updated.\n  this._projectionChanged = true;\n\n  // Temporary variables used for calculations.\n  this._params = {};\n  this._vec = vec4.create();\n\n  // Force view limiting on initial parameters.\n  this._update();\n}\n\neventEmitter(FlatView);\n\n\n/**\n * Destructor.\n */\nFlatView.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n\n/**\n * Get the x parameter.\n * @return {number}\n */\nFlatView.prototype.x = function() {\n  return this._x;\n};\n\n\n/**\n * Get the y parameter.\n * @return {number}\n */\nFlatView.prototype.y = function() {\n  return this._y;\n};\n\n\n/**\n * Get the zoom value.\n * @return {number}\n */\nFlatView.prototype.zoom = function() {\n  return this._zoom;\n};\n\n\n/**\n * Get the media aspect ratio.\n * @return {number}\n */\nFlatView.prototype.mediaAspectRatio = function() {\n  return this._mediaAspectRatio;\n};\n\n\n/**\n * Get the viewport width.\n * @return {number}\n */\nFlatView.prototype.width = function() {\n  return this._width;\n};\n\n\n/**\n * Get the viewport height.\n * @return {number}\n */\nFlatView.prototype.height = function() {\n  return this._height;\n};\n\n\n/**\n * Get the viewport dimensions. If an argument is supplied, it is filled in with\n * the result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {Size=} size\n * @return {Size}\n */\nFlatView.prototype.size = function(size) {\n  size = size || {};\n  size.width = this._width;\n  size.height = this._height;\n  return size;\n};\n\n\n/**\n * Get the view parameters. If an argument is supplied, it is filled in with the\n * result and returned. Otherwise, a fresh object is filled in and returned.\n * @param {FlatViewParams=} params\n * @return {FlatViewParams}\n */\nFlatView.prototype.parameters = function(params) {\n  params = params || {};\n  params.x = this._x;\n  params.y = this._y;\n  params.zoom = this._zoom;\n  params.mediaAspectRatio = this._mediaAspectRatio;\n  return params;\n};\n\n\n/**\n * Get the view limiter, or null if unset.\n * @return {?FlatViewLimiter}\n */\nFlatView.prototype.limiter = function() {\n  return this._limiter;\n};\n\n\n/**\n * Set the x parameter.\n * @param {number} x\n */\nFlatView.prototype.setX = function(x) {\n  this._resetParams();\n  this._params.x = x;\n  this._update(this._params);\n};\n\n\n/**\n * Set the y parameter.\n * @param {number} y\n */\nFlatView.prototype.setY = function(y) {\n  this._resetParams();\n  this._params.y = y;\n  this._update(this._params);\n};\n\n\n/**\n * Set the zoom value.\n * @param {number} zoom\n */\nFlatView.prototype.setZoom = function(zoom) {\n  this._resetParams();\n  this._params.zoom = zoom;\n  this._update(this._params);\n};\n\n\n/**\n * Add xOffset to the x parameter.\n * @param {number} xOffset\n */\nFlatView.prototype.offsetX = function(xOffset) {\n  this.setX(this._x + xOffset);\n};\n\n\n/**\n * Add yOffset to the y parameter.\n * @param {number} yOffset\n */\nFlatView.prototype.offsetY = function(yOffset)\n{\n  this.setY(this._y + yOffset);\n};\n\n\n/**\n * Add zoomOffset to the zoom value.\n * @param {number} zoomOffset\n */\nFlatView.prototype.offsetZoom = function(zoomOffset) {\n  this.setZoom(this._zoom + zoomOffset);\n};\n\n\n/**\n * Set the media aspect ratio.\n * @param {number} mediaAspectRatio\n */\nFlatView.prototype.setMediaAspectRatio = function(mediaAspectRatio) {\n  this._resetParams();\n  this._params.mediaAspectRatio = mediaAspectRatio;\n  this._update(this._params);\n};\n\n\n/**\n * Set the viewport dimensions.\n * @param {Size} size\n */\nFlatView.prototype.setSize = function(size) {\n  this._resetParams();\n  this._params.width = size.width;\n  this._params.height = size.height;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view parameters. Unspecified parameters are left unchanged.\n * @param {FlatViewParameters} params\n */\nFlatView.prototype.setParameters = function(params) {\n  this._resetParams();\n  this._params.x = params.x;\n  this._params.y = params.y;\n  this._params.zoom = params.zoom;\n  this._params.mediaAspectRatio = params.mediaAspectRatio;\n  this._update(this._params);\n};\n\n\n/**\n * Set the view limiter.\n * @param {?FlatViewLimiter} limiter The new limiter, or null to unset.\n */\nFlatView.prototype.setLimiter = function(limiter) {\n  this._limiter = limiter || null;\n  this._update();\n};\n\n\nFlatView.prototype._resetParams = function() {\n  var params = this._params;\n  params.x = null;\n  params.y = null;\n  params.zoom = null;\n  params.mediaAspectRatio = null;\n  params.width = null;\n  params.height = null;\n};\n\n\nFlatView.prototype._update = function(params) {\n\n  // Avoid object allocation when no parameters are supplied.\n  if (params == null) {\n    this._resetParams();\n    params = this._params;\n  }\n\n  // Save old parameters for later comparison.\n  var oldX = this._x;\n  var oldY = this._y;\n  var oldZoom = this._zoom;\n  var oldMediaAspectRatio = this._mediaAspectRatio;\n  var oldWidth = this._width;\n  var oldHeight = this._height;\n\n  // Fill in object with the new set of parameters to pass into the limiter.\n  params.x = params.x != null ? params.x : oldX;\n  params.y = params.y != null ? params.y : oldY;\n  params.zoom = params.zoom != null ? params.zoom : oldZoom;\n  params.mediaAspectRatio = params.mediaAspectRatio != null ?\n    params.mediaAspectRatio : oldMediaAspectRatio;\n  params.width = params.width != null ? params.width : oldWidth;\n  params.height = params.height != null ? params.height : oldHeight;\n\n  // Apply view limiting when defined.\n  if (this._limiter) {\n    params = this._limiter(params);\n    if (!params) {\n      throw new Error('Bad view limiter');\n    }\n  }\n\n  // Grab the limited parameters.\n  var newX = params.x;\n  var newY = params.y;\n  var newZoom = params.zoom;\n  var newMediaAspectRatio = params.mediaAspectRatio;\n  var newWidth = params.width;\n  var newHeight = params.height;\n\n  // Consistency check.\n  if (!real(newX) || !real(newY) || !real(newZoom) ||\n      !real(newMediaAspectRatio) || !real(newWidth) || !real(newHeight)) {\n    throw new Error('Bad view - suspect a broken limiter');\n  }\n\n  // Constrain zoom.\n  newZoom = clamp(newZoom, zoomLimitEpsilon, Infinity);\n\n  // Update parameters.\n  this._x = newX;\n  this._y = newY;\n  this._zoom = newZoom;\n  this._mediaAspectRatio = newMediaAspectRatio;\n  this._width = newWidth;\n  this._height = newHeight;\n\n  // Check whether the parameters changed and emit the corresponding events.\n  if (newX !== oldX || newY !== oldY || newZoom !== oldZoom ||\n      newMediaAspectRatio !== oldMediaAspectRatio ||\n      newWidth !== oldWidth || newHeight !== oldHeight) {\n    this._projectionChanged = true;\n    this.emit('change');\n  }\n  if (newWidth !== oldWidth || newHeight !== oldHeight) {\n    this.emit('resize');\n  }\n\n};\n\n\nFlatView.prototype._zoomX = function() {\n  return this._zoom;\n};\n\n\nFlatView.prototype._zoomY = function() {\n  var mediaAspectRatio = this._mediaAspectRatio;\n  var aspect = this._width / this._height;\n  var zoomX = this._zoom;\n  var zoomY = zoomX * mediaAspectRatio / aspect;\n  if (isNaN(zoomY)) {\n    zoomY = zoomX;\n  }\n  return zoomY;\n};\n\n\nFlatView.prototype.updateWithControlParameters = function(parameters) {\n  var scale = this.zoom();\n  var zoomX = this._zoomX();\n  var zoomY = this._zoomY();\n\n  // TODO: should the scale be the same for both axes?\n  this.offsetX(parameters.axisScaledX * zoomX + parameters.x * scale);\n  this.offsetY(parameters.axisScaledY * zoomY + parameters.y * scale);\n  this.offsetZoom(parameters.zoom * scale);\n};\n\n\nFlatView.prototype._updateProjection = function() {\n  var projMatrix = this._projMatrix;\n  var invProjMatrix = this._invProjMatrix;\n  var frustum = this._frustum;\n\n  // Recalculate projection matrix when required.\n  if (this._projectionChanged) {\n    var x = this._x;\n    var y = this._y;\n    var zoomX = this._zoomX();\n    var zoomY = this._zoomY();\n\n    // Recalculate view frustum.\n    var top     = frustum[0] = (0.5 - y) + 0.5 * zoomY;\n    var right   = frustum[1] = (x - 0.5) + 0.5 * zoomX;\n    var bottom  = frustum[2] = (0.5 - y) - 0.5 * zoomY;\n    var left    = frustum[3] = (x - 0.5) - 0.5 * zoomX;\n\n    // Recalculate projection matrix and its inverse.\n    mat4.ortho(projMatrix, left, right, bottom, top, -1, 1);\n    mat4.invert(invProjMatrix, projMatrix);\n\n    this._projectionChanged = false;\n  }\n};\n\n\n/**\n * Returns the projection matrix for the current view.\n * @returns {mat4}\n */\nFlatView.prototype.projection = function() {\n  this._updateProjection();\n  return this._projMatrix;\n};\n\n\n/**\n * Returns the inverse projection matrix for the current view.\n * @returns {mat4}\n */\nFlatView.prototype.inverseProjection = function() {\n  this._updateProjection();\n  return this._invProjMatrix;\n};\n\n\n/**\n * Return whether the view frustum intersects the given rectangle.\n *\n * This function may return false positives, but never false negatives.\n * It is used for frustum culling, i.e., excluding invisible tiles from the\n * rendering process.\n *\n * @param {vec3[]} rectangle The vertices of the rectangle.\n */\nFlatView.prototype.intersects = function(rectangle) {\n  this._updateProjection();\n\n  var frustum = this._frustum;\n\n  // Check whether the rectangle is on the outer side of any of the frustum\n  // planes. This is a sufficient condition, though not necessary, for the\n  // rectangle to be completely outside the fruouter\n  for (var i = 0; i < frustum.length; i++) {\n    var limit = frustum[i];\n    var axis = planeAxes[i];\n    var cmp = planeCmp[i];\n    var inside = false;\n    for (var j = 0; j < rectangle.length; j++) {\n      var vertex = rectangle[j];\n      if (cmp < 0 && vertex[axis] < limit || cmp > 0 && vertex[axis] > limit) {\n        inside = true;\n        break;\n      }\n    }\n    if (!inside) {\n      return false;\n    }\n  }\n  return true;\n};\n\n\n/**\n * Select the level that should be used to render the view.\n * @param {Level[]} levelList the list of levels from which to select.\n * @return {Level} the selected level.\n */\nFlatView.prototype.selectLevel = function(levels) {\n\n  // Multiply the viewport width by the device pixel ratio to get the required\n  // horizontal resolution in pixels.\n  //\n  // Calculate the fraction of the image that would be visible at the current\n  // zoom value. Then, for each level, multiply by the level width to get the\n  // width in pixels of the portion that would be visible.\n  //\n  // Search for the smallest level that satifies the the required width,\n  // falling back on the largest level if none do.\n\n  var requiredPixels = pixelRatio() * this.width();\n  var zoomFactor = this._zoom;\n\n  for (var i = 0; i < levels.length; i++) {\n    var level = levels[i];\n    if (zoomFactor * level.width() >= requiredPixels) {\n      return level;\n    }\n  }\n\n  return levels[levels.length - 1];\n\n};\n\n\n/**\n * Convert view coordinates into screen coordinates. If a result argument is\n * provided, it is filled in and returned. Otherwise, a fresh object is filled\n * in and returned.\n *\n * @param {FlatViewCoords} coords The view coordinates.\n * @param {Coords=} result The result argument for the screen coordinates.\n * @return {Coords}\n */\nFlatView.prototype.coordinatesToScreen = function(coords, result) {\n  var ray = this._vec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Undefined on a null viewport.\n  if (width <= 0 || height <= 0) {\n    result.x = null;\n    result.y = null;\n    return null;\n  }\n\n  // Extract coordinates from argument, filling in default values.\n  var x = coords && coords.x != null ? coords.x : defaultX;\n  var y = coords && coords.y != null ? coords.y : defaultY;\n\n  // Project view ray onto clip space.\n  vec4.set(ray, x - 0.5, 0.5 - y, -1, 1);\n  vec4.transformMat4(ray, ray, this.projection());\n\n  // Calculate perspective divide.\n  for (var i = 0; i < 3; i++) {\n    ray[i] /= ray[3];\n  }\n\n  // Convert to viewport coordinates and return.\n  result.x = width * (ray[0] + 1) / 2;\n  result.y = height * (1 - ray[1]) / 2;\n\n  return result;\n};\n\n\n/**\n * Convert screen coordinates into view coordinates. If a result argument is\n * provided, it is filled in with the result and returned. Otherwise, a fresh\n * object is filled in and returned.\n *\n * @param {Coords} coords The screen coordinates.\n * @param {FlatViewCoords=} result The result argument for the view coordinates.\n * @return {FlatViewCoords}\n */\nFlatView.prototype.screenToCoordinates = function(coords, result) {\n  var ray = this._vec;\n\n  if (!result) {\n    result = {};\n  }\n\n  var width = this._width;\n  var height = this._height;\n\n  // Convert viewport coordinates to clip space.\n  var vecx = 2 * coords.x / width - 1;\n  var vecy = 1 - 2 * coords.y / height;\n  vec4.set(ray, vecx, vecy, 1, 1);\n\n  // Project back to world space.\n  vec4.transformMat4(ray, ray, this.inverseProjection());\n\n  // Convert to flat coordinates.\n  result.x = 0.5 + ray[0];\n  result.y = 0.5 - ray[1];\n\n  return result;\n};\n\n\n/**\n * Factory functions for view limiters. See {@link FlatViewLimiter}.\n * @namespace\n */\nFlatView.limit = {\n\n  /**\n   * Returns a view limiter that constrains the x parameter.\n   * @param {number} min The minimum x value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  x: function(min, max) {\n    return function limitX(params) {\n      params.x = clamp(params.x, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Return a view limiter that constrains the y parameter.\n   * @param {number} min The minimum y value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  y: function(min, max) {\n    return function limitY(params) {\n      params.y = clamp(params.y, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter than constrains the zoom parameter.\n   * @param {number} min The minimum zoom value.\n   * @param {number} max The maximum zoom value.\n   * @return {FlatViewLimiter}\n   */\n  zoom: function(min, max) {\n    return function limitZoom(params) {\n      params.zoom = clamp(params.zoom, min, max);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that prevents zooming in beyond the given\n   * resolution.\n   * @param {number} size The image width in pixels.\n   * @return {FlatViewLimiter}\n   */\n  resolution: function(size) {\n    return function limitResolution(params) {\n      if (params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n      var width = params.width;\n      var minZoom = pixelRatio() * width / size;\n      params.zoom = clamp(params.zoom, minZoom, Infinity);\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the values of the x parameter that\n   * are inside the viewport.\n   * @param {number} min The minimum x value.\n   * @param {number} max The maximum x value.\n   * @return {FlatViewLimiter}\n   */\n  visibleX: function(min, max) {\n    return function limitVisibleX(params) {\n      // Calculate the zoom value that makes the specified range fully visible.\n      var maxZoom = max - min;\n\n      // Clamp zoom to the maximum value.\n      if (params.zoom > maxZoom) {\n        params.zoom = maxZoom;\n      }\n\n      // Bound X such that the image is visible up to the range edges.\n      var minX = min + 0.5 * params.zoom;\n      var maxX = max - 0.5 * params.zoom;\n      params.x = clamp(params.x, minX, maxX);\n\n      return params;\n    };\n  },\n\n  /**\n   * Returns a view limiter that constrains the values of the y parameter that\n   * are inside the viewport.\n   * @param {number} min The minimum y value.\n   * @param {number} max The maximum y value.\n   * @return {FlatViewLimiter}\n   */\n  visibleY: function(min, max) {\n    return function limitVisibleY(params) {\n\n      // Do nothing for a null viewport.\n      if (params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n\n      // Calculate the X to Y conversion factor.\n      var viewportAspectRatio = params.width / params.height;\n      var factor = viewportAspectRatio / params.mediaAspectRatio;\n\n      // Calculate the zoom value that makes the specified range fully visible.\n      var maxZoom = (max - min) * factor;\n\n      // Clamp zoom to the maximum value.\n      if (params.zoom > maxZoom) {\n        params.zoom = maxZoom;\n      }\n\n      // Bound Y such that the image is visible up to the range edges.\n      var minY = min + 0.5 * params.zoom / factor;\n      var maxY = max - 0.5 * params.zoom / factor;\n      params.y = clamp(params.y, minY, maxY);\n\n      return params;\n    };\n  },\n\n\n  /**\n   * Returns a view limiter that constrains the zoom parameter such that\n   * zooming out is prevented beyond the point at which the image is fully\n   * visible. Unless the image and the viewport have the same aspect ratio,\n   * this will cause bands to appear around the image.\n   * @return {FlatViewLimiter}\n   */\n  letterbox: function() {\n    return function limitLetterbox(params) {\n      if(params.width <= 0 || params.height <= 0) {\n        return params;\n      }\n      var viewportAspectRatio = params.width / params.height;\n\n      var fullWidthZoom = 1.0;\n      var fullHeightZoom = viewportAspectRatio / params.mediaAspectRatio;\n\n      // If the image is wider than the viewport, limit the horizontal zoom to\n      // the image width.\n      if (params.mediaAspectRatio >= viewportAspectRatio) {\n        params.zoom = Math.min(params.zoom, fullWidthZoom);\n      }\n\n      // If the image is narrower than the viewport, limit the vertical zoom to\n      // the image height.\n      if (params.mediaAspectRatio <= viewportAspectRatio) {\n        params.zoom = Math.min(params.zoom, fullHeightZoom);\n      }\n\n      // If the full image width is visible, limit x to the central point.\n      // Else, bound x such that image is visible up to the horizontal edges.\n      var minX, maxX;\n      if (params.zoom > fullWidthZoom) {\n        minX = maxX = 0.5;\n      } else {\n        minX = 0.0 + 0.5 * params.zoom / fullWidthZoom;\n        maxX = 1.0 - 0.5 * params.zoom / fullWidthZoom;\n      }\n\n      // If the full image height is visible, limit y to the central point.\n      // Else, bound y such that image is visible up to the vertical edges.\n      var minY, maxY;\n      if (params.zoom > fullHeightZoom) {\n        minY = maxY = 0.5;\n      } else {\n        minY = 0.0 + 0.5 * params.zoom / fullHeightZoom;\n        maxY = 1.0 - 0.5 * params.zoom / fullHeightZoom;\n      }\n\n      // Clamp x and y into the calculated bounds.\n      params.x = clamp(params.x, minX, maxX);\n      params.y = clamp(params.y, minY, maxY);\n\n      return params;\n    };\n  }\n\n};\n\n\nFlatView.type = FlatView.prototype.type = 'flat';\n\n\nmodule.exports = FlatView;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar WorkQueue = require('./WorkQueue');\nvar mod = require('../util/mod');\n\n\nfunction WorkPool(opts) {\n  this._concurrency = opts && opts.concurrency || 1;\n  this._paused = opts && !!opts.paused || false;\n\n  this._pool = [];\n  for (var i = 0; i < this._concurrency; i++) {\n    this._pool.push(new WorkQueue(opts));\n  }\n\n  this._next = 0;\n}\n\n\nWorkPool.prototype.length = function() {\n  var len = 0;\n  for (var i = 0; i < this._pool.length; i++) {\n    len += this._pool[i].length();\n  }\n  return len;\n};\n\n\nWorkPool.prototype.push = function(fn, cb) {\n  var i = this._next;\n  var cancel = this._pool[i].push(fn, cb);\n  this._next = mod(this._next + 1, this._concurrency);\n  return cancel;\n};\n\n\nWorkPool.prototype.pause = function() {\n  if (!this._paused) {\n    this._paused = true;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].pause();\n    }\n  }\n};\n\n\nWorkPool.prototype.resume = function() {\n  if (this._paused) {\n    this._paused = false;\n    for (var i = 0; i < this._concurrency; i++) {\n      this._pool[i].resume();\n    }\n  }\n};\n\n\nmodule.exports = WorkPool;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction noop() {}\n\nmodule.exports = noop;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar noop = require('./noop');\n\n// Return a function that executes its arguments (which should be cancelables)\n// in sequence, so that each of them passes its return values to the next.\n// Execution is aborted if one of the functions returns an error; in that case\n// the last function in the sequence is called with the error.\n// See util/cancelize.js for an explanation of what cancelables are.\nfunction chain() {\n\n  // The list of functions to chain together.\n  var argList = Array.prototype.slice.call(arguments, 0);\n\n  return function chained() {\n\n    // List of remaining functions to be executed.\n    // Make a copy of the original list so we can mutate the former while\n    // preserving the latter intact for future invocations of the chain.\n    var fnList = argList.slice(0);\n\n    // Currently executing function.\n    var fn = null;\n\n    // Cancel method for the currently executing function.\n    var cfn = null;\n\n    // Arguments for the first function.\n    var args = arguments.length ? Array.prototype.slice.call(arguments, 0, arguments.length - 1) : [];\n\n    // Callback for the chain.\n    var done = arguments.length ? arguments[arguments.length - 1] : noop;\n\n    // Execute the next function in the chain.\n    // Receives the error and return values from the previous function.\n    function exec() {\n\n      // Extract error from arguments.\n      var err = arguments[0];\n\n      // Abort chain on error.\n      if (err) {\n        fn = cfn = null;\n        done.apply(null, arguments);\n        return;\n      }\n\n      // Terminate if there are no functions left in the chain.\n      if (!fnList.length) {\n        fn = cfn = null;\n        done.apply(null, arguments);\n        return;\n      }\n\n      // Advance to the next function in the chain.\n      fn = fnList.shift();\n      var _fn = fn;\n\n      // Extract arguments to pass into the next function.\n      var ret = Array.prototype.slice.call(arguments, 1);\n\n      // Call next function with previous return value and call back exec.\n      ret.push(exec);\n      var _cfn = fn.apply(null, ret); // fn(null, ret..., exec)\n\n      // Detect when fn has completed synchronously and do not clobber the\n      // internal state in that case. You're not expected to understand this.\n      if (_fn !== fn) {\n        return;\n      }\n\n      // Remember the cancel method for the currently executing function.\n      // Detect chaining on non-cancellable function.\n      if (typeof _cfn !== 'function') {\n        throw new Error('chain: chaining on non-cancellable function');\n      } else {\n        cfn = _cfn;\n      }\n\n    }\n\n    // Cancel chain execution.\n    function cancel() {\n      if (cfn) {\n        cfn.apply(null, arguments);\n      }\n    }\n\n    // Start chain execution.\n    // We call exec as if linking from a previous function in the chain,\n    // except that the error is always null. As a consequence, chaining on an\n    // empty list yields the identity function.\n    args.unshift(null);\n    exec.apply(null, args); // exec(null, args...)\n\n    return cancel;\n\n  };\n\n}\n\nmodule.exports = chain;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n// Perform a cancelable delay.\n// See util/cancelize.js for an explanation of what cancelables are.\nfunction delay(ms, done) {\n\n  // Work around IE8 bug whereby a setTimeout callback may still be called\n  // after the corresponding clearTimeout is invoked.\n  var timer = null;\n\n  function finish() {\n    if (timer != null) {\n      timer = null;\n      done(null);\n    }\n  }\n\n  function cancel() {\n    if (timer != null) {\n      clearTimeout(timer);\n      timer = null;\n      done.apply(null, arguments);\n    }\n  }\n\n  timer = setTimeout(finish, ms);\n\n  return cancel;\n\n}\n\nmodule.exports = delay;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar NetworkError = require('../NetworkError');\nvar WorkPool = require('../collections/WorkPool');\nvar chain = require('../util/chain');\nvar delay = require('../util/delay');\nvar now = require('../util/now');\n\n\n// Map template properties to their corresponding tile properties.\nvar templateProperties = {\n  x: 'x',\n  y: 'y',\n  z: 'z',\n  f: 'face'\n};\n\n// Default face order for cube maps.\nvar defaultCubeMapFaceOrder = 'bdflru';\n\n// Default maximum number of concurrent requests.\nvar defaultConcurrency = 4;\n\n// Default milliseconds to wait before retrying failed requests.\nvar defaultRetryDelay = 10000;\n\n\n/**\n * @class ImageUrlSource\n * @implements Source\n * @classdesc\n *\n * A {@link Source} that loads {@link Asset assets} from images given a URL and\n * a crop rectangle.\n *\n * @param {Function} sourceFromTile Function that receives a tile and returns\n * a `{ url, rect }` object, where `url` is an image URL and `rect`, when\n * present, is an `{ x, y, width, height }` object in normalized coordinates\n * denoting the portion of the image to use.\n * @param {Object} opts\n * @param {number} [opts.concurrency=4] Maximum number of tiles to request at\n *     the same time. The limit is per {@link ImageSourceUrl} instance.\n * @param {number} [opts.retryDelay=10000] Time in milliseconds to wait before\n *     retrying a failed request.\n */\nfunction ImageUrlSource(sourceFromTile, opts) {\n\n  opts = opts ? opts : {};\n\n  this._loadPool = new WorkPool({\n    concurrency: opts.concurrency || defaultConcurrency\n  });\n\n  this._retryDelay = opts.retryDelay || defaultRetryDelay;\n  this._retryMap = {};\n\n  this._sourceFromTile = sourceFromTile;\n}\n\neventEmitter(ImageUrlSource);\n\n\nImageUrlSource.prototype.loadAsset = function(stage, tile, done) {\n\n  var self = this;\n\n  var retryDelay = this._retryDelay;\n  var retryMap = this._retryMap;\n\n  var tileSource = this._sourceFromTile(tile);\n  var url = tileSource.url;\n  var rect = tileSource.rect;\n\n  var loadImage = stage.loadImage.bind(stage, url, rect);\n\n  var loadFn = function(done) {\n    // TODO: Deduplicate load requests for the same URL. Although the browser\n    // might be smart enough to avoid duplicate requests, they are still unduly\n    // impacted by the concurrency parameter.\n    return self._loadPool.push(loadImage, function(err, asset) {\n      if (err) {\n        if (err instanceof NetworkError) {\n          // If a network error occurred, wait before retrying.\n          retryMap[url] = now();\n          self.emit('networkError', err, tile);\n        }\n        done(err, tile);\n      } else {\n        // On a successful fetch, forget the previous timeout.\n        delete retryMap[url];\n        done(null, tile, asset);\n      }\n    });\n  };\n\n  // Check whether we are retrying a failed request.\n  var delayAmount;\n  var lastTime = retryMap[url];\n  if (lastTime != null) {\n    var currentTime = now();\n    var elapsed = currentTime - lastTime;\n    if (elapsed < retryDelay) {\n      // Wait before retrying.\n      delayAmount = retryDelay - elapsed;\n    } else {\n      // Retry timeout expired; perform the request at once.\n      delayAmount = 0;\n      delete retryMap[url];\n    }\n  }\n\n  var delayFn = delay.bind(null, delayAmount);\n\n  return chain(delayFn, loadFn)(done);\n};\n\n\n/**\n * Creates an ImageUrlSource from a string template.\n *\n * @param {String} url Tile URL template, which may contain the following\n *    placeholders:\n *    - `{f}` : tile face (one of `b`, `d`, `f`, `l`, `r`, `u`)\n *    - `{z}` : tile level index (0 is the smallest level)\n *    - `{x}` : tile horizontal index\n *    - `{y}` : tile vertical index\n * @param {Object} opts In addition to the options already supported by the\n *     {@link ImageUrlSource} constructor.\n * @param {String} opts.cubeMapPreviewUrl URL to use as the preview level.\n *     This must be a single image containing six cube faces laid out\n *     vertically according to the face order parameter.\n * @param {String} [opts.cubeMapPreviewFaceOrder='bdflru'] Face order within\n *     the preview image.\n */\nImageUrlSource.fromString = function(url, opts) {\n  opts = opts || {};\n\n  var faceOrder = opts && opts.cubeMapPreviewFaceOrder || defaultCubeMapFaceOrder;\n\n  var urlFn = opts.cubeMapPreviewUrl ? withPreview : withoutPreview;\n\n  return new ImageUrlSource(urlFn, opts);\n\n  function withoutPreview(tile) {\n    var tileUrl = url;\n\n    for (var property in templateProperties) {\n      var templateProperty = templateProperties[property];\n      var regExp = propertyRegExp(property);\n      var valueFromTile = tile.hasOwnProperty(templateProperty) ? tile[templateProperty] : '';\n      tileUrl = tileUrl.replace(regExp, valueFromTile);\n    }\n\n    return { url: tileUrl };\n  }\n\n  function withPreview(tile) {\n    if (tile.z === 0) {\n      return cubeMapUrl(tile);\n    }\n    else {\n      return withoutPreview(tile);\n    }\n  }\n\n  function cubeMapUrl(tile) {\n    var y = faceOrder.indexOf(tile.face) / 6;\n    return {\n      url: opts.cubeMapPreviewUrl,\n      rect: { x: 0, y: y, width: 1, height: 1/6 }\n    };\n  }\n};\n\nfunction propertyRegExp(property) {\n  var regExpStr = '\\\\{(' + property + ')\\\\}';\n  return new RegExp(regExpStr, 'g');\n}\n\nmodule.exports = ImageUrlSource;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class SingleAssetSource\n * @implements Source\n * @classdesc\n *\n * A {@link Source} that always provides the same {@link Asset}.\n *\n * @param {Asset} asset The asset.\n*/\nfunction SingleAssetSource(asset) {\n  this._asset = asset;\n}\n\nSingleAssetSource.prototype.asset = function() {\n  return this._asset;\n};\n\nSingleAssetSource.prototype.loadAsset = function(stage, tile, done) {\n  var self = this;\n\n  var timeout = setTimeout(function() {\n    done(null, tile, self._asset);\n  }, 0);\n\n  function cancel() {\n    clearTimeout(timeout);\n    done.apply(null, arguments);\n  }\n\n  return cancel;\n};\n\nmodule.exports = SingleAssetSource;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar StaticAsset = require('./Static');\nvar inherits = require('../util/inherits');\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class DynamicAsset\n * @implements Asset\n * @extends StaticAsset\n * @classdesc\n *\n * An {@link Asset} whose pixel contents may change.\n *\n * @param {HTMLImageElement|HTMLCanvasElement|ImageBitmap} element The\n *     underlying pixel source.\n * @throws If the pixel source is unsupported.\n */\nfunction DynamicAsset(element) {\n  this.constructor.super_.call(this, element);\n  this._timestamp = 0;\n}\n\ninherits(DynamicAsset, StaticAsset);\neventEmitter(DynamicAsset);\n\n/**\n * Destructor.\n */\nDynamicAsset.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\nDynamicAsset.prototype.timestamp = function() {\n  return this._timestamp;\n};\n\nDynamicAsset.prototype.isDynamic = function() {\n  return true;\n};\n\n/**\n * Marks the asset dirty, signaling that the contents of the underlying pixel\n * source have changed.\n *\n * @throws If the asset is not dynamic.\n */\nDynamicAsset.prototype.markDirty = function() {\n  this._timestamp++;\n  this.emit('change');\n};\n\nmodule.exports = DynamicAsset;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\nvar defaultCapacity = 64;\n\n// A map data structure for keys implementing hash() and equals() and arbitrary\n// values. The capacity, if given, is just a hint; the map is allowed to exceed\n// it, but performance may suffer.\nfunction Map(capacity) {\n  if (capacity != null &&\n      (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 1)) {\n    throw new Error('Map: invalid capacity');\n  }\n  this._capacity = capacity || defaultCapacity;\n\n  this._keyBuckets = [];\n  this._valBuckets = [];\n  for (var i = 0; i < this._capacity; i++) {\n    this._keyBuckets.push([]);\n    this._valBuckets.push([]);\n  }\n  this._size = 0;\n}\n\n// Returns the value associated with the specified key, or null if not found.\nMap.prototype.get = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var valBucket = this._valBuckets[h];\n      var existingValue = valBucket[i];\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Associates the specified value with the specified key, possibly replacing the\n// currently associated value.\n// Returns the replaced value, or null if no value was replaced.\nMap.prototype.set = function(key, val) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  var valBucket = this._valBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var existingValue = valBucket[i];\n      keyBucket[i] = key;\n      valBucket[i] = val;\n      return existingValue;\n    }\n  }\n  keyBucket.push(key);\n  valBucket.push(val);\n  this._size++;\n  return null;\n};\n\n// Removes the key-value pair associated with the specified key.\n// Returns the removed value, or null if not found.\nMap.prototype.del = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  var valBucket = this._valBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      var existingValue = valBucket[i];\n      // Splice manually to avoid Array#splice return value allocation.\n      for (var j = i; j < keyBucket.length - 1; j++) {\n        keyBucket[j] = keyBucket[j+1];\n        valBucket[j] = valBucket[j+1];\n      }\n      keyBucket.length = keyBucket.length - 1;\n      valBucket.length = valBucket.length - 1;\n      this._size--;\n      return existingValue;\n    }\n  }\n  return null;\n};\n\n// Returns whether there is a value associated with the specified key.\nMap.prototype.has = function(key) {\n  var h = mod(key.hash(), this._capacity);\n  var keyBucket = this._keyBuckets[h];\n  for (var i = 0; i < keyBucket.length; i++) {\n    var existingKey = keyBucket[i];\n    if (key.equals(existingKey)) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of key-value pairs in the map.\nMap.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all key-value pairs from the map.\nMap.prototype.clear = function() {\n  for (var i = 0; i < this._capacity; i++) {\n    this._keyBuckets[i].length = 0;\n    this._valBuckets[i].length = 0;\n  }\n  this._size = 0;\n};\n\n// Calls fn(key, value) for each key-value pair in the map, in an unspecified\n// order. Returns the number of times fn was called.\n// The result is unspecified if the map is mutated during iteration.\nMap.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._capacity; i++) {\n    var keyBucket = this._keyBuckets[i];\n    var valBucket = this._valBuckets[i];\n    for (var j = 0; j < keyBucket.length; j++) {\n      fn(keyBucket[j], valBucket[j]);\n      count += 1;\n    }\n  }\n  return count;\n};\n\nmodule.exports = Map;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar mod = require('../util/mod');\n\n// An LruSet holds up to a maximum number of elements, ordered by their time of\n// insertion. When the addition of an element would cause the capacity to be\n// exceeded, the oldest element in the set is evicted. As a special case, an\n// LruSet with zero capacity always rejects the insertion of an element.\n//\n// Elements must implement hash() and equals(). Note that the implementation\n// doesn't currently use hash(), but a future version might.\nfunction LruSet(capacity) {\n  if (!isFinite(capacity) || Math.floor(capacity) !== capacity || capacity < 0) {\n    throw new Error('LruSet: invalid capacity');\n  }\n  this._capacity = capacity;\n\n  // Elements are stored in a circular array ordered by decreasing age.\n  // Start is the index of the oldest element and size is the number of valid\n  // elements; the region containing valid elements may wrap around.\n  this._elements = new Array(this._capacity);\n  this._start = 0;\n  this._size = 0;\n}\n\nLruSet.prototype._index = function(i) {\n  return mod(this._start + i, this._capacity);\n};\n\n// Adds an element into the set, possibly replacing an equal element already in\n// the set. The element becomes the newest. If the set is at capacity, the\n// oldest element is removed. Returns the removed element if it does not equal\n// the inserted element, or null otherwise. If the capacity is zero, does\n// nothing and returns the element.\nLruSet.prototype.add = function(element) {\n  if (this._capacity === 0) {\n    return element;\n  }\n  this.remove(element);\n  var evictedElement =\n      this._size === this._capacity ? this._elements[this._index(0)] : null;\n  this._elements[this._index(this._size)] = element;\n  if (this._size < this._capacity) {\n    this._size++;\n  } else {\n    this._start = this._index(1);\n  }\n  return evictedElement;\n};\n\n// Removes an element from the set.\n// Returns the removed element, or null if the element was not found.\nLruSet.prototype.remove = function(element) {\n  for (var i = 0; i < this._size; i++) {\n    var existingElement = this._elements[this._index(i)];\n    if (element.equals(existingElement)) {\n      for (var j = i; j < this._size - 1; j++) {\n        this._elements[this._index(j)] = this._elements[this._index(j + 1)];\n      }\n      this._size--;\n      return existingElement;\n    }\n  }\n  return null;\n};\n\n// Returns whether an element is in the set.\nLruSet.prototype.has = function(element) {\n  for (var i = 0; i < this._size; i++) {\n    if (element.equals(this._elements[this._index(i)])) {\n      return true;\n    }\n  }\n  return false;\n};\n\n// Returns the number of elements in the set.\nLruSet.prototype.size = function() {\n  return this._size;\n};\n\n// Removes all elements from the set.\nLruSet.prototype.clear = function() {\n  this._elements.length = 0;\n  this._start = 0;\n  this._size = 0;\n};\n\n// Calls fn(element) for each element in the set, in an unspecified order.\n// Returns the number of times fn was called.\n// The result is unspecified if the set is mutated during iteration.\nLruSet.prototype.forEach = function(fn) {\n  var count = 0;\n  for (var i = 0; i < this._size; i++) {\n    fn(this._elements[this._index(i)]);\n    count += 1;\n  }\n  return count;\n};\n\nmodule.exports = LruSet;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction defaults(obj, defaultsObj) {\n  for (var key in defaultsObj) {\n    if (!(key in obj)) {\n      obj[key] = defaultsObj[key];\n    }\n  }\n  return obj;\n}\n\nmodule.exports = defaults;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar noop = require('./noop');\n\n// Return a cancelable function that executes fn in a loop until it returns\n// successfully.\nfunction retry(fn) {\n\n  return function retried() {\n\n    var args = arguments.length ? Array.prototype.slice.call(arguments, 0, arguments.length - 1) : [];\n    var done = arguments.length ? arguments[arguments.length - 1] : noop;\n\n    var cfn = null;\n    var canceled = false;\n\n    function exec() {\n      var err = arguments[0];\n      if (!err || canceled) {\n        done.apply(null, arguments);\n      } else {\n        cfn = fn.apply(null, args);\n      }\n    }\n\n    args.push(exec);\n    exec(true);\n\n    return function cancel() {\n      canceled = true;\n      cfn.apply(null, arguments);\n    };\n\n  };\n\n}\n\nmodule.exports = retry;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Map = require('./collections/Map');\nvar Set = require('./collections/Set');\nvar LruSet = require('./collections/LruSet');\nvar eventEmitter = require('minimal-event-emitter');\nvar defaults = require('./util/defaults');\nvar retry = require('./util/retry');\nvar chain = require('./util/chain');\nvar inherits = require('./util/inherits');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.textureStore;\n\n\n// A Stage informs the TextureStore about the set of visible tiles during a\n// frame by calling startFrame, markTile and endFrame. In a particular frame,\n// TextureStore expects one or more calls to startFrame, followed by zero or\n// more calls to markTile, followed by one or more calls to endFrame. The\n// number of calls to startFrame and endFrame must match. Calls to other\n// TextureStore methods may be freely interleaved with this sequence.\n//\n// At any given time, TextureStore is in one of four states. The START state\n// corresponds to the interval between the first startFrame and the first\n// markTile of a frame. The MARK state corresponds to the interval between the\n// first markTile and the first endFrame. The END state corresponds to the\n// interval between the first and the last endFrame. At any other time, the\n// TextureStore is in the IDLE state.\nvar State = {\n  IDLE: 0,\n  START: 1,\n  MARK: 2,\n  END: 3\n};\n\n\nvar defaultOptions = {\n  // Maximum number of cached textures for previously visible tiles.\n  previouslyVisibleCacheSize: 512\n};\n\n\n// Assign an id to each operation so we can track its state.\n// We actually only need this in debug mode, but the code is less convoluted\n// if we track unconditionally, and the performance hit is minimal anyway.\nvar nextId = 0;\n\n\n// Distinguishes a cancellation from other kinds of errors.\nfunction CancelError() {}\ninherits(CancelError, Error);\n\n\n/**\n * @class TextureStoreItem\n * @classdesc\n *\n * An item saved in a {@link TextureStore}.\n *\n * Clients do not need to instantiate this. It is automatically instantiated by\n * a {@link TextureStore} to manage the lifetime of a stored item: loading,\n * refreshing, unloading and emitting associated events.\n *\n * @param {TextureStore} store The underlying {@link TextureStore}.\n * @param {Tile} tile The underlying tile.\n */\nfunction TextureStoreItem(store, tile) {\n\n  var self = this;\n\n  var id = nextId++;\n\n  self._id = id;\n  self._store = store;\n  self._tile = tile;\n\n  self._asset = null;\n  self._texture = null;\n\n  self._changeHandler = function() {\n    store.emit('textureInvalid', tile);\n  };\n\n  var source = store.source();\n  var stage = store.stage();\n\n  var loadAsset = source.loadAsset.bind(source);\n  var createTexture = stage.createTexture.bind(stage);\n\n  // Retry loading the asset until it succeeds, then create the texture from it.\n  // This process may be canceled at any point by calling the destroy() method.\n  var fn = chain(retry(loadAsset), createTexture);\n\n  store.emit('textureStartLoad', tile);\n  if (debug) {\n    console.log('loading', id, tile);\n  }\n\n  self._cancel = fn(stage, tile, function(err, _tile, asset, texture) {\n\n    // Make sure we do not call cancel after the operation is complete.\n    self._cancel = null;\n\n    if (err) {\n      // The loading process was interrupted by an error.\n      // This could either be because the texture creation failed, or because\n      // the operation was canceled before the loading was complete.\n\n      // Destroy the asset and texture, if they exist.\n      if (asset) {\n        asset.destroy();\n      }\n      if (texture) {\n        texture.destroy();\n      }\n\n      // Emit events.\n      if (err instanceof CancelError) {\n        store.emit('textureCancel', tile);\n        if (debug) {\n          console.log('cancel', id, tile);\n        }\n      } else {\n        store.emit('textureError', tile, err);\n        if (debug) {\n          console.log('error', id, tile);\n        }\n      }\n\n      return;\n    }\n\n    // Save a local reference to the texture.\n    self._texture = texture;\n\n    // If the asset is dynamic, save a local reference to it and set up a\n    // handler to be called whenever it changes. Otherwise, destroy the asset\n    // as we won't be needing it any longer.\n    if (asset.isDynamic()) {\n      self._asset = asset;\n      asset.addEventListener('change', self._changeHandler);\n    } else {\n      asset.destroy();\n    }\n\n    // Emit event.\n    store.emit('textureLoad', tile);\n    if (debug) {\n      console.log('load', id, tile);\n    }\n  });\n\n}\n\n\nTextureStoreItem.prototype.asset = function() {\n  return this._asset;\n};\n\n\nTextureStoreItem.prototype.texture = function() {\n  return this._texture;\n};\n\n\nTextureStoreItem.prototype.destroy = function() {\n  var id = this._id;\n  var store = this._store;\n  var tile = this._tile;\n  var asset = this._asset;\n  var texture = this._texture;\n  var cancel = this._cancel;\n\n  if (cancel) {\n    // The texture is still loading, so cancel it.\n    cancel(new CancelError('Texture load cancelled'));\n    return;\n  }\n\n  // Destroy asset.\n  if (asset) {\n    asset.removeEventListener('change', this._changeHandler);\n    asset.destroy();\n  }\n\n  // Destroy texture.\n  if (texture) {\n    texture.destroy();\n  }\n\n  // Emit event.\n  store.emit('textureUnload', tile);\n  if (debug) {\n    console.log('unload', id, tile);\n  }\n\n  clearOwnProperties(this);\n};\n\neventEmitter(TextureStoreItem);\n\n/**\n * Signals that a texture has started to load.\n *\n * This event is followed by either {@link TextureStore#textureLoad},\n * {@link TextureStore#textureError} or {@link TextureStore#textureCancel}.\n *\n * @event TextureStore#textureStartLoad\n * @param {Tile} tile The tile for which the texture has started to load.\n */\n\n/**\n * Signals that a texture has been loaded.\n *\n * @event TextureStore#textureLoad\n * @param {Tile} tile The tile for which the texture was loaded.\n */\n\n/**\n * Signals that a texture has been unloaded.\n *\n * @event TextureStore#textureUnload\n * @param {Tile} tile The tile for which the texture was unloaded.\n */\n\n/**\n * Signals that a texture has been invalidated.\n *\n * This event may be raised for a texture with an underlying dynamic asset. It\n * may only occur while the texture is loaded, i.e., in between\n * {@link TextureStore#textureLoad} and {@link TextureStore#textureUnload}.\n *\n * @event TextureStore#textureInvalid\n * @param {Tile} tile The tile for which the texture was invalidated.\n */\n\n/**\n * Signals that loading a texture has been cancelled.\n *\n * This event may follow {@link TextureStore#textureStartLoad} if the texture\n * becomes unnecessary before it finishes loading.\n *\n * @event TextureStore#textureCancel\n * @param {Tile} tile The tile for which the texture loading was cancelled.\n */\n\n/**\n * Signals that loading a texture has failed.\n *\n * This event may follow {@link TextureStore#textureStartLoad} if the texture\n * fails to load.\n *\n * @event TextureStore#textureError\n * @param {Tile} tile The tile for which the texture loading has failed.\n */\n\n/**\n * @class TextureStore\n * @classdesc\n *\n * A TextureStore maintains a cache of textures used to render a {@link Layer}.\n *\n * A {@link Stage} communicates with the TextureStore through the startFrame(),\n * markTile() and endFrame() methods, which indicate the tiles that are visible\n * in the current frame. Textures for visible tiles are loaded and retained\n * as long as the tiles remain visible. A limited amount of textures whose\n * tiles were previously visible are cached according to an LRU policy. Tiles\n * may be pinned to keep their respective textures cached even when they are\n * invisible; these textures do not count towards the previously visible limit.\n *\n * Multiple layers belonging to the same underlying {@link WebGlStage} may\n * share the same TextureStore. Layers belonging to distinct {@link WebGlStage}\n * instances may not do so due to restrictions on the use of textures across\n * stages.\n *\n * @param {Source} source The underlying source.\n * @param {Stage} stage The underlying stage.\n * @param {Object} opts Options.\n * @param {Number} [opts.previouslyVisibleCacheSize=32] The maximum number of\n *     previously visible textures to cache according to an LRU policy.\n */\nfunction TextureStore(source, stage, opts) {\n  opts = defaults(opts || {}, defaultOptions);\n\n  this._source = source;\n  this._stage = stage;\n\n  // The current state.\n  this._state = State.IDLE;\n\n  // The number of startFrame calls yet to be matched by endFrame calls during\n  // the current frame.\n  this._delimCount = 0;\n\n  // The cache proper: map cached tiles to their respective textures/assets.\n  this._itemMap = new Map();\n\n  // The subset of cached tiles that are currently visible.\n  this._visible = new Set();\n\n  // The subset of cached tiles that were visible recently, but are not\n  // visible right now. Newly inserted tiles replace older ones.\n  this._previouslyVisible = new LruSet(opts.previouslyVisibleCacheSize);\n\n  // The subset of cached tiles that should never be evicted from the cache.\n  // A tile may be pinned more than once; map each tile into a reference count.\n  this._pinMap = new Map();\n\n  // Temporary variables.\n  this._newVisible = new Set();\n  this._noLongerVisible = [];\n  this._visibleAgain = [];\n  this._evicted = [];\n}\n\neventEmitter(TextureStore);\n\n\n/**\n * Destructor.\n */\nTextureStore.prototype.destroy = function() {\n  this.clear();\n  clearOwnProperties(this);\n};\n\n\n/**\n * Return the underlying {@link Stage}.\n * @return {Stage}\n */\nTextureStore.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Return the underlying {@link Source}.\n * @return {Source}\n */\nTextureStore.prototype.source = function() {\n  return this._source;\n};\n\n\n/**\n * Remove all textures from the TextureStore, including pinned textures.\n */\nTextureStore.prototype.clear = function() {\n  var self = this;\n\n  // Collect list of tiles to be evicted.\n  self._evicted.length = 0;\n  self._itemMap.forEach(function(tile) {\n    self._evicted.push(tile);\n  });\n\n  // Evict tiles.\n  self._evicted.forEach(function(tile) {\n    self._unloadTile(tile);\n  });\n\n  // Clear all internal state.\n  self._itemMap.clear();\n  self._visible.clear();\n  self._previouslyVisible.clear();\n  self._pinMap.clear();\n  self._newVisible.clear();\n  self._noLongerVisible.length = 0;\n  self._visibleAgain.length = 0;\n  self._evicted.length = 0;\n};\n\n\n/**\n * Remove all textures in the TextureStore, excluding unpinned textures.\n */\nTextureStore.prototype.clearNotPinned = function() {\n  var self = this;\n\n  // Collect list of tiles to be evicted.\n  self._evicted.length = 0;\n  self._itemMap.forEach(function(tile) {\n    if (!self._pinMap.has(tile)) {\n      self._evicted.push(tile);\n    }\n  });\n\n  // Evict tiles.\n  self._evicted.forEach(function(tile) {\n    self._unloadTile(tile);\n  });\n\n  // Clear all caches except the pinned set.\n  self._visible.clear();\n  self._previouslyVisible.clear();\n\n  // Clear temporary variables.\n  self._evicted.length = 0;\n};\n\n\n/**\n * Signal the beginning of a frame. Called from {@link Stage}.\n */\nTextureStore.prototype.startFrame = function() {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.IDLE && this._state !== State.START) {\n    throw new Error('TextureStore: startFrame called out of sequence');\n  }\n\n  // Enter the START state, if not already there.\n  this._state = State.START;\n\n  // Expect one more endFrame call.\n  this._delimCount++;\n};\n\n\n/**\n * Mark a tile as visible within the current frame. Called from {@link Stage}.\n * @param {Tile} tile The tile to mark.\n */\nTextureStore.prototype.markTile = function(tile) {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.START && this._state !== State.MARK) {\n    throw new Error('TextureStore: markTile called out of sequence');\n  }\n\n  // Enter the MARK state, if not already there.\n  this._state = State.MARK;\n\n  // Refresh texture for dynamic assets.\n  var item = this._itemMap.get(tile);\n  var texture = item && item.texture();\n  var asset = item && item.asset();\n  if (texture && asset) {\n    texture.refresh(tile, asset);\n  }\n\n  // Add tile to the visible set.\n  this._newVisible.add(tile);\n};\n\n\n/**\n * Signal the end of a frame. Called from {@link Stage}.\n */\nTextureStore.prototype.endFrame = function() {\n  // Check that we are in an appropriate state.\n  if (this._state !== State.START && this._state !== State.MARK && this._state !== State.END) {\n    throw new Error('TextureStore: endFrame called out of sequence');\n  }\n\n  // Enter the END state, if not already there.\n  this._state = State.END;\n\n  // Expect one less call to endFrame.\n  this._delimCount--;\n\n  // If no further calls are expected, process frame and enter the IDLE state.\n  if (!this._delimCount) {\n    this._update();\n    this._state = State.IDLE;\n  }\n};\n\n\nTextureStore.prototype._update = function() {\n  var self = this;\n\n  // Calculate the set of tiles that used to be visible but no longer are.\n  self._noLongerVisible.length = 0;\n  self._visible.forEach(function(tile) {\n    if (!self._newVisible.has(tile)) {\n      self._noLongerVisible.push(tile);\n    }\n  });\n\n  // Calculate the set of tiles that were visible recently and have become\n  // visible again.\n  self._visibleAgain.length = 0;\n  self._newVisible.forEach(function(tile) {\n    if (self._previouslyVisible.has(tile)) {\n      self._visibleAgain.push(tile);\n    }\n  });\n\n  // Remove tiles that have become visible again from the list of previously\n  // visible tiles.\n  self._visibleAgain.forEach(function(tile) {\n    self._previouslyVisible.remove(tile);\n  });\n\n  // Cancel loading of tiles that are no longer visible.\n  // Move no longer visible tiles with a loaded texture into the previously\n  // visible set, and collect the tiles evicted from the latter.\n  self._evicted.length = 0;\n  self._noLongerVisible.forEach(function(tile) {\n    var item = self._itemMap.get(tile);\n    var texture = item && item.texture();\n    if (texture) {\n      var otherTile = self._previouslyVisible.add(tile);\n      if (otherTile != null) {\n        self._evicted.push(otherTile);\n      }\n    } else if (item) {\n      self._unloadTile(tile);\n    }\n  });\n\n  // Unload evicted tiles, unless they are pinned.\n  self._evicted.forEach(function(tile) {\n    if (!self._pinMap.has(tile)) {\n      self._unloadTile(tile);\n    }\n  });\n\n  // Load visible tiles that are not already in the store.\n  // Refresh texture on visible tiles for dynamic assets.\n  self._newVisible.forEach(function(tile) {\n    var item = self._itemMap.get(tile);\n    if (!item) {\n      self._loadTile(tile);\n    }\n  });\n\n  // Swap the old visible set with the new one.\n  var tmp = self._visible;\n  self._visible = self._newVisible;\n  self._newVisible = tmp;\n\n  // Clear the new visible set.\n  self._newVisible.clear();\n\n  // Clear temporary variables.\n  self._noLongerVisible.length = 0;\n  self._visibleAgain.length = 0;\n  self._evicted.length = 0;\n};\n\n\nTextureStore.prototype._loadTile = function(tile) {\n  if (this._itemMap.has(tile)) {\n    throw new Error('TextureStore: loading texture already in cache');\n  }\n  var item = new TextureStoreItem(this, tile);\n  this._itemMap.set(tile, item);\n};\n\n\nTextureStore.prototype._unloadTile = function(tile) {\n  var item = this._itemMap.del(tile);\n  if (!item) {\n    throw new Error('TextureStore: unloading texture not in cache');\n  }\n  item.destroy();\n};\n\n\nTextureStore.prototype.asset = function(tile) {\n  var item = this._itemMap.get(tile);\n  if (item) {\n    return item.asset();\n  }\n  return null;\n};\n\n\nTextureStore.prototype.texture = function(tile) {\n  var item = this._itemMap.get(tile);\n  if (item) {\n    return item.texture();\n  }\n  return null;\n};\n\n\n/**\n * Pin a tile. Textures for pinned tiles are never evicted from the store.\n * Upon pinning, the texture is created if not already present. Pins are\n * reference-counted; a tile may be pinned multiple times and must be unpinned\n * the corresponding number of times. Pinning is useful e.g. to ensure that\n * the lowest-resolution level of an image is always available to fall back\n * onto.\n * @param {Tile} tile the tile to pin\n * @returns {number} the pin reference count.\n */\nTextureStore.prototype.pin = function(tile) {\n  // Increment reference count.\n  var count = (this._pinMap.get(tile) || 0) + 1;\n  this._pinMap.set(tile, count);\n  // If the texture for the tile is not present, load it now.\n  if (!this._itemMap.has(tile)) {\n    this._loadTile(tile);\n  }\n  return count;\n};\n\n\n/**\n * Unpin a tile. Pins are reference-counted; a tile may be pinned multiple\n * times and must be unpinned the corresponding number of times.\n * @param {Tile} tile the tile to unpin\n * @returns {number} the pin reference count.\n */\nTextureStore.prototype.unpin = function(tile) {\n  var count = this._pinMap.get(tile);\n  // Consistency check.\n  if (!count) {\n    throw new Error('TextureStore: unpin when not pinned');\n  } else {\n    // Decrement reference count.\n    count--;\n    if (count > 0) {\n      this._pinMap.set(tile, count);\n    } else {\n      this._pinMap.del(tile);\n      // If the tile does not belong to either the visible or previously\n      // visible sets, evict it from the cache.\n      if (!this._visible.has(tile) && !this._previouslyVisible.has(tile)) {\n        this._unloadTile(tile);\n      }\n    }\n  }\n  return count;\n};\n\n\n/**\n * Return type for {@link TextureStore#query}.\n * @typedef {Object} TileState\n * @property {boolean} visible Whether the tile is in the visible set.\n * @property {boolean} previouslyVisible Whether the tile is in the previously\n *     visible set.\n * @property {boolean} hasAsset Whether the asset for the tile is present.\n * @property {boolean} hasTexture Whether the texture for the tile is present.\n * @property {boolean} pinned Whether the tile is in the pinned set.\n * @property {number} pinCount The pin reference count for the tile.\n */\n\n\n/**\n * Return the state of a tile.\n * @param {Tile} tile The tile to query.\n * @return {TileState}\n */\nTextureStore.prototype.query = function(tile) {\n  var item = this._itemMap.get(tile);\n  var pinCount = this._pinMap.get(tile) || 0;\n  return {\n    visible: this._visible.has(tile),\n    previouslyVisible: this._previouslyVisible.has(tile),\n    hasAsset: item != null && item.asset() != null,\n    hasTexture: item != null && item.texture() != null,\n    pinned: pinCount !== 0,\n    pinCount: pinCount\n  };\n};\n\n\nmodule.exports = TextureStore;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction extend(obj, sourceObj) {\n  for (var key in sourceObj) {\n    obj[key] = sourceObj[key];\n  }\n  return obj;\n}\n\nmodule.exports = extend;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n\nvar eventEmitter = require('minimal-event-emitter');\nvar extend = require('./util/extend');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the layer has been rendered.\n *\n * @param {boolean} stable Whether all tiles were successfully rendered without\n *     missing textures or resorting to fallbacks.\n * @event Layer#renderComplete\n */\n\n/**\n * @class Layer\n * @classdesc\n *\n * A Layer is a combination of {@link Source}, {@link Geometry}, {@link View}\n * and {@link TextureStore} that may be added into a {@link Stage} and rendered\n * with {@link Effects}.\n *\n * @param {Source} source\n * @param {Geometry} geometry\n * @param {View} view\n * @param {TextureStore} textureStore\n * @param {Object} opts\n * @param {Effects} opts.effects\n*/\nfunction Layer(source, geometry, view, textureStore, opts) {\n  opts = opts || {};\n\n  var self = this;\n\n  this._source = source;\n  this._geometry = geometry;\n  this._view = view;\n  this._textureStore = textureStore;\n\n  this._effects = opts.effects || {};\n\n  this._fixedLevelIndex = null;\n\n  this._viewChangeHandler = function() {\n    self.emit('viewChange', self.view());\n  };\n\n  this._view.addEventListener('change', this._viewChangeHandler);\n\n  this._textureStoreChangeHandler = function() {\n    self.emit('textureStoreChange', self.textureStore());\n  };\n\n  this._textureStore.addEventListener('textureLoad',\n    this._textureStoreChangeHandler);\n  this._textureStore.addEventListener('textureError',\n    this._textureStoreChangeHandler);\n  this._textureStore.addEventListener('textureInvalid',\n    this._textureStoreChangeHandler);\n}\n\neventEmitter(Layer);\n\n\n/**\n * Destructor.\n */\nLayer.prototype.destroy = function() {\n  this._view.removeEventListener('change', this._viewChangeHandler);\n  this._textureStore.removeEventListener('textureLoad',\n    this._textureStoreChangeHandler);\n  this._textureStore.removeEventListener('textureError',\n    this._textureStoreChangeHandler);\n  this._textureStore.removeEventListener('textureInvalid',\n    this._textureStoreChangeHandler);\n  clearOwnProperties(this);\n};\n\n\n/**\n * Returns the underlying {@link Source source}.\n * @return {Source}\n */\nLayer.prototype.source = function() {\n  return this._source;\n};\n\n\n/**\n * Returns the underlying {@link Geometry geometry}.\n * @return {Geometry}\n */\nLayer.prototype.geometry = function() {\n  return this._geometry;\n};\n\n\n/**\n * Returns the underlying {@link View view}.\n * @return {View}\n */\nLayer.prototype.view = function() {\n  return this._view;\n};\n\n\n/**\n * Returns the underlying {@link TextureStore texture store}.\n * @return {TextureStore}\n */\nLayer.prototype.textureStore = function() {\n  return this._textureStore;\n};\n\n\n/**\n * Returns the currently set {@link Effects effects}.\n * @return {Effects}\n */\nLayer.prototype.effects = function() {\n  return this._effects;\n};\n\n\n/**\n * Sets the {@link Effects effects}.\n * @param {Effects} effects\n */\nLayer.prototype.setEffects = function(effects) {\n  this._effects = effects;\n  this.emit('effectsChange', this._effects);\n};\n\n\n/**\n * Merges effects into the currently set ones. The merge is non-recursive; for\n * instance, if current effects are `{ rect: { relativeWidth: 0.5 } }`,\n * calling this method with `{ rect: { relativeX: 0.5 }}` will reset\n * `rect.relativeWidth`.\n *\n * @param {Effects} effects\n */\nLayer.prototype.mergeEffects = function(effects) {\n  extend(this._effects, effects);\n  this.emit('effectsChange', this._effects);\n};\n\n\n/**\n * Returns the fixed level index.\n * @return {(number|null)}\n */\nLayer.prototype.fixedLevel = function() {\n  return this._fixedLevelIndex;\n};\n\n\n/**\n * Sets the fixed level index. When set, the corresponding level will be\n * used regardless of the view parameters. Unset with a null argument.\n *\n * @param {(number|null)} levelIndex\n * @throws An error if the level index is out of range.\n */\nLayer.prototype.setFixedLevel = function(levelIndex) {\n  if (levelIndex !== this._fixedLevelIndex) {\n    if (levelIndex != null && (levelIndex >= this._geometry.levelList.length ||\n        levelIndex < 0)) {\n      throw new Error(\"Level index out of range: \" + levelIndex);\n    }\n    this._fixedLevelIndex = levelIndex;\n    this.emit('fixedLevelChange', this._fixedLevelIndex);\n  }\n};\n\n\nLayer.prototype._selectLevel = function() {\n  var level;\n  if (this._fixedLevelIndex != null) {\n    level = this._geometry.levelList[this._fixedLevelIndex];\n  } else {\n    level = this._view.selectLevel(this._geometry.selectableLevelList);\n  }\n  return level;\n};\n\n\nLayer.prototype.visibleTiles = function(result) {\n  var level = this._selectLevel();\n  return this._geometry.visibleTiles(this._view, level, result);\n};\n\n\n/**\n * Pin a whole level into the texture store.\n * @param {Number} levelIndex\n */\nLayer.prototype.pinLevel = function(levelIndex) {\n  var level = this._geometry.levelList[levelIndex];\n  var tiles = this._geometry.levelTiles(level);\n  for (var i = 0; i < tiles.length; i++) {\n    this._textureStore.pin(tiles[i]);\n  }\n};\n\n\n/**\n * Unpin a whole level from the texture store.\n * @param {Number} levelIndex\n */\nLayer.prototype.unpinLevel = function(levelIndex) {\n  var level = this._geometry.levelList[levelIndex];\n  var tiles = this._geometry.levelTiles(level);\n  for (var i = 0; i < tiles.length; i++) {\n    this._textureStore.unpin(tiles[i]);\n  }\n};\n\n\n/**\n * Pin the first level. Equivalent to `pinLevel(0)`.\n */\nLayer.prototype.pinFirstLevel = function() {\n  return this.pinLevel(0);\n};\n\n\n/**\n * Unpin the first level. Equivalent to `unpinLevel(0)`.\n */\nLayer.prototype.unpinFirstLevel = function() {\n  return this.unpinLevel(0);\n};\n\n\nmodule.exports = Layer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that {@link Stage#render} is about to be called.\n * @event RenderLoop#beforeRender\n */\n\n/**\n * Signals that {@link Stage#render} has just been called.\n * @event RenderLoop#afterRender\n */\n\n/**\n * @class RenderLoop\n * @classdesc\n *\n * A RenderLoop wraps a {@link Stage} and calls {@link Stage#render} on the next\n * frame whenever it fires {@link Stage#renderInvalid}. It may be started and\n * stopped, and is initially in the stopped state, in which no call to\n * {@link Stage#render} occurs.\n *\n * @listens Stage#renderInvalid\n *\n * @param {Stage} stage\n */\nfunction RenderLoop(stage) {\n\n  var self = this;\n\n  // The stage wrapped by the loop.\n  this._stage = stage;\n\n  // Whether the loop is running.\n  this._running = false;\n\n  // Whether the loop is currently rendering.\n  this._rendering = false;\n\n  // The current requestAnimationFrame handle.\n  this._requestHandle = null;\n\n  // The callback passed into requestAnimationFrame.\n  this._boundLoop = this._loop.bind(this);\n\n  // Handler for renderInvalid events emitted by the stage.\n  this._renderInvalidHandler = function() {\n    // If we are already rendering, there's no need to schedule a new render\n    // on the next frame.\n    if (!self._rendering) {\n      self.renderOnNextFrame();\n    }\n  };\n\n  // Handle renderInvalid events emitted by the stage.\n  this._stage.addEventListener('renderInvalid', this._renderInvalidHandler);\n\n}\n\neventEmitter(RenderLoop);\n\n\n/**\n * Destructor.\n */\nRenderLoop.prototype.destroy = function() {\n  this.stop();\n  this._stage.removeEventListener('renderInvalid', this._renderInvalidHandler);\n  clearOwnProperties(this);\n};\n\n\n/**\n * Returns the underlying stage.\n * @return {Stage}\n */\nRenderLoop.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Starts the render loop.\n */\nRenderLoop.prototype.start = function() {\n  this._running = true;\n  this.renderOnNextFrame();\n};\n\n\n/**\n * Stops the render loop.\n */\nRenderLoop.prototype.stop = function() {\n  if (this._requestHandle) {\n    window.cancelAnimationFrame(this._requestHandle);\n    this._requestHandle = null;\n  }\n  this._running = false;\n};\n\n\n/**\n * Forces the stage to render on the next frame, even if its contents remain\n * valid. Does nothing if the loop is stopped.\n */\nRenderLoop.prototype.renderOnNextFrame = function() {\n  if (this._running && !this._requestHandle) {\n    this._requestHandle = window.requestAnimationFrame(this._boundLoop);\n  }\n};\n\n\nRenderLoop.prototype._loop = function() {\n  if (!this._running) {\n    throw new Error('Render loop running while in stopped state');\n  }\n  this._requestHandle = null;\n  this._rendering = true;\n  this.emit('beforeRender');\n  this._rendering = false;\n  this._stage.render();\n  this.emit('afterRender');\n};\n\n\nmodule.exports = RenderLoop;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @class Dynamics\n * @classdesc\n *\n * Represents how a control parameter changes. Used in the events emitted by\n * {@link ControlMethod}.\n *\n * @property {number} offset Parameter changed by a fixed value\n * @property {number} velocity Parameter is changing at this velocity\n * @property {number} friction The velocity will decrease at this rate\n */\nfunction Dynamics() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n}\n\nDynamics.equals = function(d1, d2) {\n  return d1.velocity === d2.velocity && d1.friction === d2.friction && d1.offset === d2.offset;\n};\n\nDynamics.prototype.equals = function(other) {\n  return Dynamics.equals(this, other);\n};\n\nDynamics.prototype.update = function(other, elapsed) {\n  if (other.offset) {\n    // If other has an offset, make this.offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += other.offset;\n  }\n\n  var offsetFromVelocity = this.offsetFromVelocity(elapsed);\n  if (offsetFromVelocity) {\n    // If there is an offset to add from the velocity, make this offset a number instead of null\n    this.offset = this.offset || 0;\n    this.offset += offsetFromVelocity;\n  }\n\n  this.velocity = other.velocity;\n  this.friction = other.friction;\n};\n\nDynamics.prototype.reset = function() {\n  this.velocity = null;\n  this.friction = null;\n  this.offset = null;\n};\n\n\nDynamics.prototype.velocityAfter = function(elapsed) {\n  if (!this.velocity) {\n    return null;\n  }\n  if (this.friction) {\n    return decreaseAbs(this.velocity, this.friction *elapsed);\n  }\n  return this.velocity;\n};\n\nDynamics.prototype.offsetFromVelocity = function(elapsed) {\n  elapsed = Math.min(elapsed, this.nullVelocityTime());\n\n  var velocityEnd = this.velocityAfter(elapsed);\n  var averageVelocity = (this.velocity + velocityEnd) / 2;\n\n  return averageVelocity * elapsed;\n};\n\n\nDynamics.prototype.nullVelocityTime = function() {\n  if (this.velocity == null) {\n    return 0;\n  }\n  if (this.velocity && !this.friction) {\n    return Infinity;\n  }\n  return Math.abs(this.velocity / this.friction);\n};\n\nfunction decreaseAbs(num, dec) {\n  if (num < 0) {\n    return Math.min(0, num + dec);\n  }\n  if (num > 0) {\n    return Math.max(0, num - dec);\n  }\n  return 0;\n}\n\nmodule.exports = Dynamics;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class KeyControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter by pressing and\n * unpressing a key.\n *\n * @param {number} keyCode Key which activates the method when pressed\n * @param {string} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n * @param {number} velocity Velocity at which the parameter changes. Use a\n * negative number for opposite direction\n * @param {number} friction Friction at which the parameter stops\n * @param {Element} [element=document] DOM element where the key events are listened to\n */\nfunction KeyControlMethod(keyCode, parameter, velocity, friction, element) {\n  if(!keyCode) {\n    throw new Error(\"KeyControlMethod: keyCode must be defined\");\n  }\n  if(!parameter) {\n    throw new Error(\"KeyControlMethod: parameter must be defined\");\n  }\n  if(!velocity) {\n    throw new Error(\"KeyControlMethod: velocity must be defined\");\n  }\n  if(!friction) {\n    throw new Error(\"KeyControlMethod: friction must be defined\");\n  }\n\n  element = element || document;\n\n  this._keyCode = keyCode;\n  this._parameter = parameter;\n  this._velocity = velocity;\n  this._friction = friction;\n  this._element = element;\n\n  this._keydownHandler = this._handlePress.bind(this);\n  this._keyupHandler = this._handleRelease.bind(this);\n  this._blurHandler = this._handleBlur.bind(this);\n\n  this._element.addEventListener('keydown', this._keydownHandler);\n  this._element.addEventListener('keyup', this._keyupHandler);\n  window.addEventListener('blur', this._blurHandler);\n\n  this._dynamics = new Dynamics();\n  this._pressing = false;\n}\neventEmitter(KeyControlMethod);\n\n/**\n * Destructor.\n */\nKeyControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener('keydown', this._keydownHandler);\n  this._element.removeEventListener('keyup', this._keyupHandler);\n  window.removeEventListener('blur', this._blurHandler);\n  clearOwnProperties(this);\n};\n\nKeyControlMethod.prototype._handlePress = function(e) {\n  if(e.keyCode !== this._keyCode) { return; }\n\n  this._pressing = true;\n\n  this._dynamics.velocity = this._velocity;\n  this._dynamics.friction = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('active');\n};\n\nKeyControlMethod.prototype._handleRelease = function(e) {\n  if(e.keyCode !== this._keyCode) { return; }\n\n  if(this._pressing) {\n    this._dynamics.friction = this._friction;\n    this.emit('parameterDynamics', this._parameter, this._dynamics);\n    this.emit('inactive');\n  }\n\n  this._pressing = false;\n};\n\nKeyControlMethod.prototype._handleBlur = function() {\n  this._dynamics.velocity = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('inactive');\n\n  this._pressing = false;\n};\n\nmodule.exports = KeyControlMethod;\n","/*! Hammer.JS - v2.0.4 - 2014-09-28\r\n * http://hammerjs.github.io/\r\n *\r\n * Copyright (c) 2014 Jorik Tangelder;\r\n * Licensed under the MIT license */\r\n(function(window, document, exportName, undefined) {\r\n  'use strict';\r\n\r\nvar VENDOR_PREFIXES = ['', 'webkit', 'moz', 'MS', 'ms', 'o'];\r\nvar TEST_ELEMENT = document.createElement('div');\r\n\r\nvar TYPE_FUNCTION = 'function';\r\n\r\nvar round = Math.round;\r\nvar abs = Math.abs;\r\nvar now = Date.now;\r\n\r\n/**\r\n * set a timeout with a given scope\r\n * @param {Function} fn\r\n * @param {Number} timeout\r\n * @param {Object} context\r\n * @returns {number}\r\n */\r\nfunction setTimeoutContext(fn, timeout, context) {\r\n    return setTimeout(bindFn(fn, context), timeout);\r\n}\r\n\r\n/**\r\n * if the argument is an array, we want to execute the fn on each entry\r\n * if it aint an array we don't want to do a thing.\r\n * this is used by all the methods that accept a single and array argument.\r\n * @param {*|Array} arg\r\n * @param {String} fn\r\n * @param {Object} [context]\r\n * @returns {Boolean}\r\n */\r\nfunction invokeArrayArg(arg, fn, context) {\r\n    if (Array.isArray(arg)) {\r\n        each(arg, context[fn], context);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * walk objects and arrays\r\n * @param {Object} obj\r\n * @param {Function} iterator\r\n * @param {Object} context\r\n */\r\nfunction each(obj, iterator, context) {\r\n    var i;\r\n\r\n    if (!obj) {\r\n        return;\r\n    }\r\n\r\n    if (obj.forEach) {\r\n        obj.forEach(iterator, context);\r\n    } else if (obj.length !== undefined) {\r\n        i = 0;\r\n        while (i < obj.length) {\r\n            iterator.call(context, obj[i], i, obj);\r\n            i++;\r\n        }\r\n    } else {\r\n        for (i in obj) {\r\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * extend object.\r\n * means that properties in dest will be overwritten by the ones in src.\r\n * @param {Object} dest\r\n * @param {Object} src\r\n * @param {Boolean} [merge]\r\n * @returns {Object} dest\r\n */\r\nfunction extend(dest, src, merge) {\r\n    var keys = Object.keys(src);\r\n    var i = 0;\r\n    while (i < keys.length) {\r\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\r\n            dest[keys[i]] = src[keys[i]];\r\n        }\r\n        i++;\r\n    }\r\n    return dest;\r\n}\r\n\r\n/**\r\n * merge the values from src in the dest.\r\n * means that properties that exist in dest will not be overwritten by src\r\n * @param {Object} dest\r\n * @param {Object} src\r\n * @returns {Object} dest\r\n */\r\nfunction merge(dest, src) {\r\n    return extend(dest, src, true);\r\n}\r\n\r\n/**\r\n * simple class inheritance\r\n * @param {Function} child\r\n * @param {Function} base\r\n * @param {Object} [properties]\r\n */\r\nfunction inherit(child, base, properties) {\r\n    var baseP = base.prototype,\r\n        childP;\r\n\r\n    childP = child.prototype = Object.create(baseP);\r\n    childP.constructor = child;\r\n    childP._super = baseP;\r\n\r\n    if (properties) {\r\n        extend(childP, properties);\r\n    }\r\n}\r\n\r\n/**\r\n * simple function bind\r\n * @param {Function} fn\r\n * @param {Object} context\r\n * @returns {Function}\r\n */\r\nfunction bindFn(fn, context) {\r\n    return function boundFn() {\r\n        return fn.apply(context, arguments);\r\n    };\r\n}\r\n\r\n/**\r\n * let a boolean value also be a function that must return a boolean\r\n * this first item in args will be used as the context\r\n * @param {Boolean|Function} val\r\n * @param {Array} [args]\r\n * @returns {Boolean}\r\n */\r\nfunction boolOrFn(val, args) {\r\n    if (typeof val == TYPE_FUNCTION) {\r\n        return val.apply(args ? args[0] || undefined : undefined, args);\r\n    }\r\n    return val;\r\n}\r\n\r\n/**\r\n * use the val2 when val1 is undefined\r\n * @param {*} val1\r\n * @param {*} val2\r\n * @returns {*}\r\n */\r\nfunction ifUndefined(val1, val2) {\r\n    return (val1 === undefined) ? val2 : val1;\r\n}\r\n\r\n/**\r\n * addEventListener with multiple events at once\r\n * @param {EventTarget} target\r\n * @param {String} types\r\n * @param {Function} handler\r\n */\r\nfunction addEventListeners(target, types, handler) {\r\n    each(splitStr(types), function(type) {\r\n        target.addEventListener(type, handler, false);\r\n    });\r\n}\r\n\r\n/**\r\n * removeEventListener with multiple events at once\r\n * @param {EventTarget} target\r\n * @param {String} types\r\n * @param {Function} handler\r\n */\r\nfunction removeEventListeners(target, types, handler) {\r\n    each(splitStr(types), function(type) {\r\n        target.removeEventListener(type, handler, false);\r\n    });\r\n}\r\n\r\n/**\r\n * find if a node is in the given parent\r\n * @method hasParent\r\n * @param {HTMLElement} node\r\n * @param {HTMLElement} parent\r\n * @return {Boolean} found\r\n */\r\nfunction hasParent(node, parent) {\r\n    while (node) {\r\n        if (node == parent) {\r\n            return true;\r\n        }\r\n        node = node.parentNode;\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * small indexOf wrapper\r\n * @param {String} str\r\n * @param {String} find\r\n * @returns {Boolean} found\r\n */\r\nfunction inStr(str, find) {\r\n    return str.indexOf(find) > -1;\r\n}\r\n\r\n/**\r\n * split string on whitespace\r\n * @param {String} str\r\n * @returns {Array} words\r\n */\r\nfunction splitStr(str) {\r\n    return str.trim().split(/\\s+/g);\r\n}\r\n\r\n/**\r\n * find if a array contains the object using indexOf or a simple polyFill\r\n * @param {Array} src\r\n * @param {String} find\r\n * @param {String} [findByKey]\r\n * @return {Boolean|Number} false when not found, or the index\r\n */\r\nfunction inArray(src, find, findByKey) {\r\n    if (src.indexOf && !findByKey) {\r\n        return src.indexOf(find);\r\n    } else {\r\n        var i = 0;\r\n        while (i < src.length) {\r\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\r\n                return i;\r\n            }\r\n            i++;\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n\r\n/**\r\n * convert array-like objects to real arrays\r\n * @param {Object} obj\r\n * @returns {Array}\r\n */\r\nfunction toArray(obj) {\r\n    return Array.prototype.slice.call(obj, 0);\r\n}\r\n\r\n/**\r\n * unique array with objects based on a key (like 'id') or just by the array's value\r\n * @param {Array} src [{id:1},{id:2},{id:1}]\r\n * @param {String} [key]\r\n * @param {Boolean} [sort=False]\r\n * @returns {Array} [{id:1},{id:2}]\r\n */\r\nfunction uniqueArray(src, key, sort) {\r\n    var results = [];\r\n    var values = [];\r\n    var i = 0;\r\n\r\n    while (i < src.length) {\r\n        var val = key ? src[i][key] : src[i];\r\n        if (inArray(values, val) < 0) {\r\n            results.push(src[i]);\r\n        }\r\n        values[i] = val;\r\n        i++;\r\n    }\r\n\r\n    if (sort) {\r\n        if (!key) {\r\n            results = results.sort();\r\n        } else {\r\n            results = results.sort(function sortUniqueArray(a, b) {\r\n                return a[key] > b[key];\r\n            });\r\n        }\r\n    }\r\n\r\n    return results;\r\n}\r\n\r\n/**\r\n * get the prefixed property\r\n * @param {Object} obj\r\n * @param {String} property\r\n * @returns {String|Undefined} prefixed\r\n */\r\nfunction prefixed(obj, property) {\r\n    var prefix, prop;\r\n    var camelProp = property[0].toUpperCase() + property.slice(1);\r\n\r\n    var i = 0;\r\n    while (i < VENDOR_PREFIXES.length) {\r\n        prefix = VENDOR_PREFIXES[i];\r\n        prop = (prefix) ? prefix + camelProp : property;\r\n\r\n        if (prop in obj) {\r\n            return prop;\r\n        }\r\n        i++;\r\n    }\r\n    return undefined;\r\n}\r\n\r\n/**\r\n * get a unique id\r\n * @returns {number} uniqueId\r\n */\r\nvar _uniqueId = 1;\r\nfunction uniqueId() {\r\n    return _uniqueId++;\r\n}\r\n\r\n/**\r\n * get the window object of an element\r\n * @param {HTMLElement} element\r\n * @returns {DocumentView|Window}\r\n */\r\nfunction getWindowForElement(element) {\r\n    var doc = element.ownerDocument;\r\n    return (doc.defaultView || doc.parentWindow);\r\n}\r\n\r\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\r\n\r\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\r\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\r\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\r\n\r\nvar INPUT_TYPE_TOUCH = 'touch';\r\nvar INPUT_TYPE_PEN = 'pen';\r\nvar INPUT_TYPE_MOUSE = 'mouse';\r\nvar INPUT_TYPE_KINECT = 'kinect';\r\n\r\nvar COMPUTE_INTERVAL = 25;\r\n\r\nvar INPUT_START = 1;\r\nvar INPUT_MOVE = 2;\r\nvar INPUT_END = 4;\r\nvar INPUT_CANCEL = 8;\r\n\r\nvar DIRECTION_NONE = 1;\r\nvar DIRECTION_LEFT = 2;\r\nvar DIRECTION_RIGHT = 4;\r\nvar DIRECTION_UP = 8;\r\nvar DIRECTION_DOWN = 16;\r\n\r\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\r\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\r\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\r\n\r\nvar PROPS_XY = ['x', 'y'];\r\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\r\n\r\n/**\r\n * create new input type manager\r\n * @param {Manager} manager\r\n * @param {Function} callback\r\n * @returns {Input}\r\n * @constructor\r\n */\r\nfunction Input(manager, callback) {\r\n    var self = this;\r\n    this.manager = manager;\r\n    this.callback = callback;\r\n    this.element = manager.element;\r\n    this.target = manager.options.inputTarget;\r\n\r\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\r\n    // so when disabled the input events are completely bypassed.\r\n    this.domHandler = function(ev) {\r\n        if (boolOrFn(manager.options.enable, [manager])) {\r\n            self.handler(ev);\r\n        }\r\n    };\r\n\r\n    this.init();\r\n\r\n}\r\n\r\nInput.prototype = {\r\n    /**\r\n     * should handle the inputEvent data and trigger the callback\r\n     * @virtual\r\n     */\r\n    handler: function() { },\r\n\r\n    /**\r\n     * bind the events\r\n     */\r\n    init: function() {\r\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\r\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\r\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\r\n    },\r\n\r\n    /**\r\n     * unbind the events\r\n     */\r\n    destroy: function() {\r\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\r\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\r\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\r\n    }\r\n};\r\n\r\n/**\r\n * create new input type manager\r\n * called by the Manager constructor\r\n * @param {Hammer} manager\r\n * @returns {Input}\r\n */\r\nfunction createInputInstance(manager) {\r\n    var Type;\r\n    var inputClass = manager.options.inputClass;\r\n\r\n    if (inputClass) {\r\n        Type = inputClass;\r\n    } else if (SUPPORT_POINTER_EVENTS) {\r\n        Type = PointerEventInput;\r\n    } else if (SUPPORT_ONLY_TOUCH) {\r\n        Type = TouchInput;\r\n    } else if (!SUPPORT_TOUCH) {\r\n        Type = MouseInput;\r\n    } else {\r\n        Type = TouchMouseInput;\r\n    }\r\n    return new (Type)(manager, inputHandler);\r\n}\r\n\r\n/**\r\n * handle input events\r\n * @param {Manager} manager\r\n * @param {String} eventType\r\n * @param {Object} input\r\n */\r\nfunction inputHandler(manager, eventType, input) {\r\n    var pointersLen = input.pointers.length;\r\n    var changedPointersLen = input.changedPointers.length;\r\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\r\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\r\n\r\n    input.isFirst = !!isFirst;\r\n    input.isFinal = !!isFinal;\r\n\r\n    if (isFirst) {\r\n        manager.session = {};\r\n    }\r\n\r\n    // source event is the normalized value of the domEvents\r\n    // like 'touchstart, mouseup, pointerdown'\r\n    input.eventType = eventType;\r\n\r\n    // compute scale, rotation etc\r\n    computeInputData(manager, input);\r\n\r\n    // emit secret event\r\n    manager.emit('hammer.input', input);\r\n\r\n    manager.recognize(input);\r\n    manager.session.prevInput = input;\r\n}\r\n\r\n/**\r\n * extend the data with some usable properties like scale, rotate, velocity etc\r\n * @param {Object} manager\r\n * @param {Object} input\r\n */\r\nfunction computeInputData(manager, input) {\r\n    var session = manager.session;\r\n    var pointers = input.pointers;\r\n    var pointersLength = pointers.length;\r\n\r\n    // store the first input to calculate the distance and direction\r\n    if (!session.firstInput) {\r\n        session.firstInput = simpleCloneInputData(input);\r\n    }\r\n\r\n    // to compute scale and rotation we need to store the multiple touches\r\n    if (pointersLength > 1 && !session.firstMultiple) {\r\n        session.firstMultiple = simpleCloneInputData(input);\r\n    } else if (pointersLength === 1) {\r\n        session.firstMultiple = false;\r\n    }\r\n\r\n    var firstInput = session.firstInput;\r\n    var firstMultiple = session.firstMultiple;\r\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\r\n\r\n    var center = input.center = getCenter(pointers);\r\n    input.timeStamp = now();\r\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\r\n\r\n    input.angle = getAngle(offsetCenter, center);\r\n    input.distance = getDistance(offsetCenter, center);\r\n\r\n    computeDeltaXY(session, input);\r\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\r\n\r\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\r\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\r\n\r\n    computeIntervalInputData(session, input);\r\n\r\n    // find the correct target\r\n    var target = manager.element;\r\n    if (hasParent(input.srcEvent.target, target)) {\r\n        target = input.srcEvent.target;\r\n    }\r\n    input.target = target;\r\n}\r\n\r\nfunction computeDeltaXY(session, input) {\r\n    var center = input.center;\r\n    var offset = session.offsetDelta || {};\r\n    var prevDelta = session.prevDelta || {};\r\n    var prevInput = session.prevInput || {};\r\n\r\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\r\n        prevDelta = session.prevDelta = {\r\n            x: prevInput.deltaX || 0,\r\n            y: prevInput.deltaY || 0\r\n        };\r\n\r\n        offset = session.offsetDelta = {\r\n            x: center.x,\r\n            y: center.y\r\n        };\r\n    }\r\n\r\n    input.deltaX = prevDelta.x + (center.x - offset.x);\r\n    input.deltaY = prevDelta.y + (center.y - offset.y);\r\n}\r\n\r\n/**\r\n * velocity is calculated every x ms\r\n * @param {Object} session\r\n * @param {Object} input\r\n */\r\nfunction computeIntervalInputData(session, input) {\r\n    var last = session.lastInterval || input,\r\n        deltaTime = input.timeStamp - last.timeStamp,\r\n        velocity, velocityX, velocityY, direction;\r\n\r\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\r\n        var deltaX = last.deltaX - input.deltaX;\r\n        var deltaY = last.deltaY - input.deltaY;\r\n\r\n        var v = getVelocity(deltaTime, deltaX, deltaY);\r\n        velocityX = v.x;\r\n        velocityY = v.y;\r\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\r\n        direction = getDirection(deltaX, deltaY);\r\n\r\n        session.lastInterval = input;\r\n    } else {\r\n        // use latest velocity info if it doesn't overtake a minimum period\r\n        velocity = last.velocity;\r\n        velocityX = last.velocityX;\r\n        velocityY = last.velocityY;\r\n        direction = last.direction;\r\n    }\r\n\r\n    input.velocity = velocity;\r\n    input.velocityX = velocityX;\r\n    input.velocityY = velocityY;\r\n    input.direction = direction;\r\n}\r\n\r\n/**\r\n * create a simple clone from the input used for storage of firstInput and firstMultiple\r\n * @param {Object} input\r\n * @returns {Object} clonedInputData\r\n */\r\nfunction simpleCloneInputData(input) {\r\n    // make a simple copy of the pointers because we will get a reference if we don't\r\n    // we only need clientXY for the calculations\r\n    var pointers = [];\r\n    var i = 0;\r\n    while (i < input.pointers.length) {\r\n        pointers[i] = {\r\n            clientX: round(input.pointers[i].clientX),\r\n            clientY: round(input.pointers[i].clientY)\r\n        };\r\n        i++;\r\n    }\r\n\r\n    return {\r\n        timeStamp: now(),\r\n        pointers: pointers,\r\n        center: getCenter(pointers),\r\n        deltaX: input.deltaX,\r\n        deltaY: input.deltaY\r\n    };\r\n}\r\n\r\n/**\r\n * get the center of all the pointers\r\n * @param {Array} pointers\r\n * @return {Object} center contains `x` and `y` properties\r\n */\r\nfunction getCenter(pointers) {\r\n    var pointersLength = pointers.length;\r\n\r\n    // no need to loop when only one touch\r\n    if (pointersLength === 1) {\r\n        return {\r\n            x: round(pointers[0].clientX),\r\n            y: round(pointers[0].clientY)\r\n        };\r\n    }\r\n\r\n    var x = 0, y = 0, i = 0;\r\n    while (i < pointersLength) {\r\n        x += pointers[i].clientX;\r\n        y += pointers[i].clientY;\r\n        i++;\r\n    }\r\n\r\n    return {\r\n        x: round(x / pointersLength),\r\n        y: round(y / pointersLength)\r\n    };\r\n}\r\n\r\n/**\r\n * calculate the velocity between two points. unit is in px per ms.\r\n * @param {Number} deltaTime\r\n * @param {Number} x\r\n * @param {Number} y\r\n * @return {Object} velocity `x` and `y`\r\n */\r\nfunction getVelocity(deltaTime, x, y) {\r\n    return {\r\n        x: x / deltaTime || 0,\r\n        y: y / deltaTime || 0\r\n    };\r\n}\r\n\r\n/**\r\n * get the direction between two points\r\n * @param {Number} x\r\n * @param {Number} y\r\n * @return {Number} direction\r\n */\r\nfunction getDirection(x, y) {\r\n    if (x === y) {\r\n        return DIRECTION_NONE;\r\n    }\r\n\r\n    if (abs(x) >= abs(y)) {\r\n        return x > 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\r\n    }\r\n    return y > 0 ? DIRECTION_UP : DIRECTION_DOWN;\r\n}\r\n\r\n/**\r\n * calculate the absolute distance between two points\r\n * @param {Object} p1 {x, y}\r\n * @param {Object} p2 {x, y}\r\n * @param {Array} [props] containing x and y keys\r\n * @return {Number} distance\r\n */\r\nfunction getDistance(p1, p2, props) {\r\n    if (!props) {\r\n        props = PROPS_XY;\r\n    }\r\n    var x = p2[props[0]] - p1[props[0]],\r\n        y = p2[props[1]] - p1[props[1]];\r\n\r\n    return Math.sqrt((x * x) + (y * y));\r\n}\r\n\r\n/**\r\n * calculate the angle between two coordinates\r\n * @param {Object} p1\r\n * @param {Object} p2\r\n * @param {Array} [props] containing x and y keys\r\n * @return {Number} angle\r\n */\r\nfunction getAngle(p1, p2, props) {\r\n    if (!props) {\r\n        props = PROPS_XY;\r\n    }\r\n    var x = p2[props[0]] - p1[props[0]],\r\n        y = p2[props[1]] - p1[props[1]];\r\n    return Math.atan2(y, x) * 180 / Math.PI;\r\n}\r\n\r\n/**\r\n * calculate the rotation degrees between two pointersets\r\n * @param {Array} start array of pointers\r\n * @param {Array} end array of pointers\r\n * @return {Number} rotation\r\n */\r\nfunction getRotation(start, end) {\r\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) - getAngle(start[1], start[0], PROPS_CLIENT_XY);\r\n}\r\n\r\n/**\r\n * calculate the scale factor between two pointersets\r\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\r\n * @param {Array} start array of pointers\r\n * @param {Array} end array of pointers\r\n * @return {Number} scale\r\n */\r\nfunction getScale(start, end) {\r\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\r\n}\r\n\r\nvar MOUSE_INPUT_MAP = {\r\n    mousedown: INPUT_START,\r\n    mousemove: INPUT_MOVE,\r\n    mouseup: INPUT_END\r\n};\r\n\r\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\r\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\r\n\r\n/**\r\n * Mouse events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction MouseInput() {\r\n    this.evEl = MOUSE_ELEMENT_EVENTS;\r\n    this.evWin = MOUSE_WINDOW_EVENTS;\r\n\r\n    this.allow = true; // used by Input.TouchMouse to disable mouse events\r\n    this.pressed = false; // mousedown state\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(MouseInput, Input, {\r\n    /**\r\n     * handle mouse events\r\n     * @param {Object} ev\r\n     */\r\n    handler: function MEhandler(ev) {\r\n        var eventType = MOUSE_INPUT_MAP[ev.type];\r\n\r\n        // on start we want to have the left mouse button down\r\n        if (eventType & INPUT_START && ev.button === 0) {\r\n            this.pressed = true;\r\n        }\r\n\r\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\r\n            eventType = INPUT_END;\r\n        }\r\n\r\n        // mouse must be down, and mouse events are allowed (see the TouchMouse input)\r\n        if (!this.pressed || !this.allow) {\r\n            return;\r\n        }\r\n\r\n        if (eventType & INPUT_END) {\r\n            this.pressed = false;\r\n        }\r\n\r\n        this.callback(this.manager, eventType, {\r\n            pointers: [ev],\r\n            changedPointers: [ev],\r\n            pointerType: INPUT_TYPE_MOUSE,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\nvar POINTER_INPUT_MAP = {\r\n    pointerdown: INPUT_START,\r\n    pointermove: INPUT_MOVE,\r\n    pointerup: INPUT_END,\r\n    pointercancel: INPUT_CANCEL,\r\n    pointerout: INPUT_CANCEL\r\n};\r\n\r\n// in IE10 the pointer types is defined as an enum\r\nvar IE10_POINTER_TYPE_ENUM = {\r\n    2: INPUT_TYPE_TOUCH,\r\n    3: INPUT_TYPE_PEN,\r\n    4: INPUT_TYPE_MOUSE,\r\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\r\n};\r\n\r\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\r\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\r\n\r\n// IE10 has prefixed support, and case-sensitive\r\nif (window.MSPointerEvent) {\r\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\r\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\r\n}\r\n\r\n/**\r\n * Pointer events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction PointerEventInput() {\r\n    this.evEl = POINTER_ELEMENT_EVENTS;\r\n    this.evWin = POINTER_WINDOW_EVENTS;\r\n\r\n    Input.apply(this, arguments);\r\n\r\n    this.store = (this.manager.session.pointerEvents = []);\r\n}\r\n\r\ninherit(PointerEventInput, Input, {\r\n    /**\r\n     * handle mouse events\r\n     * @param {Object} ev\r\n     */\r\n    handler: function PEhandler(ev) {\r\n        var store = this.store;\r\n        var removePointer = false;\r\n\r\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\r\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\r\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\r\n\r\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\r\n\r\n        // get index of the event in the store\r\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\r\n\r\n        // start and mouse must be down\r\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\r\n            if (storeIndex < 0) {\r\n                store.push(ev);\r\n                storeIndex = store.length - 1;\r\n            }\r\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\r\n            removePointer = true;\r\n        }\r\n\r\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\r\n        if (storeIndex < 0) {\r\n            return;\r\n        }\r\n\r\n        // update the event in the store\r\n        store[storeIndex] = ev;\r\n\r\n        this.callback(this.manager, eventType, {\r\n            pointers: store,\r\n            changedPointers: [ev],\r\n            pointerType: pointerType,\r\n            srcEvent: ev\r\n        });\r\n\r\n        if (removePointer) {\r\n            // remove from the store\r\n            store.splice(storeIndex, 1);\r\n        }\r\n    }\r\n});\r\n\r\nvar SINGLE_TOUCH_INPUT_MAP = {\r\n    touchstart: INPUT_START,\r\n    touchmove: INPUT_MOVE,\r\n    touchend: INPUT_END,\r\n    touchcancel: INPUT_CANCEL\r\n};\r\n\r\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\r\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\r\n\r\n/**\r\n * Touch events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction SingleTouchInput() {\r\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\r\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\r\n    this.started = false;\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(SingleTouchInput, Input, {\r\n    handler: function TEhandler(ev) {\r\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\r\n\r\n        // should we handle the touch events?\r\n        if (type === INPUT_START) {\r\n            this.started = true;\r\n        }\r\n\r\n        if (!this.started) {\r\n            return;\r\n        }\r\n\r\n        var touches = normalizeSingleTouches.call(this, ev, type);\r\n\r\n        // when done, reset the started state\r\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\r\n            this.started = false;\r\n        }\r\n\r\n        this.callback(this.manager, type, {\r\n            pointers: touches[0],\r\n            changedPointers: touches[1],\r\n            pointerType: INPUT_TYPE_TOUCH,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\n/**\r\n * @this {TouchInput}\r\n * @param {Object} ev\r\n * @param {Number} type flag\r\n * @returns {undefined|Array} [all, changed]\r\n */\r\nfunction normalizeSingleTouches(ev, type) {\r\n    var all = toArray(ev.touches);\r\n    var changed = toArray(ev.changedTouches);\r\n\r\n    if (type & (INPUT_END | INPUT_CANCEL)) {\r\n        all = uniqueArray(all.concat(changed), 'identifier', true);\r\n    }\r\n\r\n    return [all, changed];\r\n}\r\n\r\nvar TOUCH_INPUT_MAP = {\r\n    touchstart: INPUT_START,\r\n    touchmove: INPUT_MOVE,\r\n    touchend: INPUT_END,\r\n    touchcancel: INPUT_CANCEL\r\n};\r\n\r\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\r\n\r\n/**\r\n * Multi-user touch events input\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction TouchInput() {\r\n    this.evTarget = TOUCH_TARGET_EVENTS;\r\n    this.targetIds = {};\r\n\r\n    Input.apply(this, arguments);\r\n}\r\n\r\ninherit(TouchInput, Input, {\r\n    handler: function MTEhandler(ev) {\r\n        var type = TOUCH_INPUT_MAP[ev.type];\r\n        var touches = getTouches.call(this, ev, type);\r\n        if (!touches) {\r\n            return;\r\n        }\r\n\r\n        this.callback(this.manager, type, {\r\n            pointers: touches[0],\r\n            changedPointers: touches[1],\r\n            pointerType: INPUT_TYPE_TOUCH,\r\n            srcEvent: ev\r\n        });\r\n    }\r\n});\r\n\r\n/**\r\n * @this {TouchInput}\r\n * @param {Object} ev\r\n * @param {Number} type flag\r\n * @returns {undefined|Array} [all, changed]\r\n */\r\nfunction getTouches(ev, type) {\r\n    var allTouches = toArray(ev.touches);\r\n    var targetIds = this.targetIds;\r\n\r\n    // when there is only one touch, the process can be simplified\r\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\r\n        targetIds[allTouches[0].identifier] = true;\r\n        return [allTouches, allTouches];\r\n    }\r\n\r\n    var i,\r\n        targetTouches,\r\n        changedTouches = toArray(ev.changedTouches),\r\n        changedTargetTouches = [],\r\n        target = this.target;\r\n\r\n    // get target touches from touches\r\n    targetTouches = allTouches.filter(function(touch) {\r\n        return hasParent(touch.target, target);\r\n    });\r\n\r\n    // collect touches\r\n    if (type === INPUT_START) {\r\n        i = 0;\r\n        while (i < targetTouches.length) {\r\n            targetIds[targetTouches[i].identifier] = true;\r\n            i++;\r\n        }\r\n    }\r\n\r\n    // filter changed touches to only contain touches that exist in the collected target ids\r\n    i = 0;\r\n    while (i < changedTouches.length) {\r\n        if (targetIds[changedTouches[i].identifier]) {\r\n            changedTargetTouches.push(changedTouches[i]);\r\n        }\r\n\r\n        // cleanup removed touches\r\n        if (type & (INPUT_END | INPUT_CANCEL)) {\r\n            delete targetIds[changedTouches[i].identifier];\r\n        }\r\n        i++;\r\n    }\r\n\r\n    if (!changedTargetTouches.length) {\r\n        return;\r\n    }\r\n\r\n    return [\r\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\r\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\r\n        changedTargetTouches\r\n    ];\r\n}\r\n\r\n/**\r\n * Combined touch and mouse input\r\n *\r\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\r\n * This because touch devices also emit mouse events while doing a touch.\r\n *\r\n * @constructor\r\n * @extends Input\r\n */\r\nfunction TouchMouseInput() {\r\n    Input.apply(this, arguments);\r\n\r\n    var handler = bindFn(this.handler, this);\r\n    this.touch = new TouchInput(this.manager, handler);\r\n    this.mouse = new MouseInput(this.manager, handler);\r\n}\r\n\r\ninherit(TouchMouseInput, Input, {\r\n    /**\r\n     * handle mouse and touch events\r\n     * @param {Hammer} manager\r\n     * @param {String} inputEvent\r\n     * @param {Object} inputData\r\n     */\r\n    handler: function TMEhandler(manager, inputEvent, inputData) {\r\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\r\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\r\n\r\n        // when we're in a touch event, so  block all upcoming mouse events\r\n        // most mobile browser also emit mouseevents, right after touchstart\r\n        if (isTouch) {\r\n            this.mouse.allow = false;\r\n        } else if (isMouse && !this.mouse.allow) {\r\n            return;\r\n        }\r\n\r\n        // reset the allowMouse when we're done\r\n        if (inputEvent & (INPUT_END | INPUT_CANCEL)) {\r\n            this.mouse.allow = true;\r\n        }\r\n\r\n        this.callback(manager, inputEvent, inputData);\r\n    },\r\n\r\n    /**\r\n     * remove the event listeners\r\n     */\r\n    destroy: function destroy() {\r\n        this.touch.destroy();\r\n        this.mouse.destroy();\r\n    }\r\n});\r\n\r\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\r\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\r\n\r\n// magical touchAction value\r\nvar TOUCH_ACTION_COMPUTE = 'compute';\r\nvar TOUCH_ACTION_AUTO = 'auto';\r\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\r\nvar TOUCH_ACTION_NONE = 'none';\r\nvar TOUCH_ACTION_PAN_X = 'pan-x';\r\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\r\n\r\n/**\r\n * Touch Action\r\n * sets the touchAction property or uses the js alternative\r\n * @param {Manager} manager\r\n * @param {String} value\r\n * @constructor\r\n */\r\nfunction TouchAction(manager, value) {\r\n    this.manager = manager;\r\n    this.set(value);\r\n}\r\n\r\nTouchAction.prototype = {\r\n    /**\r\n     * set the touchAction value on the element or enable the polyfill\r\n     * @param {String} value\r\n     */\r\n    set: function(value) {\r\n        // find out the touch-action by the event handlers\r\n        if (value == TOUCH_ACTION_COMPUTE) {\r\n            value = this.compute();\r\n        }\r\n\r\n        if (NATIVE_TOUCH_ACTION) {\r\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\r\n        }\r\n        this.actions = value.toLowerCase().trim();\r\n    },\r\n\r\n    /**\r\n     * just re-set the touchAction value\r\n     */\r\n    update: function() {\r\n        this.set(this.manager.options.touchAction);\r\n    },\r\n\r\n    /**\r\n     * compute the value for the touchAction property based on the recognizer's settings\r\n     * @returns {String} value\r\n     */\r\n    compute: function() {\r\n        var actions = [];\r\n        each(this.manager.recognizers, function(recognizer) {\r\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\r\n                actions = actions.concat(recognizer.getTouchAction());\r\n            }\r\n        });\r\n        return cleanTouchActions(actions.join(' '));\r\n    },\r\n\r\n    /**\r\n     * this method is called on each input cycle and provides the preventing of the browser behavior\r\n     * @param {Object} input\r\n     */\r\n    preventDefaults: function(input) {\r\n        // not needed with native support for the touchAction property\r\n        if (NATIVE_TOUCH_ACTION) {\r\n            return;\r\n        }\r\n\r\n        var srcEvent = input.srcEvent;\r\n        var direction = input.offsetDirection;\r\n\r\n        // if the touch action did prevented once this session\r\n        if (this.manager.session.prevented) {\r\n            srcEvent.preventDefault();\r\n            return;\r\n        }\r\n\r\n        var actions = this.actions;\r\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE);\r\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\r\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\r\n\r\n        if (hasNone ||\r\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\r\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\r\n            return this.preventSrc(srcEvent);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\r\n     * @param {Object} srcEvent\r\n     */\r\n    preventSrc: function(srcEvent) {\r\n        this.manager.session.prevented = true;\r\n        srcEvent.preventDefault();\r\n    }\r\n};\r\n\r\n/**\r\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\r\n * @param {String} actions\r\n * @returns {*}\r\n */\r\nfunction cleanTouchActions(actions) {\r\n    // none\r\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\r\n        return TOUCH_ACTION_NONE;\r\n    }\r\n\r\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\r\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\r\n\r\n    // pan-x and pan-y can be combined\r\n    if (hasPanX && hasPanY) {\r\n        return TOUCH_ACTION_PAN_X + ' ' + TOUCH_ACTION_PAN_Y;\r\n    }\r\n\r\n    // pan-x OR pan-y\r\n    if (hasPanX || hasPanY) {\r\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\r\n    }\r\n\r\n    // manipulation\r\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\r\n        return TOUCH_ACTION_MANIPULATION;\r\n    }\r\n\r\n    return TOUCH_ACTION_AUTO;\r\n}\r\n\r\n/**\r\n * Recognizer flow explained; *\r\n * All recognizers have the initial state of POSSIBLE when a input session starts.\r\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\r\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\r\n *\r\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\r\n * which determines with state it should be.\r\n *\r\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\r\n * POSSIBLE to give it another change on the next cycle.\r\n *\r\n *               Possible\r\n *                  |\r\n *            +-----+---------------+\r\n *            |                     |\r\n *      +-----+-----+               |\r\n *      |           |               |\r\n *   Failed      Cancelled          |\r\n *                          +-------+------+\r\n *                          |              |\r\n *                      Recognized       Began\r\n *                                         |\r\n *                                      Changed\r\n *                                         |\r\n *                                  Ended/Recognized\r\n */\r\nvar STATE_POSSIBLE = 1;\r\nvar STATE_BEGAN = 2;\r\nvar STATE_CHANGED = 4;\r\nvar STATE_ENDED = 8;\r\nvar STATE_RECOGNIZED = STATE_ENDED;\r\nvar STATE_CANCELLED = 16;\r\nvar STATE_FAILED = 32;\r\n\r\n/**\r\n * Recognizer\r\n * Every recognizer needs to extend from this class.\r\n * @constructor\r\n * @param {Object} options\r\n */\r\nfunction Recognizer(options) {\r\n    this.id = uniqueId();\r\n\r\n    this.manager = null;\r\n    this.options = merge(options || {}, this.defaults);\r\n\r\n    // default is enable true\r\n    this.options.enable = ifUndefined(this.options.enable, true);\r\n\r\n    this.state = STATE_POSSIBLE;\r\n\r\n    this.simultaneous = {};\r\n    this.requireFail = [];\r\n}\r\n\r\nRecognizer.prototype = {\r\n    /**\r\n     * @virtual\r\n     * @type {Object}\r\n     */\r\n    defaults: {},\r\n\r\n    /**\r\n     * set options\r\n     * @param {Object} options\r\n     * @return {Recognizer}\r\n     */\r\n    set: function(options) {\r\n        extend(this.options, options);\r\n\r\n        // also update the touchAction, in case something changed about the directions/enabled state\r\n        this.manager && this.manager.touchAction.update();\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * recognize simultaneous with an other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    recognizeWith: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\r\n            return this;\r\n        }\r\n\r\n        var simultaneous = this.simultaneous;\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        if (!simultaneous[otherRecognizer.id]) {\r\n            simultaneous[otherRecognizer.id] = otherRecognizer;\r\n            otherRecognizer.recognizeWith(this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    dropRecognizeWith: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\r\n            return this;\r\n        }\r\n\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        delete this.simultaneous[otherRecognizer.id];\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * recognizer can only run when an other is failing\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    requireFailure: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\r\n            return this;\r\n        }\r\n\r\n        var requireFail = this.requireFail;\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        if (inArray(requireFail, otherRecognizer) === -1) {\r\n            requireFail.push(otherRecognizer);\r\n            otherRecognizer.requireFailure(this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Recognizer} this\r\n     */\r\n    dropRequireFailure: function(otherRecognizer) {\r\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\r\n            return this;\r\n        }\r\n\r\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\r\n        var index = inArray(this.requireFail, otherRecognizer);\r\n        if (index > -1) {\r\n            this.requireFail.splice(index, 1);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * has require failures boolean\r\n     * @returns {boolean}\r\n     */\r\n    hasRequireFailures: function() {\r\n        return this.requireFail.length > 0;\r\n    },\r\n\r\n    /**\r\n     * if the recognizer can recognize simultaneous with an other recognizer\r\n     * @param {Recognizer} otherRecognizer\r\n     * @returns {Boolean}\r\n     */\r\n    canRecognizeWith: function(otherRecognizer) {\r\n        return !!this.simultaneous[otherRecognizer.id];\r\n    },\r\n\r\n    /**\r\n     * You should use `tryEmit` instead of `emit` directly to check\r\n     * that all the needed recognizers has failed before emitting.\r\n     * @param {Object} input\r\n     */\r\n    emit: function(input) {\r\n        var self = this;\r\n        var state = this.state;\r\n\r\n        function emit(withState) {\r\n            self.manager.emit(self.options.event + (withState ? stateStr(state) : ''), input);\r\n        }\r\n\r\n        // 'panstart' and 'panmove'\r\n        if (state < STATE_ENDED) {\r\n            emit(true);\r\n        }\r\n\r\n        emit(); // simple 'eventName' events\r\n\r\n        // panend and pancancel\r\n        if (state >= STATE_ENDED) {\r\n            emit(true);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Check that all the require failure recognizers has failed,\r\n     * if true, it emits a gesture event,\r\n     * otherwise, setup the state to FAILED.\r\n     * @param {Object} input\r\n     */\r\n    tryEmit: function(input) {\r\n        if (this.canEmit()) {\r\n            return this.emit(input);\r\n        }\r\n        // it's failing anyway\r\n        this.state = STATE_FAILED;\r\n    },\r\n\r\n    /**\r\n     * can we emit?\r\n     * @returns {boolean}\r\n     */\r\n    canEmit: function() {\r\n        var i = 0;\r\n        while (i < this.requireFail.length) {\r\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\r\n                return false;\r\n            }\r\n            i++;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * update the recognizer\r\n     * @param {Object} inputData\r\n     */\r\n    recognize: function(inputData) {\r\n        // make a new copy of the inputData\r\n        // so we can change the inputData without messing up the other recognizers\r\n        var inputDataClone = extend({}, inputData);\r\n\r\n        // is is enabled and allow recognizing?\r\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\r\n            this.reset();\r\n            this.state = STATE_FAILED;\r\n            return;\r\n        }\r\n\r\n        // reset when we've reached the end\r\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\r\n            this.state = STATE_POSSIBLE;\r\n        }\r\n\r\n        this.state = this.process(inputDataClone);\r\n\r\n        // the recognizer has recognized a gesture\r\n        // so trigger an event\r\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\r\n            this.tryEmit(inputDataClone);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * return the state of the recognizer\r\n     * the actual recognizing happens in this method\r\n     * @virtual\r\n     * @param {Object} inputData\r\n     * @returns {Const} STATE\r\n     */\r\n    process: function(inputData) { }, // jshint ignore:line\r\n\r\n    /**\r\n     * return the preferred touch-action\r\n     * @virtual\r\n     * @returns {Array}\r\n     */\r\n    getTouchAction: function() { },\r\n\r\n    /**\r\n     * called when the gesture isn't allowed to recognize\r\n     * like when another is being recognized or it is disabled\r\n     * @virtual\r\n     */\r\n    reset: function() { }\r\n};\r\n\r\n/**\r\n * get a usable string, used as event postfix\r\n * @param {Const} state\r\n * @returns {String} state\r\n */\r\nfunction stateStr(state) {\r\n    if (state & STATE_CANCELLED) {\r\n        return 'cancel';\r\n    } else if (state & STATE_ENDED) {\r\n        return 'end';\r\n    } else if (state & STATE_CHANGED) {\r\n        return 'move';\r\n    } else if (state & STATE_BEGAN) {\r\n        return 'start';\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * direction cons to string\r\n * @param {Const} direction\r\n * @returns {String}\r\n */\r\nfunction directionStr(direction) {\r\n    if (direction == DIRECTION_DOWN) {\r\n        return 'down';\r\n    } else if (direction == DIRECTION_UP) {\r\n        return 'up';\r\n    } else if (direction == DIRECTION_LEFT) {\r\n        return 'left';\r\n    } else if (direction == DIRECTION_RIGHT) {\r\n        return 'right';\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * get a recognizer by name if it is bound to a manager\r\n * @param {Recognizer|String} otherRecognizer\r\n * @param {Recognizer} recognizer\r\n * @returns {Recognizer}\r\n */\r\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\r\n    var manager = recognizer.manager;\r\n    if (manager) {\r\n        return manager.get(otherRecognizer);\r\n    }\r\n    return otherRecognizer;\r\n}\r\n\r\n/**\r\n * This recognizer is just used as a base for the simple attribute recognizers.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction AttrRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(AttrRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof AttrRecognizer\r\n     */\r\n    defaults: {\r\n        /**\r\n         * @type {Number}\r\n         * @default 1\r\n         */\r\n        pointers: 1\r\n    },\r\n\r\n    /**\r\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\r\n     * @memberof AttrRecognizer\r\n     * @param {Object} input\r\n     * @returns {Boolean} recognized\r\n     */\r\n    attrTest: function(input) {\r\n        var optionPointers = this.options.pointers;\r\n        return optionPointers === 0 || input.pointers.length === optionPointers;\r\n    },\r\n\r\n    /**\r\n     * Process the input and return the state for the recognizer\r\n     * @memberof AttrRecognizer\r\n     * @param {Object} input\r\n     * @returns {*} State\r\n     */\r\n    process: function(input) {\r\n        var state = this.state;\r\n        var eventType = input.eventType;\r\n\r\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\r\n        var isValid = this.attrTest(input);\r\n\r\n        // on cancel input and we've recognized before, return STATE_CANCELLED\r\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\r\n            return state | STATE_CANCELLED;\r\n        } else if (isRecognized || isValid) {\r\n            if (eventType & INPUT_END) {\r\n                return state | STATE_ENDED;\r\n            } else if (!(state & STATE_BEGAN)) {\r\n                return STATE_BEGAN;\r\n            }\r\n            return state | STATE_CHANGED;\r\n        }\r\n        return STATE_FAILED;\r\n    }\r\n});\r\n\r\n/**\r\n * Pan\r\n * Recognized when the pointer is down and moved in the allowed direction.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction PanRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n\r\n    this.pX = null;\r\n    this.pY = null;\r\n}\r\n\r\ninherit(PanRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PanRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'pan',\r\n        threshold: 10,\r\n        pointers: 1,\r\n        direction: DIRECTION_ALL\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        var direction = this.options.direction;\r\n        var actions = [];\r\n        if (direction & DIRECTION_HORIZONTAL) {\r\n            actions.push(TOUCH_ACTION_PAN_Y);\r\n        }\r\n        if (direction & DIRECTION_VERTICAL) {\r\n            actions.push(TOUCH_ACTION_PAN_X);\r\n        }\r\n        return actions;\r\n    },\r\n\r\n    directionTest: function(input) {\r\n        var options = this.options;\r\n        var hasMoved = true;\r\n        var distance = input.distance;\r\n        var direction = input.direction;\r\n        var x = input.deltaX;\r\n        var y = input.deltaY;\r\n\r\n        // lock to axis?\r\n        if (!(direction & options.direction)) {\r\n            if (options.direction & DIRECTION_HORIZONTAL) {\r\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\r\n                hasMoved = x != this.pX;\r\n                distance = Math.abs(input.deltaX);\r\n            } else {\r\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\r\n                hasMoved = y != this.pY;\r\n                distance = Math.abs(input.deltaY);\r\n            }\r\n        }\r\n        input.direction = direction;\r\n        return hasMoved && distance > options.threshold && direction & options.direction;\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\r\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\r\n    },\r\n\r\n    emit: function(input) {\r\n        this.pX = input.deltaX;\r\n        this.pY = input.deltaY;\r\n\r\n        var direction = directionStr(input.direction);\r\n        if (direction) {\r\n            this.manager.emit(this.options.event + direction, input);\r\n        }\r\n\r\n        this._super.emit.call(this, input);\r\n    }\r\n});\r\n\r\n/**\r\n * Pinch\r\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction PinchRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(PinchRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PinchRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'pinch',\r\n        threshold: 0,\r\n        pointers: 2\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_NONE];\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return this._super.attrTest.call(this, input) &&\r\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\r\n    },\r\n\r\n    emit: function(input) {\r\n        this._super.emit.call(this, input);\r\n        if (input.scale !== 1) {\r\n            var inOut = input.scale < 1 ? 'in' : 'out';\r\n            this.manager.emit(this.options.event + inOut, input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Press\r\n * Recognized when the pointer is down for x ms without any movement.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction PressRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n\r\n    this._timer = null;\r\n    this._input = null;\r\n}\r\n\r\ninherit(PressRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PressRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'press',\r\n        pointers: 1,\r\n        time: 500, // minimal time of the pointer to be pressed\r\n        threshold: 5 // a minimal movement is ok, but keep it low\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_AUTO];\r\n    },\r\n\r\n    process: function(input) {\r\n        var options = this.options;\r\n        var validPointers = input.pointers.length === options.pointers;\r\n        var validMovement = input.distance < options.threshold;\r\n        var validTime = input.deltaTime > options.time;\r\n\r\n        this._input = input;\r\n\r\n        // we only allow little movement\r\n        // and we've reached an end event, so a tap is possible\r\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\r\n            this.reset();\r\n        } else if (input.eventType & INPUT_START) {\r\n            this.reset();\r\n            this._timer = setTimeoutContext(function() {\r\n                this.state = STATE_RECOGNIZED;\r\n                this.tryEmit();\r\n            }, options.time, this);\r\n        } else if (input.eventType & INPUT_END) {\r\n            return STATE_RECOGNIZED;\r\n        }\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    reset: function() {\r\n        clearTimeout(this._timer);\r\n    },\r\n\r\n    emit: function(input) {\r\n        if (this.state !== STATE_RECOGNIZED) {\r\n            return;\r\n        }\r\n\r\n        if (input && (input.eventType & INPUT_END)) {\r\n            this.manager.emit(this.options.event + 'up', input);\r\n        } else {\r\n            this._input.timeStamp = now();\r\n            this.manager.emit(this.options.event, this._input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Rotate\r\n * Recognized when two or more pointer are moving in a circular motion.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction RotateRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(RotateRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof RotateRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'rotate',\r\n        threshold: 0,\r\n        pointers: 2\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_NONE];\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        return this._super.attrTest.call(this, input) &&\r\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\r\n    }\r\n});\r\n\r\n/**\r\n * Swipe\r\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\r\n * @constructor\r\n * @extends AttrRecognizer\r\n */\r\nfunction SwipeRecognizer() {\r\n    AttrRecognizer.apply(this, arguments);\r\n}\r\n\r\ninherit(SwipeRecognizer, AttrRecognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof SwipeRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'swipe',\r\n        threshold: 10,\r\n        velocity: 0.65,\r\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\r\n        pointers: 1\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return PanRecognizer.prototype.getTouchAction.call(this);\r\n    },\r\n\r\n    attrTest: function(input) {\r\n        var direction = this.options.direction;\r\n        var velocity;\r\n\r\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\r\n            velocity = input.velocity;\r\n        } else if (direction & DIRECTION_HORIZONTAL) {\r\n            velocity = input.velocityX;\r\n        } else if (direction & DIRECTION_VERTICAL) {\r\n            velocity = input.velocityY;\r\n        }\r\n\r\n        return this._super.attrTest.call(this, input) &&\r\n            direction & input.direction &&\r\n            input.distance > this.options.threshold &&\r\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\r\n    },\r\n\r\n    emit: function(input) {\r\n        var direction = directionStr(input.direction);\r\n        if (direction) {\r\n            this.manager.emit(this.options.event + direction, input);\r\n        }\r\n\r\n        this.manager.emit(this.options.event, input);\r\n    }\r\n});\r\n\r\n/**\r\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\r\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\r\n * a single tap.\r\n *\r\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\r\n * multi-taps being recognized.\r\n * @constructor\r\n * @extends Recognizer\r\n */\r\nfunction TapRecognizer() {\r\n    Recognizer.apply(this, arguments);\r\n\r\n    // previous time and center,\r\n    // used for tap counting\r\n    this.pTime = false;\r\n    this.pCenter = false;\r\n\r\n    this._timer = null;\r\n    this._input = null;\r\n    this.count = 0;\r\n}\r\n\r\ninherit(TapRecognizer, Recognizer, {\r\n    /**\r\n     * @namespace\r\n     * @memberof PinchRecognizer\r\n     */\r\n    defaults: {\r\n        event: 'tap',\r\n        pointers: 1,\r\n        taps: 1,\r\n        interval: 300, // max time between the multi-tap taps\r\n        time: 250, // max time of the pointer to be down (like finger on the screen)\r\n        threshold: 2, // a minimal movement is ok, but keep it low\r\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\r\n    },\r\n\r\n    getTouchAction: function() {\r\n        return [TOUCH_ACTION_MANIPULATION];\r\n    },\r\n\r\n    process: function(input) {\r\n        var options = this.options;\r\n\r\n        var validPointers = input.pointers.length === options.pointers;\r\n        var validMovement = input.distance < options.threshold;\r\n        var validTouchTime = input.deltaTime < options.time;\r\n\r\n        this.reset();\r\n\r\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\r\n            return this.failTimeout();\r\n        }\r\n\r\n        // we only allow little movement\r\n        // and we've reached an end event, so a tap is possible\r\n        if (validMovement && validTouchTime && validPointers) {\r\n            if (input.eventType != INPUT_END) {\r\n                return this.failTimeout();\r\n            }\r\n\r\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\r\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\r\n\r\n            this.pTime = input.timeStamp;\r\n            this.pCenter = input.center;\r\n\r\n            if (!validMultiTap || !validInterval) {\r\n                this.count = 1;\r\n            } else {\r\n                this.count += 1;\r\n            }\r\n\r\n            this._input = input;\r\n\r\n            // if tap count matches we have recognized it,\r\n            // else it has began recognizing...\r\n            var tapCount = this.count % options.taps;\r\n            if (tapCount === 0) {\r\n                // no failing requirements, immediately trigger the tap event\r\n                // or wait as long as the multitap interval to trigger\r\n                if (!this.hasRequireFailures()) {\r\n                    return STATE_RECOGNIZED;\r\n                } else {\r\n                    this._timer = setTimeoutContext(function() {\r\n                        this.state = STATE_RECOGNIZED;\r\n                        this.tryEmit();\r\n                    }, options.interval, this);\r\n                    return STATE_BEGAN;\r\n                }\r\n            }\r\n        }\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    failTimeout: function() {\r\n        this._timer = setTimeoutContext(function() {\r\n            this.state = STATE_FAILED;\r\n        }, this.options.interval, this);\r\n        return STATE_FAILED;\r\n    },\r\n\r\n    reset: function() {\r\n        clearTimeout(this._timer);\r\n    },\r\n\r\n    emit: function() {\r\n        if (this.state == STATE_RECOGNIZED ) {\r\n            this._input.tapCount = this.count;\r\n            this.manager.emit(this.options.event, this._input);\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Simple way to create an manager with a default set of recognizers.\r\n * @param {HTMLElement} element\r\n * @param {Object} [options]\r\n * @constructor\r\n */\r\nfunction Hammer(element, options) {\r\n    options = options || {};\r\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\r\n    return new Manager(element, options);\r\n}\r\n\r\n/**\r\n * @const {string}\r\n */\r\nHammer.VERSION = '2.0.4';\r\n\r\n/**\r\n * default settings\r\n * @namespace\r\n */\r\nHammer.defaults = {\r\n    /**\r\n     * set if DOM events are being triggered.\r\n     * But this is slower and unused by simple implementations, so disabled by default.\r\n     * @type {Boolean}\r\n     * @default false\r\n     */\r\n    domEvents: false,\r\n\r\n    /**\r\n     * The value for the touchAction property/fallback.\r\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\r\n     * @type {String}\r\n     * @default compute\r\n     */\r\n    touchAction: TOUCH_ACTION_COMPUTE,\r\n\r\n    /**\r\n     * @type {Boolean}\r\n     * @default true\r\n     */\r\n    enable: true,\r\n\r\n    /**\r\n     * EXPERIMENTAL FEATURE -- can be removed/changed\r\n     * Change the parent input target element.\r\n     * If Null, then it is being set the to main element.\r\n     * @type {Null|EventTarget}\r\n     * @default null\r\n     */\r\n    inputTarget: null,\r\n\r\n    /**\r\n     * force an input class\r\n     * @type {Null|Function}\r\n     * @default null\r\n     */\r\n    inputClass: null,\r\n\r\n    /**\r\n     * Default recognizer setup when calling `Hammer()`\r\n     * When creating a new Manager these will be skipped.\r\n     * @type {Array}\r\n     */\r\n    preset: [\r\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\r\n        [RotateRecognizer, { enable: false }],\r\n        [PinchRecognizer, { enable: false }, ['rotate']],\r\n        [SwipeRecognizer,{ direction: DIRECTION_HORIZONTAL }],\r\n        [PanRecognizer, { direction: DIRECTION_HORIZONTAL }, ['swipe']],\r\n        [TapRecognizer],\r\n        [TapRecognizer, { event: 'doubletap', taps: 2 }, ['tap']],\r\n        [PressRecognizer]\r\n    ],\r\n\r\n    /**\r\n     * Some CSS properties can be used to improve the working of Hammer.\r\n     * Add them to this method and they will be set when creating a new Manager.\r\n     * @namespace\r\n     */\r\n    cssProps: {\r\n        /**\r\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        userSelect: 'none',\r\n\r\n        /**\r\n         * Disable the Windows Phone grippers when pressing an element.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        touchSelect: 'none',\r\n\r\n        /**\r\n         * Disables the default callout shown when you touch and hold a touch target.\r\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\r\n         * a callout containing information about the link. This property allows you to disable that callout.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        touchCallout: 'none',\r\n\r\n        /**\r\n         * Specifies whether zooming is enabled. Used by IE10>\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        contentZooming: 'none',\r\n\r\n        /**\r\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\r\n         * @type {String}\r\n         * @default 'none'\r\n         */\r\n        userDrag: 'none',\r\n\r\n        /**\r\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\r\n         * clickable element in iOS. This property obeys the alpha value, if specified.\r\n         * @type {String}\r\n         * @default 'rgba(0,0,0,0)'\r\n         */\r\n        tapHighlightColor: 'rgba(0,0,0,0)'\r\n    }\r\n};\r\n\r\nvar STOP = 1;\r\nvar FORCED_STOP = 2;\r\n\r\n/**\r\n * Manager\r\n * @param {HTMLElement} element\r\n * @param {Object} [options]\r\n * @constructor\r\n */\r\nfunction Manager(element, options) {\r\n    options = options || {};\r\n\r\n    this.options = merge(options, Hammer.defaults);\r\n    this.options.inputTarget = this.options.inputTarget || element;\r\n\r\n    this.handlers = {};\r\n    this.session = {};\r\n    this.recognizers = [];\r\n\r\n    this.element = element;\r\n    this.input = createInputInstance(this);\r\n    this.touchAction = new TouchAction(this, this.options.touchAction);\r\n\r\n    toggleCssProps(this, true);\r\n\r\n    each(options.recognizers, function(item) {\r\n        var recognizer = this.add(new (item[0])(item[1]));\r\n        item[2] && recognizer.recognizeWith(item[2]);\r\n        item[3] && recognizer.requireFailure(item[3]);\r\n    }, this);\r\n}\r\n\r\nManager.prototype = {\r\n    /**\r\n     * set options\r\n     * @param {Object} options\r\n     * @returns {Manager}\r\n     */\r\n    set: function(options) {\r\n        extend(this.options, options);\r\n\r\n        // Options that need a little more setup\r\n        if (options.touchAction) {\r\n            this.touchAction.update();\r\n        }\r\n        if (options.inputTarget) {\r\n            // Clean up existing event listeners and reinitialize\r\n            this.input.destroy();\r\n            this.input.target = options.inputTarget;\r\n            this.input.init();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * stop recognizing for this session.\r\n     * This session will be discarded, when a new [input]start event is fired.\r\n     * When forced, the recognizer cycle is stopped immediately.\r\n     * @param {Boolean} [force]\r\n     */\r\n    stop: function(force) {\r\n        this.session.stopped = force ? FORCED_STOP : STOP;\r\n    },\r\n\r\n    /**\r\n     * run the recognizers!\r\n     * called by the inputHandler function on every movement of the pointers (touches)\r\n     * it walks through all the recognizers and tries to detect the gesture that is being made\r\n     * @param {Object} inputData\r\n     */\r\n    recognize: function(inputData) {\r\n        var session = this.session;\r\n        if (session.stopped) {\r\n            return;\r\n        }\r\n\r\n        // run the touch-action polyfill\r\n        this.touchAction.preventDefaults(inputData);\r\n\r\n        var recognizer;\r\n        var recognizers = this.recognizers;\r\n\r\n        // this holds the recognizer that is being recognized.\r\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\r\n        // if no recognizer is detecting a thing, it is set to `null`\r\n        var curRecognizer = session.curRecognizer;\r\n\r\n        // reset when the last recognizer is recognized\r\n        // or when we're in a new session\r\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\r\n            curRecognizer = session.curRecognizer = null;\r\n        }\r\n\r\n        var i = 0;\r\n        while (i < recognizers.length) {\r\n            recognizer = recognizers[i];\r\n\r\n            // find out if we are allowed try to recognize the input for this one.\r\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\r\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\r\n            //      that is being recognized.\r\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\r\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\r\n            if (session.stopped !== FORCED_STOP && ( // 1\r\n                    !curRecognizer || recognizer == curRecognizer || // 2\r\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\r\n                recognizer.recognize(inputData);\r\n            } else {\r\n                recognizer.reset();\r\n            }\r\n\r\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\r\n            // current active recognizer. but only if we don't already have an active recognizer\r\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\r\n                curRecognizer = session.curRecognizer = recognizer;\r\n            }\r\n            i++;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * get a recognizer by its event name.\r\n     * @param {Recognizer|String} recognizer\r\n     * @returns {Recognizer|Null}\r\n     */\r\n    get: function(recognizer) {\r\n        if (recognizer instanceof Recognizer) {\r\n            return recognizer;\r\n        }\r\n\r\n        var recognizers = this.recognizers;\r\n        for (var i = 0; i < recognizers.length; i++) {\r\n            if (recognizers[i].options.event == recognizer) {\r\n                return recognizers[i];\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * add a recognizer to the manager\r\n     * existing recognizers with the same event name will be removed\r\n     * @param {Recognizer} recognizer\r\n     * @returns {Recognizer|Manager}\r\n     */\r\n    add: function(recognizer) {\r\n        if (invokeArrayArg(recognizer, 'add', this)) {\r\n            return this;\r\n        }\r\n\r\n        // remove existing\r\n        var existing = this.get(recognizer.options.event);\r\n        if (existing) {\r\n            this.remove(existing);\r\n        }\r\n\r\n        this.recognizers.push(recognizer);\r\n        recognizer.manager = this;\r\n\r\n        this.touchAction.update();\r\n        return recognizer;\r\n    },\r\n\r\n    /**\r\n     * remove a recognizer by name or instance\r\n     * @param {Recognizer|String} recognizer\r\n     * @returns {Manager}\r\n     */\r\n    remove: function(recognizer) {\r\n        if (invokeArrayArg(recognizer, 'remove', this)) {\r\n            return this;\r\n        }\r\n\r\n        var recognizers = this.recognizers;\r\n        recognizer = this.get(recognizer);\r\n        recognizers.splice(inArray(recognizers, recognizer), 1);\r\n\r\n        this.touchAction.update();\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * bind event\r\n     * @param {String} events\r\n     * @param {Function} handler\r\n     * @returns {EventEmitter} this\r\n     */\r\n    on: function(events, handler) {\r\n        var handlers = this.handlers;\r\n        each(splitStr(events), function(event) {\r\n            handlers[event] = handlers[event] || [];\r\n            handlers[event].push(handler);\r\n        });\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * unbind event, leave emit blank to remove all handlers\r\n     * @param {String} events\r\n     * @param {Function} [handler]\r\n     * @returns {EventEmitter} this\r\n     */\r\n    off: function(events, handler) {\r\n        var handlers = this.handlers;\r\n        each(splitStr(events), function(event) {\r\n            if (!handler) {\r\n                delete handlers[event];\r\n            } else {\r\n                handlers[event].splice(inArray(handlers[event], handler), 1);\r\n            }\r\n        });\r\n        return this;\r\n    },\r\n\r\n    /**\r\n     * emit event to the listeners\r\n     * @param {String} event\r\n     * @param {Object} data\r\n     */\r\n    emit: function(event, data) {\r\n        // we also want to trigger dom events\r\n        if (this.options.domEvents) {\r\n            triggerDomEvent(event, data);\r\n        }\r\n\r\n        // no handlers, so skip it all\r\n        var handlers = this.handlers[event] && this.handlers[event].slice();\r\n        if (!handlers || !handlers.length) {\r\n            return;\r\n        }\r\n\r\n        data.type = event;\r\n        data.preventDefault = function() {\r\n            data.srcEvent.preventDefault();\r\n        };\r\n\r\n        var i = 0;\r\n        while (i < handlers.length) {\r\n            handlers[i](data);\r\n            i++;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * destroy the manager and unbinds all events\r\n     * it doesn't unbind dom events, that is the user own responsibility\r\n     */\r\n    destroy: function() {\r\n        this.element && toggleCssProps(this, false);\r\n\r\n        this.handlers = {};\r\n        this.session = {};\r\n        this.input.destroy();\r\n        this.element = null;\r\n    }\r\n};\r\n\r\n/**\r\n * add/remove the css properties as defined in manager.options.cssProps\r\n * @param {Manager} manager\r\n * @param {Boolean} add\r\n */\r\nfunction toggleCssProps(manager, add) {\r\n    var element = manager.element;\r\n    each(manager.options.cssProps, function(value, name) {\r\n        element.style[prefixed(element.style, name)] = add ? value : '';\r\n    });\r\n}\r\n\r\n/**\r\n * trigger dom event\r\n * @param {String} event\r\n * @param {Object} data\r\n */\r\nfunction triggerDomEvent(event, data) {\r\n    var gestureEvent = document.createEvent('Event');\r\n    gestureEvent.initEvent(event, true, true);\r\n    gestureEvent.gesture = data;\r\n    data.target.dispatchEvent(gestureEvent);\r\n}\r\n\r\nextend(Hammer, {\r\n    INPUT_START: INPUT_START,\r\n    INPUT_MOVE: INPUT_MOVE,\r\n    INPUT_END: INPUT_END,\r\n    INPUT_CANCEL: INPUT_CANCEL,\r\n\r\n    STATE_POSSIBLE: STATE_POSSIBLE,\r\n    STATE_BEGAN: STATE_BEGAN,\r\n    STATE_CHANGED: STATE_CHANGED,\r\n    STATE_ENDED: STATE_ENDED,\r\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\r\n    STATE_CANCELLED: STATE_CANCELLED,\r\n    STATE_FAILED: STATE_FAILED,\r\n\r\n    DIRECTION_NONE: DIRECTION_NONE,\r\n    DIRECTION_LEFT: DIRECTION_LEFT,\r\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\r\n    DIRECTION_UP: DIRECTION_UP,\r\n    DIRECTION_DOWN: DIRECTION_DOWN,\r\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\r\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\r\n    DIRECTION_ALL: DIRECTION_ALL,\r\n\r\n    Manager: Manager,\r\n    Input: Input,\r\n    TouchAction: TouchAction,\r\n\r\n    TouchInput: TouchInput,\r\n    MouseInput: MouseInput,\r\n    PointerEventInput: PointerEventInput,\r\n    TouchMouseInput: TouchMouseInput,\r\n    SingleTouchInput: SingleTouchInput,\r\n\r\n    Recognizer: Recognizer,\r\n    AttrRecognizer: AttrRecognizer,\r\n    Tap: TapRecognizer,\r\n    Pan: PanRecognizer,\r\n    Swipe: SwipeRecognizer,\r\n    Pinch: PinchRecognizer,\r\n    Rotate: RotateRecognizer,\r\n    Press: PressRecognizer,\r\n\r\n    on: addEventListeners,\r\n    off: removeEventListeners,\r\n    each: each,\r\n    merge: merge,\r\n    extend: extend,\r\n    inherit: inherit,\r\n    bindFn: bindFn,\r\n    prefixed: prefixed\r\n});\r\n\r\nif (typeof define == TYPE_FUNCTION && define.amd) {\r\n    define(function() {\r\n        return Hammer;\r\n    });\r\n} else if (typeof module != 'undefined' && module.exports) {\r\n    module.exports = Hammer;\r\n} else {\r\n    window[exportName] = Hammer;\r\n}\r\n\r\n})(window, document, 'Hammer');\r\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Hammer = require('hammerjs');\n\nvar nextId = 1;\nvar idProperty = 'MarzipanoHammerElementId';\nfunction getKeyForElementAndType(element, type) {\n  if (!element[idProperty]) {\n    element[idProperty] = nextId++;\n  }\n  return type + element[idProperty];\n}\n\n\n/**\n * @class HammerGestures\n * @classdesc\n *\n * Manages Hammer.js instances. One instance is created for each combination of\n * DOM element and pointer type.\n */\nfunction HammerGestures() {\n  this._managers = {};\n  this._refCount = {};\n}\n\n\nHammerGestures.prototype.get = function(element, type) {\n  var key = getKeyForElementAndType(element, type);\n  if (!this._managers[key]) {\n    this._managers[key] = this._createManager(element, type);\n    this._refCount[key] = 0;\n  }\n  this._refCount[key]++;\n  return new HammerGesturesHandle(this, this._managers[key], element, type);\n};\n\n\nHammerGestures.prototype._createManager = function(element, type) {\n  var manager = new Hammer.Manager(element);\n\n  // Managers are created with different parameters for different pointer\n  // types.\n  if (type === 'mouse') {\n    manager.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL, threshold: 0 }));\n  }\n  else if (type === 'touch' || type === 'pen' || type === 'kinect') {\n    // On touch one wants to have both panning and pinching. The panning\n    // recognizer needs a threshold to allow the pinch to be recognized.\n    manager.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL, threshold: 20, pointers: 1 }));\n    manager.add(new Hammer.Pinch());\n  }\n\n  return manager;\n};\n\n\nHammerGestures.prototype._releaseHandle = function(element, type) {\n  var key = getKeyForElementAndType(element, type);\n  if (this._refCount[key]) {\n    this._refCount[key]--;\n    if (!this._refCount[key]) {\n      this._managers[key].destroy();\n      delete this._managers[key];\n      delete this._refCount[key];\n    }\n  }\n};\n\n\nfunction HammerGesturesHandle(hammerGestures, manager, element, type) {\n  this._manager = manager;\n  this._element = element;\n  this._type = type;\n  this._hammerGestures = hammerGestures;\n  this._eventHandlers = [];\n}\n\n\nHammerGesturesHandle.prototype.on = function(events, handler) {\n  var type = this._type;\n  var handlerFilteredEvents = function(e) {\n    if (type === e.pointerType) {\n      handler(e);\n    }\n  };\n\n  this._eventHandlers.push({ events: events, handler: handlerFilteredEvents });\n  this._manager.on(events, handlerFilteredEvents);\n};\n\n\nHammerGesturesHandle.prototype.release = function() {\n  for (var i = 0; i < this._eventHandlers.length; i++) {\n    var eventHandler = this._eventHandlers[i];\n    this._manager.off(eventHandler.events, eventHandler.handler);\n  }\n\n  this._hammerGestures._releaseHandle(this._element, this._type);\n  this._manager = null;\n  this._element = null;\n  this._type = null;\n  this._hammerGestures = null;\n};\n\n\nHammerGesturesHandle.prototype.manager = function() {\n  return this._manager;\n};\n\n\nmodule.exports = new HammerGestures();\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction maxFriction(friction, velocityX, velocityY, maxFrictionTime, result) {\n  var velocity = Math.sqrt(Math.pow(velocityX,2) + Math.pow(velocityY,2));\n  friction = Math.max(friction, velocity/maxFrictionTime);\n  changeVectorNorm(velocityX, velocityY, friction, result);\n  result[0] = Math.abs(result[0]);\n  result[1] = Math.abs(result[1]);\n}\n\nfunction changeVectorNorm(x, y, n, result) {\n  var theta = Math.atan(y/x);\n  result[0] = n * Math.cos(theta);\n  result[1] = n * Math.sin(theta);\n}\n\nmodule.exports = {\n  maxFriction: maxFriction,\n  changeVectorNorm: changeVectorNorm\n};","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar defaults = require('../util/defaults');\nvar maxFriction = require('./util').maxFriction;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOptions = {\n  friction: 6,\n  maxFrictionTime: 0.3\n};\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.controls;\n\n/**\n * @class DragControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the view by clicking/tapping and dragging.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use (e.g.\n * `mouse` or `touch`).\n * @param {Object} opts\n * @param {number} opts.friction\n * @param {number} opts.maxFrictionTime\n */\nfunction DragControlMethod(element, pointerType, opts) {\n  this._element = element;\n\n  this._opts = defaults(opts || {}, defaultOptions);\n\n  this._startEvent = null;\n  this._lastEvent = null;\n\n  this._active = false;\n\n  this._dynamics = {\n    x: new Dynamics(),\n    y: new Dynamics()\n  };\n\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._hammer.on(\"hammer.input\", this._handleHammerEvent.bind(this));\n\n  this._hammer.on('panstart', this._handleStart.bind(this));\n  this._hammer.on('panmove', this._handleMove.bind(this));\n  this._hammer.on('panend', this._handleEnd.bind(this));\n  this._hammer.on('pancancel', this._handleEnd.bind(this));\n\n}\n\neventEmitter(DragControlMethod);\n\n/**\n * Destructor.\n */\nDragControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\nDragControlMethod.prototype._handleHammerEvent = function(e) {\n  if (e.isFirst) {\n    if (debug && this._active) {\n      throw new Error('DragControlMethod active detected when already active');\n    }\n    this._active = true;\n    this.emit('active');\n  }\n  if (e.isFinal) {\n    if (debug && !this._active) {\n      throw new Error('DragControlMethod inactive detected when already inactive');\n    }\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\nDragControlMethod.prototype._handleStart = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  this._startEvent = e;\n};\n\n\nDragControlMethod.prototype._handleMove = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  if (this._startEvent) {\n    this._updateDynamicsMove(e);\n    this.emit('parameterDynamics', 'axisScaledX', this._dynamics.x);\n    this.emit('parameterDynamics', 'axisScaledY', this._dynamics.y);\n  }\n};\n\n\nDragControlMethod.prototype._handleEnd = function(e) {\n  // Prevent this event from dragging other DOM elements, causing\n  // unexpected behavior on Chrome.\n  e.preventDefault();\n\n  if (this._startEvent) {\n    this._updateDynamicsRelease(e);\n    this.emit('parameterDynamics', 'axisScaledX', this._dynamics.x);\n    this.emit('parameterDynamics', 'axisScaledY', this._dynamics.y);\n  }\n\n  this._startEvent = false;\n  this._lastEvent = false;\n};\n\n\nDragControlMethod.prototype._updateDynamicsMove = function(e) {\n  var x = e.deltaX;\n  var y = e.deltaY;\n\n  // When a second finger touches the screen, panstart sometimes has a large\n  // offset at start; subtract that offset to prevent a sudden jump.\n  var eventToSubtract = this._lastEvent || this._startEvent;\n\n  if (eventToSubtract) {\n    x -= eventToSubtract.deltaX;\n    y -= eventToSubtract.deltaY;\n  }\n\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n\n  x /= width;\n  y /= height;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.offset = -x;\n  this._dynamics.y.offset = -y;\n\n  this._lastEvent = e;\n};\n\n\nvar tmpReleaseFriction = [ null, null ];\nDragControlMethod.prototype._updateDynamicsRelease = function(e) {\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n\n  var x = 1000 * e.velocityX / width;\n  var y = 1000 * e.velocityY / height;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.velocity = x;\n  this._dynamics.y.velocity = y;\n\n  maxFriction(this._opts.friction, this._dynamics.x.velocity, this._dynamics.y.velocity, this._opts.maxFrictionTime, tmpReleaseFriction);\n  this._dynamics.x.friction = tmpReleaseFriction[0];\n  this._dynamics.y.friction = tmpReleaseFriction[1];\n};\n\n\nmodule.exports = DragControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar defaults = require('../util/defaults');\nvar maxFriction = require('./util').maxFriction;\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n\nvar defaultOptions = {\n  speed: 8,\n  friction: 6,\n  maxFrictionTime: 0.3\n};\n\n\n/**\n * @class QtvrControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the view by holding the mouse button down and moving it.\n * Also known as \"QTVR\" control mode.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use (e.g.\n * `mouse` or `touch`).\n * @param {Object} opts\n * @param {number} opts.speed\n * @param {number} opts.friction\n * @param {number} opts.maxFrictionTime\n */\n// TODO: allow speed not change linearly with distance to click spot.\n// Quadratic or other would allow a larger speed range.\nfunction QtvrControlMethod(element, pointerType, opts) {\n  this._element = element;\n\n  this._opts = defaults(opts || {}, defaultOptions);\n\n  this._active = false;\n\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._dynamics = {\n    x: new Dynamics(),\n    y: new Dynamics()\n  };\n\n  this._hammer.on('panstart', this._handleStart.bind(this));\n  this._hammer.on('panmove', this._handleMove.bind(this));\n  this._hammer.on('panend', this._handleRelease.bind(this));\n  this._hammer.on('pancancel', this._handleRelease.bind(this));\n}\n\neventEmitter(QtvrControlMethod);\n\n/**\n * Destructor.\n */\nQtvrControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\n\nQtvrControlMethod.prototype._handleStart = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  if (!this._active) {\n    this._active = true;\n    this.emit('active');\n  }\n};\n\n\nQtvrControlMethod.prototype._handleMove = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  this._updateDynamics(e, false);\n};\n\n\nQtvrControlMethod.prototype._handleRelease = function(e) {\n  // Prevent event dragging other DOM elements and causing strange behavior on Chrome\n  e.preventDefault();\n\n  this._updateDynamics(e, true);\n\n  if (this._active) {\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\n\nvar tmpReleaseFriction = [ null, null ];\nQtvrControlMethod.prototype._updateDynamics = function(e, release) {\n  var elementRect = this._element.getBoundingClientRect();\n  var width = elementRect.right - elementRect.left;\n  var height = elementRect.bottom - elementRect.top;\n  var maxDim = Math.max(width, height);\n\n  var x = e.deltaX / maxDim * this._opts.speed;\n  var y = e.deltaY / maxDim * this._opts.speed;\n\n  this._dynamics.x.reset();\n  this._dynamics.y.reset();\n  this._dynamics.x.velocity = x;\n  this._dynamics.y.velocity = y;\n\n  if (release) {\n    maxFriction(this._opts.friction, this._dynamics.x.velocity, this._dynamics.y.velocity, this._opts.maxFrictionTime, tmpReleaseFriction);\n    this._dynamics.x.friction = tmpReleaseFriction[0];\n    this._dynamics.y.friction = tmpReleaseFriction[1];\n  }\n\n  this.emit('parameterDynamics', 'x', this._dynamics.x);\n  this.emit('parameterDynamics', 'y', this._dynamics.y);\n};\n\n\nmodule.exports = QtvrControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar defaults = require('../util/defaults');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOptions = {\n  frictionTime: 0.2,\n  zoomDelta: 0.001\n};\n\n/**\n * @class ScrollZoomControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Controls the fov/zoom through the mouse wheel.\n *\n * @param {Element} element Element to listen for events.\n * @param {Object} opts\n * @param {number} [opts.frictionTime=0.2]\n * @param {number} [opts.zoomDelta=0.001]\n */\nfunction ScrollZoomControlMethod(element, opts) {\n  this._element = element;\n  this._opts = defaults(opts || {}, defaultOptions);\n  this._dynamics = new Dynamics();\n  this._eventList = [];\n\n  var fn = this._opts.frictionTime ? this.withSmoothing : this.withoutSmoothing;\n  this._wheelListener = fn.bind(this);\n  \n  element.addEventListener('wheel', this._wheelListener);\n}\n\neventEmitter(ScrollZoomControlMethod);\n\n/**\n * Destructor.\n */\nScrollZoomControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener(this._wheelListener);\n  clearOwnProperties(this);\n};\n\n\nScrollZoomControlMethod.prototype.withoutSmoothing = function(e) {\n  this._dynamics.offset = wheelEventDelta(e) * this._opts.zoomDelta;\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  e.preventDefault();\n\n  this.emit('active');\n  this.emit('inactive');\n};\n\n\nScrollZoomControlMethod.prototype.withSmoothing = function(e) {\n  var currentTime = e.timeStamp;\n\n  // Record event.\n  this._eventList.push(e);\n\n  // Remove events whose smoothing has already expired.\n  while (this._eventList[0].timeStamp < currentTime - this._opts.frictionTime*1000) {\n    this._eventList.shift(0);\n  }\n\n  // Get the current velocity from the recorded events.\n  // Each wheel movement causes a velocity of change/frictionTime during frictionTime.\n  var velocity = 0;\n  for (var i = 0; i < this._eventList.length; i++) {\n    var zoomChangeFromEvent = wheelEventDelta(this._eventList[i]) * this._opts.zoomDelta;\n    velocity += zoomChangeFromEvent / this._opts.frictionTime;\n  }\n\n  this._dynamics.velocity = velocity;\n  this._dynamics.friction = Math.abs(velocity) / this._opts.frictionTime;\n\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  e.preventDefault();\n\n  this.emit('active');\n  this.emit('inactive');\n};\n\n\nfunction wheelEventDelta(e) {\n  var multiplier = e.deltaMode == 1 ? 20 : 1;\n  return e.deltaY * multiplier;\n}\n\n\nmodule.exports = ScrollZoomControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar HammerGestures = require('./HammerGestures');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class PinchZoomControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Control the view fov/zoom by pinching with two fingers.\n *\n * @param {Element} element Element to listen for events.\n * @param {string} pointerType Which Hammer.js pointer type to use\n * @param {Object} opts\n */\nfunction PinchZoomControlMethod(element, pointerType, opts) {\n  this._hammer = HammerGestures.get(element, pointerType);\n\n  this._lastEvent = null;\n\n  this._active = false;\n\n  this._dynamics = new Dynamics();\n\n  this._hammer.on('pinchstart', this._handleStart.bind(this));\n  this._hammer.on('pinch', this._handleEvent.bind(this));\n  this._hammer.on('pinchend', this._handleEnd.bind(this));\n  this._hammer.on('pinchcancel', this._handleEnd.bind(this));\n}\n\neventEmitter(PinchZoomControlMethod);\n\n/**\n * Destructor.\n */\nPinchZoomControlMethod.prototype.destroy = function() {\n  this._hammer.release();\n  clearOwnProperties(this);\n};\n\n\nPinchZoomControlMethod.prototype._handleStart = function() {\n  if (!this._active) {\n    this._active = true;\n    this.emit('active');\n  }\n};\n\n\nPinchZoomControlMethod.prototype._handleEnd = function() {\n  this._lastEvent = null;\n\n  if (this._active) {\n    this._active = false;\n    this.emit('inactive');\n  }\n};\n\n\nPinchZoomControlMethod.prototype._handleEvent = function(e) {\n  var scale = e.scale;\n\n  if (this._lastEvent) {\n    scale /= this._lastEvent.scale;\n  }\n\n  this._dynamics.offset = (scale - 1) * -1;\n  this.emit('parameterDynamics', 'zoom', this._dynamics);\n\n  this._lastEvent = e;\n};\n\n\nmodule.exports = PinchZoomControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class VelocityControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter.\n *\n * The user should emit 'active' and 'inactive' events if required.\n *\n * @param {String} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n*/\nfunction VelocityControlMethod(parameter) {\n  if(!parameter) {\n    throw new Error(\"VelocityControlMethod: parameter must be defined\");\n  }\n\n  this._parameter = parameter;\n  this._dynamics = new Dynamics();\n}\neventEmitter(VelocityControlMethod);\n\n/**\n * Destructor.\n */\nVelocityControlMethod.prototype.destroy = function() {\n  clearOwnProperties(this);\n};\n\n/**\n * Set the parameter's velocity.\n * @param {Number} velocity\n */\nVelocityControlMethod.prototype.setVelocity = function(velocity) {\n  this._dynamics.velocity = velocity;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n};\n\n/**\n * Set the parameter's friction.\n * @param {Number} friction\n */\nVelocityControlMethod.prototype.setFriction = function(friction) {\n  this._dynamics.friction = friction;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n};\n\nmodule.exports = VelocityControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class ElementPressControlMethod\n * @implements ControlMethod\n * @classdesc\n *\n * Sets the velocity and friction of a single parameter by pressing and\n * unpressing a DOM element.\n *\n * @param {Element} element Element which activates the method when pressed\n * @param {string} parameter The parameter to be controlled (e.g. `x`, `y` or `zoom`)\n * @param {number} velocity Velocity at which the parameter changes. Use a\n * negative number for opposite direction\n * @param {number} friction Friction at which the parameter stops\n*/\nfunction ElementPressControlMethod(element, parameter, velocity, friction) {\n  if(!element) {\n    throw new Error(\"ElementPressControlMethod: element must be defined\");\n  }\n  if(!parameter) {\n    throw new Error(\"ElementPressControlMethod: parameter must be defined\");\n  }\n  if(!velocity) {\n    throw new Error(\"ElementPressControlMethod: velocity must be defined\");\n  }\n  if(!friction) {\n    throw new Error(\"ElementPressControlMethod: friction must be defined\");\n  }\n\n  this._element = element;\n\n  this._pressHandler = this._handlePress.bind(this);\n  this._releaseHandler = this._handleRelease.bind(this);\n\n  element.addEventListener('mousedown', this._pressHandler);\n  element.addEventListener('mouseup', this._releaseHandler);\n  element.addEventListener('mouseleave', this._releaseHandler);\n  element.addEventListener('touchstart', this._pressHandler);\n  element.addEventListener('touchmove', this._releaseHandler);\n  element.addEventListener('touchend', this._releaseHandler);\n\n  this._parameter = parameter;\n  this._velocity = velocity;\n  this._friction = friction;\n  this._dynamics = new Dynamics();\n\n  this._pressing = false;\n}\neventEmitter(ElementPressControlMethod);\n\n/**\n * Destructor.\n */\nElementPressControlMethod.prototype.destroy = function() {\n  this._element.removeEventListener('mousedown', this._pressHandler);\n  this._element.removeEventListener('mouseup', this._releaseHandler);\n  this._element.removeEventListener('mouseleave', this._releaseHandler);\n  this._element.removeEventListener('touchstart', this._pressHandler);\n  this._element.removeEventListener('touchmove', this._releaseHandler);\n  this._element.removeEventListener('touchend', this._releaseHandler);\n  clearOwnProperties(this);\n};\n\nElementPressControlMethod.prototype._handlePress = function() {\n  this._pressing = true;\n\n  this._dynamics.velocity = this._velocity;\n  this._dynamics.friction = 0;\n  this.emit('parameterDynamics', this._parameter, this._dynamics);\n  this.emit('active');\n};\n\nElementPressControlMethod.prototype._handleRelease = function() {\n  if(this._pressing) {\n    this._dynamics.friction = this._friction;\n    this.emit('parameterDynamics', this._parameter, this._dynamics);\n    this.emit('inactive');\n  }\n\n  this._pressing = false;\n};\n\nmodule.exports = ElementPressControlMethod;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Dynamics = require('./Dynamics');\nvar now = require('../util/now');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\n/**\n * @class ControlComposer\n * @classdesc\n *\n * Combines changes in parameters triggered by multiple {@link ControlMethod}\n * instances.\n *\n * @listens ControlMethod#parameterDynamics\n */\nfunction ControlComposer(opts) {\n  opts = opts || {};\n\n  this._methods = [];\n\n  this._parameters = [ 'x' ,'y', 'axisScaledX', 'axisScaledY', 'zoom', 'yaw', 'pitch', 'roll' ];\n\n  this._now = opts.nowForTesting || now;\n\n  this._composedOffsets = { };\n\n  this._composeReturn = { offsets: this._composedOffsets, changing: null };\n}\n\neventEmitter(ControlComposer);\n\n\nControlComposer.prototype.add = function(instance) {\n  if (this.has(instance)) {\n    return;\n  }\n\n  var dynamics = {};\n  this._parameters.forEach(function(parameter) {\n    dynamics[parameter] = {\n      dynamics: new Dynamics(),\n      time: null\n    };\n  });\n\n  var parameterDynamicsHandler = this._updateDynamics.bind(this, dynamics);\n\n  var method = {\n    instance: instance,\n    dynamics: dynamics,\n    parameterDynamicsHandler: parameterDynamicsHandler\n  };\n\n  instance.addEventListener('parameterDynamics', parameterDynamicsHandler);\n\n  this._methods.push(method);\n};\n\n\nControlComposer.prototype.remove = function(instance) {\n  var index = this._indexOfInstance(instance);\n  if (index >= 0) {\n    var method = this._methods.splice(index, 1)[0];\n    method.instance.removeEventListener('parameterDynamics', method.parameterDynamicsHandler);\n  }\n};\n\n\nControlComposer.prototype.has = function(instance) {\n  return this._indexOfInstance(instance) >= 0;\n};\n\n\nControlComposer.prototype._indexOfInstance = function(instance) {\n  for (var i = 0; i < this._methods.length; i++) {\n    if (this._methods[i].instance === instance) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\nControlComposer.prototype.list = function() {\n  var instances = [];\n  for (var i = 0; i < this._methods.length; i++) {\n    instances.push(this._methods[i].instance);\n  }\n  return instances;\n};\n\n\nControlComposer.prototype._updateDynamics = function(storedDynamics, parameter, dynamics) {\n  var parameterDynamics = storedDynamics[parameter];\n\n  if (!parameterDynamics) {\n    throw new Error(\"Unknown control parameter \" + parameter);\n  }\n\n  var newTime = this._now();\n  parameterDynamics.dynamics.update(dynamics, (newTime - parameterDynamics.time)/1000);\n  parameterDynamics.time = newTime;\n\n  this.emit('change');\n};\n\n\nControlComposer.prototype._resetComposedOffsets = function() {\n  for (var i = 0; i < this._parameters.length; i++) {\n    this._composedOffsets[this._parameters[i]] = 0;\n  }\n};\n\n\nControlComposer.prototype.offsets = function() {\n  var parameter;\n  var changing = false;\n\n  var currentTime = this._now();\n\n  this._resetComposedOffsets();\n\n  for (var i = 0; i < this._methods.length; i++) {\n    var methodDynamics = this._methods[i].dynamics;\n\n    for (var p = 0; p < this._parameters.length; p++) {\n      parameter = this._parameters[p];\n      var parameterDynamics = methodDynamics[parameter];\n      var dynamics = parameterDynamics.dynamics;\n\n\n      // Add offset to composed offset\n      if (dynamics.offset != null) {\n        this._composedOffsets[parameter] += dynamics.offset;\n        // Reset offset\n        dynamics.offset = null;\n      }\n\n      // Calculate offset from velocity and add it\n      var elapsed = (currentTime - parameterDynamics.time)/1000;\n      var offsetFromVelocity = dynamics.offsetFromVelocity(elapsed);\n\n      if(offsetFromVelocity) {\n        this._composedOffsets[parameter] += offsetFromVelocity;\n      }\n\n      // Update velocity on dynamics\n      var currentVelocity = dynamics.velocityAfter(elapsed);\n      dynamics.velocity = currentVelocity;\n\n      // If there is still a velocity, set changing\n      if(currentVelocity) {\n        changing = true;\n      }\n\n      parameterDynamics.time = currentTime;\n    }\n  }\n\n  this._composeReturn.changing = changing;\n  return this._composeReturn;\n};\n\n\nControlComposer.prototype.destroy = function() {\n  var instances = this.list();\n  for (var i = 0; i < instances.length; i++) {\n    this.remove(instances[i]);\n  }\n\n  clearOwnProperties(this);\n};\n\n\nmodule.exports = ControlComposer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Composer = require('./Composer');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar debug = typeof MARZIPANODEBUG !== 'undefined' && MARZIPANODEBUG.controls;\n\n/**\n * @class Controls\n * @classdesc\n *\n * Set of controls which affect a view (e.g. keyboard, touch)\n *\n * {@link ControlMethod} instances can be registered on this class. The methods\n * are then combined to calculate the final parameters to change the {@link View}.\n *\n * Controls is attached to a {@link RenderLoop}. Currently it affects the\n * {@link view} of all {@link Layer} on the {@link Stage} of the\n * {@link RenderLoop} it is attached to. A more flexible API may be provided\n * in the future.\n *\n * The ControlMethod instances are registered with an id and may be enabled,\n * disabled and unregistered using that id. The whole Control can also be\n * enabled or disabled.\n *\n */\nfunction Controls(opts) {\n  opts = opts || {};\n\n  this._methods = {};\n  this._methodGroups = {};\n  this._composer = new Composer();\n\n  // Whether the controls are enabled.\n  this._enabled = (opts && opts.enabled) ? !!opts.enabled : true;\n\n  // How many control methods are enabled and in the active state.\n  this._activeCount = 0;\n\n  this.updatedViews_ = [];\n\n  this._attachedRenderLoop = null;\n}\n\neventEmitter(Controls);\n\n/**\n * Destructor.\n */\nControls.prototype.destroy = function() {\n  this.detach();\n  this._composer.destroy();\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {ControlMethod[]} List of registered @{link ControlMethod instances}\n */\nControls.prototype.methods = function() {\n  var obj = {};\n  for (var id in this._methods) {\n    obj[id] = this._methods[id];\n  }\n  return obj;\n};\n\n/**\n * @param {String} id\n * @return {ControlMethod}\n */\nControls.prototype.method = function(id) {\n  return this._methods[id];\n};\n\n/**\n * @param {String} id\n * @param {ControlMethod} instance\n * @param {Boolean} [enable=false]\n */\nControls.prototype.registerMethod = function(id, instance, enable) {\n  if (this._methods[id]) {\n    throw new Error('Control method already registered with id ' + id);\n  }\n\n  this._methods[id] = {\n    instance: instance,\n    enabled: false,\n    active: false,\n    activeHandler: this._handleActive.bind(this, id),\n    inactiveHandler: this._handleInactive.bind(this, id)\n  };\n\n  if(enable) {\n    this.enableMethod(id, instance);\n  }\n};\n\n\n/**\n * @param {String} id\n */\nControls.prototype.unregisterMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (method.enabled) {\n    this.disableMethod(id);\n  }\n  delete this._methods[id];\n};\n\n/**\n * @param {String} id\n */\nControls.prototype.enableMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (method.enabled) {\n    return;\n  }\n  method.enabled = true;\n  if (method.active) {\n    this._incrementActiveCount();\n  }\n  this._listen(id);\n  this._updateComposer();\n  this.emit('methodEnabled', id);\n};\n\n\n/**\n * @param {String} id\n */\nControls.prototype.disableMethod = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('No control method registered with id ' + id);\n  }\n  if (!method.enabled) {\n    return;\n  }\n  method.enabled = false;\n  if (method.active) {\n    this._decrementActiveCount();\n  }\n  this._unlisten(id);\n  this._updateComposer();\n  this.emit('methodDisabled', id);\n};\n\n\n/**\n * Create a method group, which can be used to more conveniently enable or\n * disable several control methods at once\n * @param {String} groupId\n * @param {String[]} methodIds\n */\nControls.prototype.addMethodGroup = function(groupId, methodIds) {\n  this._methodGroups[groupId] = methodIds;\n}\n\n/**\n * @param {String} groupId\n */\nControls.prototype.removeMethodGroup = function(id) {\n  delete this._methodGroups[id];\n}\n\n/**\n * @return {ControlMethodGroup[]} List of control method groups\n */\nControls.prototype.methodGroups = function() {\n  var obj = {};\n  for (var id in this._methodGroups) {\n    obj[id] = this._methodGroups[id];\n  }\n  return obj;\n}\n\n/**\n * Enables all the control methods in the group\n * @param {String} groupId\n */\nControls.prototype.enableMethodGroup = function(id) {\n  var self = this;\n  self._methodGroups[id].forEach(function(methodId) {\n    self.enableMethod(methodId);\n  });\n}\n\n/**\n * Disables all the control methods in the group\n * @param {String} groupId\n */\nControls.prototype.disableMethodGroup = function(id) {\n  var self = this;\n  self._methodGroups[id].forEach(function(methodId) {\n    self.disableMethod(methodId);\n  });\n}\n\n/**\n * @returns {Boolean}\n */\nControls.prototype.enabled = function() {\n  return this._enabled;\n};\n\n/**\n * Enables the controls\n */\nControls.prototype.enable = function() {\n  if (this._enabled) {\n    return;\n  }\n  this._enabled = true;\n  if (this._activeCount > 0) {\n    this.emit('active');\n  }\n  this.emit('enabled');\n  this._updateComposer();\n};\n\n\n/**\n * Disables the controls\n */\nControls.prototype.disable = function() {\n  if (!this._enabled) {\n    return;\n  }\n  this._enabled = false;\n  if (this._activeCount > 0) {\n    this.emit('inactive');\n  }\n  this.emit('disabled');\n  this._updateComposer();\n};\n\n\n\n/**\n * Attaches the controls to a {@link RenderLoop}. The RenderLoop will be woken\n * up when the controls are activated\n *\n * @param {RenderLoop}\n */\nControls.prototype.attach = function(renderLoop) {\n  if (this._attachedRenderLoop) {\n    this.detach();\n  }\n\n  this._attachedRenderLoop = renderLoop;\n  this._beforeRenderHandler = this._updateViewsWithControls.bind(this);\n  this._changeHandler = renderLoop.renderOnNextFrame.bind(renderLoop);\n\n  this._attachedRenderLoop.addEventListener('beforeRender', this._beforeRenderHandler);\n  this._composer.addEventListener('change', this._changeHandler);\n};\n\n/**\n * Detaches the controls\n */\nControls.prototype.detach = function() {\n  if (!this._attachedRenderLoop) {\n    return;\n  }\n\n  this._attachedRenderLoop.removeEventListener('beforeRender', this._beforeRenderHandler);\n  this._composer.removeEventListener('change', this._changeHandler);\n\n  this._beforeRenderHandler = null;\n  this._changeHandler = null;\n  this._attachedRenderLoop = null;\n};\n\n/**\n * @param {Boolean}\n */\nControls.prototype.attached = function() {\n  return this._attachedRenderLoop != null;\n};\n\n\nControls.prototype._listen = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  method.instance.addEventListener('active', method.activeHandler);\n  method.instance.addEventListener('inactive', method.inactiveHandler);\n};\n\n\nControls.prototype._unlisten = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  method.instance.removeEventListener('active', method.activeHandler);\n  method.instance.removeEventListener('inactive', method.inactiveHandler);\n};\n\n\nControls.prototype._handleActive = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  if (!method.enabled) {\n    throw new Error('Should not receive event from disabled control method');\n  }\n  if (!method.active) {\n    method.active = true;\n    this._incrementActiveCount();\n  }\n};\n\n\nControls.prototype._handleInactive = function(id) {\n  var method = this._methods[id];\n  if (!method) {\n    throw new Error('Bad method id');\n  }\n  if (!method.enabled) {\n    throw new Error('Should not receive event from disabled control method');\n  }\n  if (method.active) {\n    method.active = false;\n    this._decrementActiveCount();\n  }\n};\n\n\nControls.prototype._incrementActiveCount = function() {\n  this._activeCount++;\n  if (debug) {\n    this._checkActiveCount();\n  }\n  if (this._enabled && this._activeCount === 1) {\n    this.emit('active');\n  }\n};\n\n\nControls.prototype._decrementActiveCount = function() {\n  this._activeCount--;\n  if (debug) {\n    this._checkActiveCount();\n  }\n  if (this._enabled && this._activeCount === 0) {\n    this.emit('inactive');\n  }\n};\n\n\nControls.prototype._checkActiveCount = function() {\n  var count = 0;\n  for (var id in this._methods) {\n    var method = this._methods[id];\n    if (method.enabled && method.active) {\n      count++;\n    }\n  }\n  if (count != this._activeCount) {\n    throw new Error('Bad control state');\n  }\n};\n\n\nControls.prototype._updateComposer = function() {\n  var composer = this._composer;\n\n  for (var id in this._methods) {\n    var method = this._methods[id];\n    var enabled = this._enabled && method.enabled;\n\n    if (enabled && !composer.has(method.instance)) {\n      composer.add(method.instance);\n    }\n    if (!enabled && composer.has(method.instance)) {\n      composer.remove(method.instance);\n    }\n  }\n};\n\n\nControls.prototype._updateViewsWithControls = function() {\n  var controlData = this._composer.offsets();\n  if (controlData.changing) {\n    this._attachedRenderLoop.renderOnNextFrame();\n  }\n\n  // Update each view at most once, even when shared by multiple layers.\n  // The number of views is expected to be small, so use an array to keep track.\n  this.updatedViews_.length = 0;\n\n  var layers = this._attachedRenderLoop.stage().listLayers();\n  for (var i = 0; i < layers.length; i++) {\n    var view = layers[i].view();\n    if (this.updatedViews_.indexOf(view) < 0) {\n      layers[i].view().updateWithControlParameters(controlData.offsets);\n      this.updatedViews_.push(view);\n    }\n  }\n};\n\n\nmodule.exports = Controls;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar setTransform = require('./dom').setTransform;\nvar decimal = require('./decimal');\n\nfunction positionAbsolutely(element, x, y, extraTransforms) {\n  extraTransforms = extraTransforms || '';\n  // A translateZ(0) transform improves performance on Chrome by creating a\n  // new layer for the element, which prevents unnecessary repaints.\n  var transform = 'translateX(' + decimal(x) + 'px) translateY(' + decimal(y) + 'px) translateZ(0) ' + extraTransforms;\n  setTransform(element, transform);\n}\n\nmodule.exports = positionAbsolutely;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar positionAbsolutely = require('./util/positionAbsolutely');\nvar setTransform = require('./util/dom').setTransform;\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * @class Hotspot\n * @classdesc\n *\n * A Hotspot allows a DOM element to be placed at a fixed position in the\n * image. The position is updated automatically when the {@link View view}\n * changes.\n *\n * Positioning is performed with the `transform` CSS property when available,\n * falling back to the `position`, `left` and `top` properties when not.\n * In both cases, the top left corner of the element is placed in the requested\n * position; clients are expected to use additional children elements or other\n * CSS properties to achieve more sophisticated layouts.\n *\n * There are two kinds of hotspots: regular and embedded. A regular hotspot\n * does not change size depending on the zoom level. An embedded hotspot is\n * displayed at a fixed size relative to the panorama, always covering the\n * same portion of the image.\n *\n * Clients should call {@link HotspotContainer#createHotspot} instead of\n * invoking the constructor directly.\n *\n * @param {Element} domElement The DOM element.\n * @param {View} view The view.\n * @param {Object} coords The hotspot coordinates.\n *     Use {@link RectilinearViewCoords} for a {@link RectilinearView} or\n *     {@link FlatViewCoords} for a {@link FlatView}.\n * @param {Object} opts Additional options.\n * @param {Object} opts.perspective Perspective options for embedded hotspots.\n * @param {number} [opts.perspective.radius=null] If set, embed the hotspot\n *     into the image by transforming it into the surface of a sphere with this\n *     radius.\n * @param {string} [opts.perspective.extraTransforms=null] If set, append this\n *     value to the CSS `transform` property used to position the hotspot. This\n *     may be used to rotate an embedded hotspot.\n */\nfunction Hotspot(domElement, parentDomElement, view, coords, opts) {\n\n  opts = opts || {};\n  opts.perspective = opts.perspective || {};\n  opts.perspective.extraTransforms =\n      opts.perspective.extraTransforms != null ? opts.perspective.extraTransforms : \"\";\n\n  this._domElement = domElement;\n  this._parentDomElement = parentDomElement;\n  this._view = view;\n  this._coords = {};\n  this._perspective = {};\n\n  this.setPosition(coords);\n\n  // Add hotspot into the DOM.\n  this._parentDomElement.appendChild(this._domElement);\n\n  this.setPerspective(opts.perspective);\n\n  // Whether the hotspot is visible.\n  // The hotspot may still be hidden if it's inside a hidden HotspotContainer.\n  this._visible = true;\n\n  // The current calculated screen position.\n  this._position = { x: 0, y: 0 };\n}\n\neventEmitter(Hotspot);\n\n\n/**\n * Destructor.\n * Clients should call {@link HotspotContainer#destroyHotspot} instead.\n */\nHotspot.prototype.destroy = function() {\n  this._parentDomElement.removeChild(this._domElement);\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {Element}\n */\nHotspot.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * @return {Object}\n */\nHotspot.prototype.position = function() {\n  return this._coords;\n};\n\n\n/**\n * @param {Object} coords\n */\nHotspot.prototype.setPosition = function(coords) {\n  for (var key in coords) {\n    this._coords[key] = coords[key];\n  }\n  this._update();\n  // TODO: We should probably emit a hotspotsChange event on the parent\n  // HotspotContainer. What's the best way to do so?\n};\n\n\n/**\n * @return {Object}\n */\nHotspot.prototype.perspective = function() {\n  return this._perspective;\n};\n\n\n/**\n * @param {Object}\n */\nHotspot.prototype.setPerspective = function(perspective) {\n  for (var key in perspective) {\n    this._perspective[key] = perspective[key];\n  }\n  this._update();\n};\n\n\n/**\n * Show the hotspot\n */\nHotspot.prototype.show = function() {\n  if (!this._visible) {\n    this._visible = true;\n    this._update();\n  }\n};\n\n\n/**\n * Hide the hotspot\n */\nHotspot.prototype.hide = function() {\n  if (this._visible) {\n    this._visible = false;\n    this._update();\n  }\n};\n\n\nHotspot.prototype._update = function() {\n  var element = this._domElement;\n\n  var params = this._coords;\n  var position = this._position;\n  var x, y;\n\n  var isVisible = false;\n\n  if (this._visible) {\n    var view = this._view;\n\n    if (this._perspective.radius) {\n      // Hotspots that are embedded in the panorama may be visible even when\n      // positioned behind the camera.\n      isVisible = true;\n      this._setEmbeddedPosition(view, params);\n    } else {\n      // Regular hotspots are only visible when positioned in front of the\n      // camera. Note that they may be partially visible when positioned outside\n      // the viewport.\n      view.coordinatesToScreen(params, position);\n      x = position.x;\n      y = position.y;\n\n      if (x != null && y != null) {\n        isVisible = true;\n        this._setPosition(x, y);\n      }\n    }\n  }\n\n  // Show if visible, hide if not.\n  if (isVisible) {\n    element.style.display = 'block';\n    element.style.position = 'absolute';\n  }\n  else {\n    element.style.display = 'none';\n    element.style.position = '';\n  }\n\n};\n\n\nHotspot.prototype._setEmbeddedPosition = function(view, params) {\n  var transform = view.coordinatesToPerspectiveTransform(\n      params, this._perspective.radius, this._perspective.extraTransforms);\n  setTransform(this._domElement, transform);\n};\n\n\nHotspot.prototype._setPosition = function(x, y) {\n  positionAbsolutely(this._domElement, x, y, this._perspective.extraTransforms);\n};\n\n\nmodule.exports = Hotspot;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar Hotspot = require('./Hotspot');\nvar calcRect = require('./util/calcRect');\nvar positionAbsolutely = require('./util/positionAbsolutely');\nvar setAbsolute = require('./util/dom').setAbsolute;\nvar setOverflowHidden = require('./util/dom').setOverflowHidden;\nvar setOverflowVisible = require('./util/dom').setOverflowVisible;\nvar setNullSize = require('./util/dom').setNullSize;\nvar setPixelSize = require('./util/dom').setPixelSize;\nvar setPointerEvents = require('./util/dom').setWithVendorPrefix('pointer-events');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that a hotspot has been created or destroyed on the container.\n * @event HotspotContainer#hotspotsChange\n */\n\n/**\n * @class HotspotContainer\n * @classdesc\n *\n * Creates a DOM element to hold {@link Hotspot hotspots} and updates their\n * position when necessary.\n *\n * @param {Element} parentDomElement The DOM element inside which the container\n *     should be created.\n * @param {Stage} stage The underlying stage.\n * @param {View} view The view according to which the hotspots are positioned.\n * @param {RenderLoop} renderLoop The render loop indicating when the hotspots\n *     must be rendered.\n * @param {Object} opts\n * @param {RectSpec} opts.rect Rectangular region covered by the container. See\n *    {@link Effects#rect}.\n */\nfunction HotspotContainer(parentDomElement, stage, view, renderLoop, opts) {\n  opts = opts || {};\n\n  this._parentDomElement = parentDomElement;\n  this._stage = stage;\n  this._view = view;\n  this._renderLoop = renderLoop;\n\n  // Hotspot list.\n  this._hotspots = [];\n\n  // Whether the hotspot container should be visible.\n  this._visible = true;\n\n  // The current rect.\n  this._rect = opts.rect;\n\n  // Whether the visibility or the rect have changed since the last DOM update.\n  this._visibilityOrRectChanged = true;\n\n  // The last seen stage dimensions.\n  this._stageWidth = null;\n  this._stageHeight = null;\n\n  // Temporary variable to hold the calculated position and size.\n  this._tmpRect = {};\n\n  // Wrapper element. When the rect effect is set, the wrapper will have nonzero\n  // dimensions and `pointer-events: none` so that hotspots outside the rect are\n  // hidden, but no mouse events are hijacked.\n  this._hotspotContainerWrapper = document.createElement('div');\n  setAbsolute(this._hotspotContainerWrapper);\n  setPointerEvents(this._hotspotContainerWrapper, 'none');\n  this._parentDomElement.appendChild(this._hotspotContainerWrapper);\n\n  // Hotspot container element. It has zero dimensions and `pointer-events: all`\n  // to override the `pointer-events: none` on the wrapper and allow hotspots to\n  // be interacted with.\n  this._hotspotContainer = document.createElement('div');\n  setAbsolute(this._hotspotContainer);\n  setPointerEvents(this._hotspotContainer, 'all');\n  this._hotspotContainerWrapper.appendChild(this._hotspotContainer);\n\n  // Update when the hotspots change or scene is re-rendered.\n  this._updateHandler = this._update.bind(this);\n  this._renderLoop.addEventListener('afterRender', this._updateHandler);\n}\n\neventEmitter(HotspotContainer);\n\n\n/**\n * Destructor.\n */\nHotspotContainer.prototype.destroy = function() {\n  while (this._hotspots.length) {\n    this.destroyHotspot(this._hotspots[0]);\n  }\n\n  this._parentDomElement.removeChild(this._hotspotContainerWrapper);\n\n  this._renderLoop.removeEventListener('afterRender', this._updateHandler);\n\n  clearOwnProperties(this);\n};\n\n\n/**\n * @return {Element}\n */\nHotspotContainer.prototype.domElement = function() {\n  return this._hotspotContainer;\n};\n\n\n/**\n * @param {Rect} rect\n */\nHotspotContainer.prototype.setRect = function(rect) {\n  this._rect = rect;\n  this._visibilityOrRectChanged = true;\n};\n\n\n/**\n * @return {Rect}\n */\nHotspotContainer.prototype.rect = function() {\n  return this._rect;\n};\n\n\n/**\n * Creates a new hotspot in this container.\n *\n * @param {Element} domElement DOM element to use for the hotspot\n * @param {Object} coords The hotspot coordinates.\n *     Use {@link RectilinearViewCoords}` for a {@link RectilinearView} or\n *     {@link FlatViewCoords} for a {@link FlatView}.\n * @param {Object} opts Options in the same format as the `opts` argument to\n *     the {@link Hotspot} constructor.\n * @return {Hotspot}\n */\nHotspotContainer.prototype.createHotspot = function(domElement, coords, opts) {\n  coords = coords || {};\n\n  var hotspot = new Hotspot(\n      domElement, this._hotspotContainer, this._view, coords, opts);\n  this._hotspots.push(hotspot);\n  hotspot._update();\n\n  this.emit('hotspotsChange');\n\n  return hotspot;\n};\n\n\n/**\n * @param {Hotspot} hotspot\n * @return {boolean}\n */\nHotspotContainer.prototype.hasHotspot = function(hotspot) {\n  return this._hotspots.indexOf(hotspot) >= 0;\n};\n\n\n/**\n * @return {Hotspot[]}\n */\nHotspotContainer.prototype.listHotspots = function() {\n  return [].concat(this._hotspots);\n};\n\n\n/**\n * Removes a hotspot from the container.\n *\n * @param {Hotspot} hotspot\n */\nHotspotContainer.prototype.destroyHotspot = function(hotspot) {\n  var i = this._hotspots.indexOf(hotspot);\n  if (i < 0) {\n    throw new Error('No such hotspot');\n  }\n  this._hotspots.splice(i, 1);\n\n  hotspot.destroy();\n  this.emit('hotspotsChange');\n};\n\n\n/**\n * Hide the container's DOM element, causing every contained {@link Hotspot} to\n * be hidden.\n */\nHotspotContainer.prototype.hide = function() {\n  if (this._visible) {\n    this._visible = false;\n    this._visibilityOrRectChanged = true;\n    this._update();\n  }\n};\n\n\n/**\n * Show the container's DOM element, causing every contained {@link Hotspot} to\n * be shown.\n */\nHotspotContainer.prototype.show = function() {\n  if (!this._visible) {\n    this._visible = true;\n    this._visibilityOrRectChanged = true;\n    this._update();\n  }\n};\n\n\nHotspotContainer.prototype._update = function() {\n  var wrapper = this._hotspotContainerWrapper;\n  var width = this._stage.width();\n  var height = this._stage.height();\n  var tmpRect = this._tmpRect;\n\n  // Avoid updating the wrapper DOM unless necessary.\n  if (this._visibilityOrRectChanged ||\n      (this._rect && (width !== this._stageWidth || height !== this._stageHeight))) {\n    var visible = this._visible;\n    wrapper.style.display = visible ? 'block' : 'none';\n\n    if (visible) {\n      if (this._rect) {\n        calcRect(width, height, this._rect, tmpRect);\n        positionAbsolutely(wrapper, width * tmpRect.x, height * tmpRect.y);\n        setPixelSize(wrapper, width * tmpRect.width, height * tmpRect.height);\n        setOverflowHidden(wrapper);\n      } else {\n        positionAbsolutely(wrapper, 0, 0);\n        setNullSize(wrapper);\n        setOverflowVisible(wrapper);\n      }\n    }\n\n    this._stageWidth = width;\n    this._stageHeight = height;\n    this._visibilityOrRectChanged = false;\n  }\n\n  // Update hotspots unconditionally, as the view parameters may have changed.\n  for (var i = 0; i < this._hotspots.length; i++) {\n    this._hotspots[i]._update();\n  }\n};\n\n\nmodule.exports = HotspotContainer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar Layer = require('./Layer');\nvar TextureStore = require('./TextureStore');\nvar HotspotContainer = require('./HotspotContainer');\nvar eventEmitter = require('minimal-event-emitter');\nvar now = require('./util/now');\nvar noop = require('./util/noop');\nvar type = require('./util/type');\nvar defaults = require('./util/defaults');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the scene's view has changed. See {@link View#event:change}.\n * @event Scene#viewChange\n */\n\n/**\n * Signals that the scene's layers have changed.\n * @event Scene#layerChange\n */\n\n/**\n * @class Scene\n * @classdesc\n *\n * A Scene is a stack of {@link Layer layers} sharing the same {@link View view}\n * and {@link HotspotContainer hotspot container}. It belongs to the\n * {@link Viewer viewer} inside which it is displayed.\n *\n * Clients should call {@link Viewer#createScene} instead of invoking the\n * constructor directly.\n *\n * @param {Viewer} viewer The viewer this scene belongs to.\n * @param {View} view The scene's underlying view.\n */\nfunction Scene(viewer, view) {\n  this._viewer = viewer;\n  this._view = view;\n  this._layers = [];\n\n  // Hotspot container. Assume it occupies a full rect.\n  this._hotspotContainer = new HotspotContainer(\n    viewer._controlContainer,\n    viewer.stage(),\n    this._view,\n    viewer.renderLoop());\n\n  // The current movement.\n  this._movement = null;\n  this._movementStartTime = null;\n  this._movementStep = null;\n  this._movementParams = null;\n  this._movementCallback = null;\n\n  // Event listener for updating the view according to the current movement.\n  // The listener is set/unset on the render loop when a movement starts/stops.\n  this._updateMovementHandler = this._updateMovement.bind(this);\n\n  // Show or hide hotspots when scene changes.\n  this._updateHotspotContainerHandler = this._updateHotspotContainer.bind(this);\n  this._viewer.addEventListener('sceneChange', this._updateHotspotContainerHandler);\n\n  // Emit event when view changes.\n  this._viewChangeHandler = this.emit.bind(this, 'viewChange');\n  this._view.addEventListener('change', this._viewChangeHandler);\n\n  // Update the hotspot container.\n  this._updateHotspotContainer();\n}\n\neventEmitter(Scene);\n\n\n/**\n * Destructor. Clients should call {@link Viewer#destroyScene} instead.\n */\nScene.prototype.destroy = function() {\n  this._view.removeEventListener('change', this._viewChangeHandler);\n  this._viewer.removeEventListener('sceneChange', this._updateHotspotContainerHandler);\n\n  if (this._movement) {\n    this.stopMovement();\n  }\n\n  this._hotspotContainer.destroy();\n\n  this.destroyAllLayers();\n\n  clearOwnProperties(this);\n};\n\n\n\n/**\n * Returns the {@link HotspotContainer hotspot container} for the scene.\n * @return {Layer}\n */\nScene.prototype.hotspotContainer = function() {\n  return this._hotspotContainer;\n};\n\n/**\n * Returns the first of the {@link Layer layers} belonging to the scene, or\n * null if the scene has no layers.\n *\n * This method is equivalent to `Scene#listLayers[0]`. It may be removed in the\n * future.\n *\n * @return {Layer}\n */\nScene.prototype.layer = function() {\n  return this._layers[0];\n};\n\n/**\n* Returns a list of all {@link Layer layers} belonging to the scene. The\n* returned list is in display order, background to foreground.\n* @return {Layer[]}\n */\nScene.prototype.listLayers = function() {\n  return [].concat(this._layers);\n};\n\n\n/**\n * Returns the scene's underlying {@link View view}.\n * @return {View}\n */\nScene.prototype.view = function() {\n  return this._view;\n};\n\n\n/**\n * Returns the {@link Viewer viewer} the scene belongs to.\n * @return {Viewer}\n */\nScene.prototype.viewer = function() {\n  return this._viewer;\n};\n\n\n/**\n * Returns whether the scene is currently visible.\n * @return {boolean}\n */\nScene.prototype.visible = function() {\n  return this._viewer.scene() === this;\n};\n\n\n/**\n * Creates a new {@link Layer layer} and adds it into the scene in the\n * foreground position.\n *\n * @param {Object} opts Layer creation options.\n * @param {Source} opts.source The layer's underlying {@link Source}.\n * @param {Source} opts.geometry The layer's underlying {@link Geometry}.\n * @param {boolean} [opts.pinFirstLevel=false] Whether to pin the first level to\n *     provide a fallback of last resort, at the cost of memory consumption.\n * @param {Object} [opts.textureStoreOpts={}] Options to pass to the\n *     {@link TextureStore} constructor.\n * @param {Object} [opts.layerOpts={}] Options to pass to the {@link Layer}\n *     constructor.\n * @return {Layer}\n */\nScene.prototype.createLayer = function(opts) {\n  opts = opts || {};\n\n  var textureStoreOpts = opts.textureStoreOpts || {};\n  var layerOpts = opts.layerOpts || {};\n\n  var source = opts.source;\n  var geometry = opts.geometry;\n  var view = this._view;\n  var stage = this._viewer.stage();\n  var textureStore = new TextureStore(source, stage, textureStoreOpts);\n  var layer = new Layer(source, geometry, view, textureStore, layerOpts);\n\n  this._layers.push(layer);\n\n  if (opts.pinFirstLevel) {\n    layer.pinFirstLevel();\n  }\n\n  // Signal that the layers have changed.\n  this.emit('layerChange');\n\n  return layer;\n};\n\n\n/**\n * Destroys a {@link Layer layer} and removes it from the scene.\n * @param {Layer} layer\n * @throws An error if the layer does not belong to the scene.\n */\nScene.prototype.destroyLayer = function(layer) {\n  var i = this._layers.indexOf(layer);\n  if (i < 0) {\n    throw new Error('No such layer in scene');\n  }\n\n  this._layers.splice(i, 1);\n\n  // Signal that the layers have changed.\n  this.emit('layerChange');\n\n  layer.textureStore().destroy();\n  layer.destroy();\n};\n\n\n/**\n * Destroys all {@link Layer layers} and removes them from the scene.\n */\nScene.prototype.destroyAllLayers = function() {\n  while (this._layers.length > 0) {\n    this.destroyLayer(this._layers[0]);\n  }\n};\n\n\n/**\n * Switches to the scene.\n *\n * This is equivalent to calling {@link Viewer#switchScene} on this scene.\n *\n * @param {Object} opts Options to pass into {@link Viewer#switchScene}.\n * @param {function} done Function to call when the switch is complete.\n */\nScene.prototype.switchTo = function(opts, done) {\n  return this._viewer.switchScene(this, opts, done);\n};\n\n\n/**\n * Tweens the scene's underlying {@link View view}.\n *\n * @param {Object} params Target view parameters.\n * @param {Object} opts Transition options.\n * @param {function} [opts.ease=easeInOutQuad] Tween easing function\n * @param {number} [opts.controlsInterrupt=false] allow controls to interrupt\n *     an ongoing tween.\n * @param {number} [opts.transitionDuration=1000] Tween duration, in\n *     milliseconds.\n * @param {number} [opts.closest=true] Whether to tween through the shortest\n *    path between the initial and final view parameters. This requires\n *    {@link View#normalizeToClosest} to be implemented, and does nothing\n *    otherwise.\n * @param {function} done Function to call when the tween finishes or is\n *    interrupted.\n */\nScene.prototype.lookTo = function(params, opts, done) {\n  opts = opts || {};\n  done = done || noop;\n\n  if (type(params) !== 'object') {\n    throw new Error(\"Target view parameters must be an object\");\n  }\n\n  // Quadratic in/out easing.\n  var easeInOutQuad = function (k) {\n    if ((k *= 2) < 1) {\n      return 0.5 * k * k;\n    }\n    return -0.5 * (--k * (k - 2) - 1);\n  };\n\n  var ease = opts.ease != null ? opts.ease : easeInOutQuad;\n  var controlsInterrupt = opts.controlsInterrupt != null ? opts.controlsInterrupt : false;\n  var duration = opts.transitionDuration != null ? opts.transitionDuration : 1000;\n  var shortest = opts.shortest != null ? opts.shortest : true;\n\n  var view = this._view;\n\n  var initialParams = view.parameters();\n\n  var finalParams = {};\n  defaults(finalParams, params);\n  defaults(finalParams, initialParams);\n\n  // Tween through the shortest path if requested.\n  // The view must implement the normalizeToClosest() method.\n  if (shortest && view.normalizeToClosest) {\n    view.normalizeToClosest(finalParams, finalParams);\n  }\n\n  var movement = function() {\n\n    var finalUpdate = false;\n\n    return function(params, elapsed) {\n\n      if (elapsed >= duration && finalUpdate) {\n        return null;\n      }\n\n      var delta = Math.min(elapsed / duration, 1);\n\n      for (var param in params) {\n        var start = initialParams[param];\n        var end = finalParams[param];\n        params[param] = start + ease(delta) * (end - start);\n      }\n\n      finalUpdate = elapsed >= duration;\n\n      return params;\n\n    };\n  };\n\n  var reenableControls = this._viewer.controls().enabled();\n\n  if (!controlsInterrupt) {\n    this._viewer.controls().disable();\n  }\n\n  this.startMovement(movement, function() {\n    if (reenableControls) {\n      this._viewer.controls().enable();\n    }\n    done();\n  });\n\n};\n\n\n/**\n * Starts a movement, possibly replacing the current movement.\n *\n * @param {function} fn The movement function.\n * @param {function} done Function to be called when the movement finishes or is\n *     interrupted.\n */\nScene.prototype.startMovement = function(fn, done) {\n\n  var renderLoop = this._viewer.renderLoop();\n\n  if (this._movement) {\n    this.stopMovement();\n  }\n\n  var step = fn();\n  if (typeof step !== 'function') {\n    throw new Error('Bad movement');\n  }\n\n  this._movement = fn;\n  this._movementStep = step;\n  this._movementStartTime = now();\n  this._movementParams = {};\n  this._movementCallback = done;\n\n  renderLoop.addEventListener('beforeRender', this._updateMovementHandler);\n  renderLoop.renderOnNextFrame();\n};\n\n\n/**\n * Stops the current movement.\n */\nScene.prototype.stopMovement = function() {\n\n  var renderLoop = this._viewer.renderLoop();\n\n  if (!this._movement) {\n    return;\n  }\n\n  if (this._movementCallback) {\n    this._movementCallback();\n  }\n\n  renderLoop.removeEventListener('beforeRender', this._updateMovementHandler);\n\n  this._movement = null;\n  this._movementStep = null;\n  this._movementStartTime = null;\n  this._movementParams = null;\n  this._movementCallback = null;\n};\n\n\n/**\n * Returns the current movement.\n * @return {function}\n */\nScene.prototype.movement = function() {\n  return this._movement;\n};\n\n\nScene.prototype._updateMovement = function() {\n\n  if (!this._movement) {\n    throw new Error('Should not call update');\n  }\n\n  var renderLoop = this._viewer.renderLoop();\n  var view = this._view;\n\n  var elapsed = now() - this._movementStartTime;\n  var step = this._movementStep;\n  var params = this._movementParams;\n\n  params = view.parameters(params);\n  params = step(params, elapsed);\n  if (params == null) {\n    this.stopMovement();\n  } else {\n    view.setParameters(params);\n    renderLoop.renderOnNextFrame();\n  }\n\n};\n\n\nScene.prototype._updateHotspotContainer = function() {\n  if (this.visible()) {\n    this._hotspotContainer.show();\n  } else {\n    this._hotspotContainer.hide();\n  }\n};\n\n\nmodule.exports = Scene;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar eventEmitter = require('minimal-event-emitter');\nvar defaults = require('./util/defaults');\nvar now = require('./util/now');\n\nvar defaultOptions = {\n  duration: Infinity\n};\n\n\n/**\n * Signals a timeout.\n * @event Timer#timeout\n */\n\n\n/**\n * @class Timer\n * @classdesc\n *\n * A Timer provides a mechanism to receive an event after a timeout.\n *\n * A timer has a set duration, and is either started or stopped at a given time.\n * The timer is initially stopped. When the timer is started, a timeout event is\n * scheduled to fire once the set duration elapses. When the timer is stopped,\n * the scheduled timeout event is cancelled. When a timeout event fires, the\n * timer returns to the stopped state.\n *\n * @param {number} [opts.duration=Infinity] Timeout in milliseconds.\n */\nfunction Timer(opts) {\n\n  opts = defaults(opts || {}, defaultOptions);\n\n  this._duration = opts.duration;\n\n  this._startTime = null;\n\n  this._handle = null;\n\n  this._check = this._check.bind(this);\n\n}\n\neventEmitter(Timer);\n\n\n/**\n * Starts the timer. If the timer is already started, this has the effect of\n * stopping and starting again (i.e. resetting the timer).\n */\nTimer.prototype.start = function() {\n  this._startTime = now();\n  if (this._handle == null && this._duration < Infinity) {\n    this._setup(this._duration);\n  }\n};\n\n\n/**\n * Returns whether the timer is in the started state.\n * @return {boolean}\n */\nTimer.prototype.started = function() {\n  return this._startTime != null;\n};\n\n\n/**\n * Stops the timer.\n */\nTimer.prototype.stop = function() {\n  this._startTime = null;\n  if (this._handle != null) {\n    clearTimeout(this._handle);\n    this._handle = null;\n  }\n};\n\n\nTimer.prototype._setup = function(interval) {\n  this._handle = setTimeout(this._check, interval);\n};\n\n\nTimer.prototype._teardown = function() {\n  clearTimeout(this._handle);\n  this._handle = null;\n};\n\n\nTimer.prototype._check = function() {\n  var currentTime = now();\n  var elapsed = currentTime - this._startTime;\n  var remaining = this._duration - elapsed;\n\n  this._teardown();\n\n  if (remaining <= 0) {\n    this.emit('timeout');\n    this._startTime = null;\n  } else if (remaining < Infinity) {\n    this._setup(remaining);\n  }\n};\n\n\n/**\n * Returns the currently set duration.\n */\nTimer.prototype.duration = function() {\n  return this._duration;\n};\n\n\n/**\n * Sets the duration. If the timer is already started, the timeout event is\n * rescheduled to occur once the new duration has elapsed since the last call\n * to start. In particular, if an amount of time larger than the new duration\n * has already elapsed, the timeout event fires immediately.\n * @param {number}\n */\nTimer.prototype.setDuration = function(duration) {\n  this._duration = duration;\n  if (this._startTime != null) {\n    this._check();\n  }\n};\n\n\nmodule.exports = Timer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('../util/defaults');\nvar clearOwnProperties = require('../util/clearOwnProperties');\n\nvar defaultOpts = {\n  active: 'move',\n  inactive: 'default',\n  disabled: 'default'\n};\n\n/**\n * @class ControlCursor\n * @classdesc\n *\n * Sets the CSS cursor on a DOM element according to the state of a\n * {@link ControlMethod}.\n *\n * @param {Controls} controls Controls instance containing the control method.\n * @param {string} id ID of the control method.\n * @param {Element} element DOM element where the cursor should be set.\n * @param {Object} opts The control cursors. Each field must be a valid value\n *     for the `cursor` CSS property.\n * @param {string} [opts.active='move'] Cursor to set when the control method\n *     is enabled and active.\n * @param {string} [opts.inactive='default'] Cursor to set when the control\n *     method is enabled and inactive.\n * @param {string} [opts.disabled='default'] Cursor to set when the control\n *     method is disabled.\n */\nfunction ControlCursor(controls, id, element, opts) {\n  opts = defaults(opts || {}, defaultOpts);\n\n  // TODO: This class may misbehave if the control method is unregistered and a\n  // different control method is registered under the same id.\n\n  this._element = element;\n  this._controls = controls;\n  this._id = id;\n\n  this._attached = false;\n\n  this._setActiveCursor = this._setCursor.bind(this, opts.active);\n  this._setInactiveCursor = this._setCursor.bind(this, opts.inactive);\n  this._setDisabledCursor = this._setCursor.bind(this, opts.disabled);\n  this._setOriginalCursor = this._setCursor.bind(this, this._element.style.cursor);\n\n  this._updateAttachmentHandler = this._updateAttachment.bind(this);\n\n  controls.addEventListener('methodEnabled', this._updateAttachmentHandler);\n  controls.addEventListener('methodDisabled', this._updateAttachmentHandler);\n  controls.addEventListener('enabled', this._updateAttachmentHandler);\n  controls.addEventListener('disabled', this._updateAttachmentHandler);\n\n  this._updateAttachment();\n}\n\n/**\n * Destructor.\n */\nControlCursor.prototype.destroy = function() {\n  this._detachFromControlMethod(this._controls.method(this._id));\n  this._setOriginalCursor();\n\n  this._controls.removeEventListener('methodEnabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('methodDisabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('enabled',\n      this._updateAttachmentHandler);\n  this._controls.removeEventListener('disabled',\n      this._updateAttachmentHandler);\n\n  clearOwnProperties(this);\n};\n\nControlCursor.prototype._updateAttachment = function() {\n  var controls = this._controls;\n  var id = this._id;\n  if (controls.enabled() && controls.method(id).enabled) {\n    this._attachToControlMethod(controls.method(id));\n  } else {\n    this._detachFromControlMethod(controls.method(id));\n  }\n};\n\nControlCursor.prototype._attachToControlMethod = function(controlMethod) {\n  if (!this._attached) {\n    controlMethod.instance.addEventListener('active', this._setActiveCursor);\n    controlMethod.instance.addEventListener('inactive', this._setInactiveCursor);\n\n    if (controlMethod.active) {\n      this._setActiveCursor();\n    } else {\n      this._setInactiveCursor();\n    }\n\n    this._attached = true;\n  }\n};\n\nControlCursor.prototype._detachFromControlMethod = function(controlMethod) {\n  if (this._attached) {\n    controlMethod.instance.removeEventListener('active', this._setActiveCursor);\n    controlMethod.instance.removeEventListener('inactive', this._setInactiveCursor);\n\n    this._setDisabledCursor();\n\n    this._attached = false;\n  }\n};\n\nControlCursor.prototype._setCursor = function(cursor) {\n  this._element.style.cursor = cursor;\n}\n\nmodule.exports = ControlCursor;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('../util/defaults');\nvar DragControlMethod = require('./Drag');\nvar QtvrControlMethod = require('./Qtvr');\nvar ScrollZoomControlMethod = require('./ScrollZoom');\nvar PinchZoomControlMethod = require('./PinchZoom');\nvar KeyControlMethod = require('./Key');\n\nvar defaultOptions = {\n  mouseViewMode: 'drag'\n};\n\n/**\n * Instantiate and register some commonly used {@link ControlMethod} instances.\n *\n * The following instances are registered:\n *   - mouseViewDrag\n *   - mouseViewQtvr\n *   - touchView\n *   - pinch\n *   - arrowKeys\n *   - plusMinusKeys\n *   - wasdKeys\n *   - qeKeys\n *\n * @param {Controls} controls Where to register the instances.\n * @param {Element} element Element to listen for events.\n * @param {Object} opts\n * @param {'drag'|'qtvr'} mouseViewMode\n */\nfunction registerDefaultControls(controls, element, opts) {\n  opts = defaults(opts || {}, defaultOptions);\n\n  var controlMethods = {\n    mouseViewDrag: new DragControlMethod(element, 'mouse'),\n    mouseViewQtvr: new QtvrControlMethod(element, 'mouse'),\n    touchView: new DragControlMethod(element, 'touch'),\n    pinch: new PinchZoomControlMethod(element, 'touch'),\n\n    leftArrowKey: new KeyControlMethod(37, 'x', -0.7, 3),\n    rightArrowKey: new KeyControlMethod(39, 'x', 0.7, 3),\n    upArrowKey: new KeyControlMethod(38, 'y', -0.7, 3),\n    downArrowKey: new KeyControlMethod(40, 'y', 0.7, 3),\n    plusKey: new KeyControlMethod(107, 'zoom', -0.7, 3),\n    minusKey: new KeyControlMethod(109, 'zoom', 0.7, 3),\n\n    wKey: new KeyControlMethod(87, 'y', -0.7, 3),\n    aKey: new KeyControlMethod(65, 'x', -0.7, 3),\n    sKey: new KeyControlMethod(83, 'y', 0.7, 3),\n    dKey: new KeyControlMethod(68, 'x', 0.7, 3),\n    qKey: new KeyControlMethod(81, 'roll', 0.7, 3),\n    eKey: new KeyControlMethod(69, 'roll', -0.7, 3)\n  };\n\n  if(opts.scrollZoom !== false) {\n    controlMethods.scrollZoom = new ScrollZoomControlMethod(element); //{ frictionTime: 0 }\n  }\n\n  var controlMethodGroups = {\n    arrowKeys: [ 'leftArrowKey', 'rightArrowKey', 'upArrowKey', 'downArrowKey' ],\n    plusMinusKeys: [ 'plusKey', 'minusKey' ],\n    wasdKeys: [ 'wKey', 'aKey', 'sKey', 'dKey' ],\n    qeKeys: [ 'qKey', 'eKey' ]\n  };\n\n\n  var enabledControls = [ 'scrollZoom', 'touchView', 'pinch' ];\n  switch (opts.mouseViewMode) {\n    case 'drag':\n      enabledControls.push('mouseViewDrag');\n      break;\n    case 'qtvr':\n      enabledControls.push('mouseViewQtvr');\n      break;\n    default:\n      throw new Error(\"Unknown mouse view mode: \" + opts.mouseViewMode);\n  }\n\n  for (var id in controlMethods) {\n    var method = controlMethods[id];\n    controls.registerMethod(id, method);\n    if (enabledControls.indexOf(id) >= 0) {\n      controls.enableMethod(id);\n    }\n  }\n\n  for (var groupId in controlMethodGroups) {\n    var methodGroup = controlMethodGroups[groupId];\n    controls.addMethodGroup(groupId, methodGroup);\n  }\n\n  return controlMethods;\n}\n\nmodule.exports = registerDefaultControls;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar now = require('./now');\n\nfunction tween(duration, update, done) {\n  var cancelled = false;\n\n  var startTime = now();\n\n  function runUpdate() {\n    if(cancelled) { return; }\n    var tweenVal = (now() - startTime)/duration;\n    if(tweenVal < 1) {\n      update(tweenVal);\n      requestAnimationFrame(runUpdate);\n    }\n    else {\n      update(1);\n      done();\n    }\n  }\n\n  update(0);\n  requestAnimationFrame(runUpdate);\n\n  return function cancel() {\n    cancelled = true;\n    done.apply(null, arguments);\n  }\n}\n\nmodule.exports = tween;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar browser = require('bowser');\nvar eventEmitter = require('minimal-event-emitter');\n\nvar RenderLoop = require('./RenderLoop');\nvar Controls = require('./controls/Controls');\nvar Scene = require('./Scene');\nvar Timer = require('./Timer');\n\nvar WebGlStage = require('./stages/WebGl');\n\nvar ControlCursor = require('./controls/ControlCursor');\nvar HammerGestures = require('./controls/HammerGestures');\n\nvar registerDefaultControls = require('./controls/registerDefaultControls');\nvar registerDefaultRenderers = require('./renderers/registerDefaultRenderers');\n\nvar setOverflowHidden = require('./util/dom').setOverflowHidden;\nvar setAbsolute = require('./util/dom').setAbsolute;\nvar setFullSize = require('./util/dom').setFullSize;\nvar setBlocking = require('./util/dom').setBlocking;\n\nvar tween = require('./util/tween');\nvar noop = require('./util/noop');\nvar clearOwnProperties = require('./util/clearOwnProperties');\n\n/**\n * Signals that the current scene has changed.\n * @event Viewer#sceneChange\n */\n\n/**\n * Signals that the view of the current scene has changed. See\n * {@link View#event:change}.\n * @event Viewer#viewChange\n */\n\n/**\n * @class Viewer\n * @classdesc\n *\n * A Viewer is a container for multiple {@link Scene scenes} to be displayed\n * inside a {@link Stage stage} contained in the DOM.\n *\n * Scenes may be created by calling {@link Viewer#createScene}. Except during a\n * scene switch, a single one of them, called the current scene, is visible.\n * Calling {@link Viewer#switchScene} sets the current scene and switches to it.\n *\n * @param {Element} domElement The DOM element to contain the stage.\n * @param {Object} opts Viewer creation options.\n * @param {Object} opts.controls Options to be passed to\n *     {@link registerDefaultControls}.\n * @param {Object} opts.stage Options to be passed to the {@link Stage}\n *     constructor.\n * @param {Object} opts.cursors Cursor options.\n * @param {Object} opts.cursors.drag Drag cursor options to be passed to the\n *     {@link ControlCursor} constructor.\n */\nfunction Viewer(domElement, opts) {\n  opts = opts || {};\n\n  this._domElement = domElement;\n\n  // Add `overflow: hidden` to the domElement.\n  setOverflowHidden(domElement);\n\n  // Create stage.\n  this._stage = new WebGlStage(opts.stage);\n\n  // Register the default renderers for the selected stage.\n  registerDefaultRenderers(this._stage);\n\n  // Add the stage element into the DOM.\n  this._domElement.appendChild(this._stage.domElement());\n\n  // Create control container.\n  // Controls cannot be placed directly on the root DOM element because\n  // Hammer.js will prevent click events from reaching the elements beneath.\n\n  // The hotspot containers will be added inside the controls container.\n  this._controlContainer = document.createElement('div');\n  setAbsolute(this._controlContainer);\n  setFullSize(this._controlContainer);\n\n  // Prevent bounce scroll effect on iOS.\n  // Applied only for iOS, as Android's events must have the default action to allow interaction with hotspots.\n  if (browser.ios) {\n    this._controlContainer.addEventListener('touchmove', function(event) {\n      event.preventDefault();\n    });\n  }\n\n\n  // Old IE does not detect mouse events on elements without background\n  // Add a child element to the controls with full width, a background color\n  // and opacity 0\n  var controlCapture = document.createElement('div');\n  setAbsolute(controlCapture);\n  setFullSize(controlCapture);\n  setBlocking(controlCapture);\n\n  this._controlContainer.appendChild(controlCapture);\n  domElement.appendChild(this._controlContainer);\n\n  // Respond to window size changes.\n  this._size = {};\n  this.updateSize();\n  this._updateSizeListener = this.updateSize.bind(this);\n  window.addEventListener('resize', this._updateSizeListener);\n\n  // Create render loop.\n  this._renderLoop = new RenderLoop(this._stage);\n\n  // Create the controls and register them with the render loop.\n  this._controls = new Controls();\n  this._controlMethods = registerDefaultControls(this._controls, this._controlContainer, opts.controls);\n  this._controls.attach(this._renderLoop);\n\n  // Expose HammerJS.\n  this._hammerManagerTouch = HammerGestures.get(this._controlContainer, 'touch');\n  this._hammerManagerMouse = HammerGestures.get(this._controlContainer, 'mouse');\n\n  // Initialize drag cursor.\n  this._dragCursor = new ControlCursor(this._controls, 'mouseViewDrag', domElement, opts.cursors && opts.cursors.drag || {});\n\n  // Start the render loop.\n  this._renderLoop.start();\n\n  // Scene list.\n  this._scenes = [];\n\n  // The currently visible scene.\n  // During a scene transition, this is the scene being switched to.\n  this._currentScene = null;\n\n  // The scene being switched from during a scene transition.\n  // This is necessary to update the layers correctly when they are added or\n  // removed during a transition.\n  this._replacedScene = null;\n\n  // The current transition.\n  this._cancelCurrentTween = null;\n\n  // The event listener fired when the current scene layers change.\n  // This is attached to the correct scene whenever the current scene changes.\n  this._layerChangeHandler = this._updateSceneLayers.bind(this);\n\n  // The event listener fired when the current scene view changes.\n  // This is attached to the correct scene whenever the current scene changes.\n  this._viewChangeHandler = this.emit.bind(this, 'viewChange');\n\n  // Setup the idle timer.\n  // By default, the timer has an infinite duration so it does nothing.\n  this._idleTimer = new Timer();\n  this._idleTimer.start();\n\n  // Reset the timer whenever the view changes.\n  this._resetIdleTimerHandler = this._resetIdleTimer.bind(this);\n  this.addEventListener('viewChange', this._resetIdleTimerHandler);\n\n  // Start the idle movement when the idle timer fires.\n  this._triggerIdleTimerHandler = this._triggerIdleTimer.bind(this);\n  this._idleTimer.addEventListener('timeout', this._triggerIdleTimerHandler);\n\n  // Stop an ongoing movement when the controls are activated or when the\n  // scene changes.\n  this._stopMovementHandler = this.stopMovement.bind(this);\n  this._controls.addEventListener('active', this._stopMovementHandler);\n  this.addEventListener('sceneChange', this._stopMovementHandler);\n\n  // The currently programmed idle movement.\n  this._idleMovement = null;\n}\n\neventEmitter(Viewer);\n\n\n/**\n * Destructor.\n */\nViewer.prototype.destroy = function() {\n\n  window.removeEventListener('resize', this._updateSizeListener);\n\n  if (this._currentScene) {\n    this._removeSceneEventListeners(this._currentScene);\n  }\n\n  if (this._replacedScene) {\n    this._removeSceneEventListeners(this._replacedScene);\n  }\n\n  this._dragCursor.destroy();\n\n  for (var methodName in this._controlMethods) {\n    this._controlMethods[methodName].destroy();\n  }\n\n  while (this._scenes.length) {\n    this.destroyScene(this._scenes[0]);\n  }\n\n  this._domElement.removeChild(this._stage.domElement());\n\n  this._stage.destroy();\n  this._renderLoop.destroy();\n  this._controls.destroy();\n  this._controls = null;\n\n  if (this._cancelCurrentTween) {\n    this._cancelCurrentTween();\n  }\n\n  clearOwnProperties(this);\n};\n\n\n/**\n * Updates the stage size to fill the containing element.\n *\n * This method is automatically called when the browser window is resized.\n * Most clients won't need to explicitly call it to keep the size up to date.\n */\nViewer.prototype.updateSize = function() {\n  var size = this._size;\n  size.width = this._domElement.clientWidth;\n  size.height = this._domElement.clientHeight;\n  this._stage.setSize(size);\n};\n\n\n/**\n * Returns the underlying {@link Stage stage}.\n * @return {Stage}\n */\nViewer.prototype.stage = function() {\n  return this._stage;\n};\n\n\n/**\n * Returns the underlying {@link RenderLoop render loop}.\n * @return {RenderLoop}\n */\nViewer.prototype.renderLoop = function() {\n  return this._renderLoop;\n};\n\n\n/**\n * Returns the underlying {@link Controls controls}.\n * @return {Controls}\n */\nViewer.prototype.controls = function() {\n  return this._controls;\n};\n\n\n/**\n * Returns the underlying DOM element.\n * @return {Element}\n */\nViewer.prototype.domElement = function() {\n  return this._domElement;\n};\n\n\n/**\n * Creates a new {@link Scene scene} with a single layer and adds it to the\n * viewer.\n *\n * The current scene does not change. To switch to the scene, call\n * {@link Viewer#switchScene}.\n *\n * @param {Object} opts Scene creation options.\n * @param {View} opts.view The scene's underlying {@link View}.\n * @param {Source} opts.source The layer's underlying {@link Source}.\n * @param {Geometry} opts.geometry The layer's underlying {@link Geometry}.\n * @param {boolean} [opts.pinFirstLevel=false] Whether to pin the first level to\n *     provide a fallback of last resort, at the cost of memory consumption.\n * @param {Object} [opts.textureStoreOpts={}] Options to pass to the\n *     {@link TextureStore} constructor.\n * @param {Object} [opts.layerOpts={}] Options to pass to the {@link Layer}\n *     constructor.\n * @return {Scene}\n */\nViewer.prototype.createScene = function(opts) {\n  opts = opts || {};\n\n  var scene = this.createEmptyScene({ view: opts.view });\n\n  scene.createLayer({\n    source: opts.source,\n    geometry: opts.geometry,\n    pinFirstLevel: opts.pinFirstLevel,\n    textureStoreOpts: opts.textureStoreOpts,\n    layerOpts: opts.layerOpts\n  });\n\n  return scene;\n};\n\n\n/**\n * Creates a new {@link Scene scene} with no layers and adds it to the viewer.\n *\n * Layers may be added to the scene by calling {@link Scene#createLayer}.\n * However, if the scene has a single layer, it is simpler to call\n * {@link Viewer#createScene} instead of this method.\n *\n * The current scene does not change. To switch to the scene, call\n * {@link Viewer#switchScene}.\n *\n * @param {Object} opts Scene creation options.\n * @param {View} opts.view The scene's underlying {@link View}.\n * @return {Scene}\n */\nViewer.prototype.createEmptyScene = function(opts) {\n  opts = opts || {};\n\n  var scene = new Scene(this, opts.view);\n  this._scenes.push(scene);\n\n  return scene;\n};\n\n\nViewer.prototype._updateSceneLayers = function() {\n  var i;\n  var layer;\n\n  var stage = this._stage;\n  var currentScene = this._currentScene;\n  var replacedScene = this._replacedScene;\n\n  var oldLayers = stage.listLayers();\n\n  // The stage contains layers from at most two scenes: the current one, on top,\n  // and the one currently being switched away from, on the bottom.\n  var newLayers = [];\n  if (replacedScene) {\n    newLayers = newLayers.concat(replacedScene.listLayers());\n  }\n  if (currentScene) {\n    newLayers = newLayers.concat(currentScene.listLayers());\n  }\n\n  // A single layer can be added or removed from the scene at a time.\n  if (Math.abs(oldLayers.length - newLayers.length) !== 1) {\n    throw new Error('Stage and scene out of sync');\n  }\n\n  if (newLayers.length < oldLayers.length) {\n    // A layer was removed.\n    for (i = 0; i < oldLayers.length; i++) {\n      layer = oldLayers[i];\n      if (newLayers.indexOf(layer) < 0) {\n        this._removeLayerFromStage(layer);\n        break;\n      }\n    }\n  }\n  if (newLayers.length > oldLayers.length) {\n    // A layer was added.\n    for (i = 0; i < newLayers.length; i++) {\n      layer = newLayers[i];\n      if (oldLayers.indexOf(layer) < 0) {\n        this._addLayerToStage(layer, i);\n      }\n    }\n  }\n\n  // TODO: When in the middle of a scene transition, call the transition update\n  // function immediately to prevent an added layer from flashing with the wrong\n  // opacity.\n};\n\n\nViewer.prototype._addLayerToStage = function(layer, i) {\n  // Pin the first level to ensure a fallback while the layer is visible.\n  // Note that this is distinct from the `pinFirstLevel` option passed to\n  // createScene(), which pins the layer even when it's not visible.\n  layer.pinFirstLevel();\n  this._stage.addLayer(layer, i);\n};\n\n\nViewer.prototype._removeLayerFromStage = function(layer) {\n  this._stage.removeLayer(layer);\n  layer.unpinFirstLevel();\n  layer.textureStore().clearNotPinned();\n};\n\n\nViewer.prototype._addSceneEventListeners = function(scene) {\n  scene.addEventListener('layerChange', this._layerChangeHandler);\n  scene.addEventListener('viewChange', this._viewChangeHandler);\n};\n\n\nViewer.prototype._removeSceneEventListeners = function(scene) {\n  scene.removeEventListener('layerChange', this._layerChangeHandler);\n  scene.removeEventListener('viewChange', this._viewChangeHandler);\n};\n\n\n/**\n * Destroys a {@link Scene scene} and removes it from the viewer.\n * @param {Scene} scene\n */\nViewer.prototype.destroyScene = function(scene) {\n  var i = this._scenes.indexOf(scene);\n  if (i < 0) {\n    throw new Error('No such scene in viewer');\n  }\n\n  var j;\n  var layers;\n\n  if (this._currentScene === scene) {\n    // The destroyed scene is the current scene.\n    // Remove event listeners, remove layers from stage and cancel transition.\n    this._removeSceneEventListeners(scene);\n    layers = scene.listLayers();\n    for (j = 0; j < layers.length; j++) {\n      this._removeLayerFromStage(layers[j]);\n    }\n    if (this._cancelCurrentTween) {\n      this._cancelCurrentTween();\n      this._cancelCurrentTween = null;\n    }\n    this._currentScene = null;\n    this.emit('sceneChange');\n  }\n\n  if (this._replacedScene === scene) {\n    // The destroyed scene is being switched away from.\n    // Remove event listeners and remove layers from stage.\n    this._removeSceneEventListeners(scene);\n    layers = scene.listLayers();\n    for (j = 0; j < layers.length; j++) {\n      this._removeLayerFromStage(layers[j]);\n    }\n    this._replacedScene = null;\n  }\n\n  this._scenes.splice(i, 1);\n\n  scene.destroy();\n};\n\n\n/**\n * Destroys all {@link Scene scenes} and removes them from the viewer.\n */\nViewer.prototype.destroyAllScenes = function() {\n  while (this._scenes.length > 0) {\n    this.destroyScene(this._scenes[0]);\n  }\n};\n\n\n/**\n * Returns whether the viewer contains a {@link Scene scene}.\n * @param {Scene} scene\n * @return {boolean}\n */\nViewer.prototype.hasScene = function(scene) {\n  return this._scenes.indexOf(scene) >= 0;\n};\n\n\n/**\n * Returns a list of all {@link Scene scenes}.\n * @return {Scene[]}\n */\nViewer.prototype.listScenes = function() {\n  return [].concat(this._scenes);\n};\n\n\n/**\n * Returns the current {@link Scene scene}, or null if there isn't one.\n *\n * To change the current scene, call {@link Viewer#switchScene}.\n *\n * @return {Scene}\n */\nViewer.prototype.scene = function() {\n  return this._currentScene;\n};\n\n\n/**\n * Returns the {@link View view} for the current {@link Scene scene}, or null\n * if there isn't one.\n * @return {View}\n */\nViewer.prototype.view = function() {\n  var scene = this._currentScene;\n  if (scene) {\n    return scene.view();\n  }\n  return null;\n};\n\n\n/**\n * Tweens the {@link View view} for the current {@link Scene scene}.\n *\n * This method is equivalent to calling {@link Scene#lookTo} on the current\n * scene.\n *\n * @param {Object} opts Options to pass into {@link Scene#lookTo}.\n * @param {function} done Function to call when the tween is complete.\n */\nViewer.prototype.lookTo = function(params, opts, done) {\n  // TODO: is it an error to call lookTo when no scene is displayed?\n  var scene = this._currentScene;\n  if (scene) {\n    scene.lookTo(params, opts, done);\n  }\n};\n\n\n/**\n * Starts a movement, possibly replacing the current movement.\n *\n * This method is equivalent to calling {@link Scene#startMovement} on the\n * current scene. If there is no current scene, this is a no-op.\n *\n * @param {function} fn The movement function.\n * @param {function} done Function to be called when the movement finishes or is\n *     interrupted.\n */\nViewer.prototype.startMovement = function(fn, done) {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  scene.startMovement(fn, done);\n};\n\n\n/**\n * Stops the current movement.\n *\n * This method is equivalent to calling {@link Scene#stopMovement} on the\n * current scene. If there is no current scene, this is a no-op.\n */\nViewer.prototype.stopMovement = function() {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  scene.stopMovement();\n};\n\n\n/**\n * Returns the current movement.\n *\n * This method is equivalent to calling {@link Scene#movement} on the\n * current scene. If there is no current scene, this is a no-op.\n *\n * @return {function}\n */\nViewer.prototype.movement = function() {\n  var scene = this._currentScene;\n  if (!scene) {\n    return;\n  }\n  return scene.movement();\n};\n\n\n/**\n * Schedules an idle movement to be automatically started when the view remains\n * unchanged for the given timeout period.\n *\n * Changing the view while the idle movement is active stops the movement and\n * schedules it to start again after the same timeout period. To disable it\n * permanently, call with a null movement or an infinite timeout.\n *\n * @param {number} timeout Timeout period in milliseconds.\n * @param {function} movement Automatic movement function, or null to disable.\n */\nViewer.prototype.setIdleMovement = function(timeout, movement) {\n  this._idleTimer.setDuration(timeout);\n  this._idleMovement = movement;\n};\n\n\n/**\n * Stops the idle movement. It will be started again after the timeout set by\n * {@link Viewer#setIdleMovement}.\n */\nViewer.prototype.breakIdleMovement = function() {\n  this.stopMovement();\n  this._resetIdleTimer();\n};\n\n\nViewer.prototype._resetIdleTimer = function() {\n  this._idleTimer.start();\n};\n\n\nViewer.prototype._triggerIdleTimer = function() {\n  var idleMovement = this._idleMovement;\n  if (!idleMovement) {\n    return;\n  }\n  this.startMovement(idleMovement);\n};\n\n\nvar defaultSwitchDuration = 1000;\n\nfunction defaultTransitionUpdate(val, newScene, oldScene) {\n  var layers = newScene.listLayers();\n  layers.forEach(function(layer) {\n    layer.mergeEffects({ opacity: val });\n  });\n\n  newScene._hotspotContainer.domElement().style.opacity = val;\n}\n\n\n/**\n * Switches to another {@link Scene scene} with a fade transition. This scene\n * becomes the current one.\n *\n * If a transition is already taking place, it is interrupted before the new one\n * starts.\n *\n * @param {Scene} newScene The scene to switch to.\n * @param {Object} opts Transition options.\n * @param {number} [opts.transitionDuration=1000] Transition duration, in\n *     milliseconds.\n * @param {number} [opts.transitionUpdate=defaultTransitionUpdate]\n *     Transition update function, with signature `f(t, newScene, oldScene)`.\n *     This function is called on each frame with `t` increasing from 0 to 1.\n *     An initial call with `t=0` and a final call with `t=1` are guaranteed.\n *     The default function sets the opacity of the new scene to `t`.\n * @param {function} done Function to call when the transition finishes or is\n *     interrupted. If the new scene is equal to the old one, no transition\n *     takes place, but this function is still called.\n */\nViewer.prototype.switchScene = function(newScene, opts, done) {\n  var self = this;\n\n  opts = opts || {};\n  done = done || noop;\n\n  var stage = this._stage;\n\n  var oldScene = this._currentScene;\n\n  // Do nothing if the target scene is the current one.\n  if (oldScene === newScene) {\n    done();\n    return;\n  }\n\n  if (this._scenes.indexOf(newScene) < 0) {\n    throw new Error('No such scene in viewer');\n  }\n\n  // Cancel an already ongoing transition. This ensures that the stage contains\n  // layers from exactly one scene before the transition begins.\n  if (this._cancelCurrentTween) {\n    this._cancelCurrentTween();\n    this._cancelCurrentTween = null;\n  }\n\n  var oldSceneLayers = oldScene ? oldScene.listLayers() : [];\n  var newSceneLayers = newScene.listLayers();\n  var stageLayers = stage.listLayers();\n\n  // Check that the stage contains exactly as many layers as the current scene,\n  // and that the top layer is the right one. If this test fails, either there\n  // is a bug or the user tried to modify the stage concurrently.\n  if (oldScene && ((stageLayers.length !== oldSceneLayers.length) ||\n      (stageLayers.length > 1 && stageLayers[0] != oldSceneLayers[0]))) {\n    throw new Error('Stage not in sync with viewer');\n  }\n\n  // Get the transition parameters.\n  var duration = opts.transitionDuration != null ?\n      opts.transitionDuration : defaultSwitchDuration;\n  var update = opts.transitionUpdate != null ?\n      opts.transitionUpdate : defaultTransitionUpdate;\n\n  // Add new scene layers into the stage before starting the transition.\n  for (var i = 0; i < newSceneLayers.length; i++) {\n    this._addLayerToStage(newSceneLayers[i]);\n  }\n\n  // Update function to be called on every frame.\n  function tweenUpdate(val) {\n    update(val, newScene, oldScene);\n  }\n\n  // Once the transition is complete, remove old scene layers from the stage and\n  // remove the event listeners. If the old scene was destroyed during the\n  // transition, this has already been taken care of. Otherwise, we still need\n  // to get a fresh copy of the scene's layers, since they might have changed\n  // during the transition.\n  function tweenDone() {\n    if (self._replacedScene) {\n      self._removeSceneEventListeners(self._replacedScene);\n      oldSceneLayers = self._replacedScene.listLayers();\n      for (var i = 0; i < oldSceneLayers.length; i++) {\n        self._removeLayerFromStage(oldSceneLayers[i]);\n      }\n      self._replacedScene = null;\n    }\n    self._cancelCurrentTween = null;\n    done();\n  }\n\n  // Store the cancelable for the transition.\n  this._cancelCurrentTween = tween(duration, tweenUpdate, tweenDone);\n\n  // Update the current and replaced scene.\n  this._currentScene = newScene;\n  this._replacedScene = oldScene;\n\n  // Emit scene and view change events.\n  this.emit('sceneChange');\n  this.emit('viewChange');\n\n  // Add event listeners to the new scene.\n  // Note that event listeners can only be removed from the old scene once the\n  // transition is complete, since layers might get added or removed in the\n  // interim.\n  this._addSceneEventListeners(newScene);\n};\n\n\nmodule.exports = Viewer;\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar vec4 = require('gl-matrix').vec4;\nvar mat4 = require('gl-matrix').mat4;\n\n/**\n * Helper functions for color transformation {@link Effects}.\n *\n * References:\n *\n *   - [ColorMatrix Guide](http://docs.rainmeter.net/tips/colormatrix-guide)\n *   - [Matrix Operations for Image Processing](http://www.graficaobscura.com/matrix/index.html)\n *   - [WebGLImageFilter](https://github.com/phoboslab/WebGLImageFilter)\n *   - [glfx.js](https://github.com/evanw/glfx.js)\n *\n * @namespace colorEffects\n */\n\n/**\n * A vector and matrix corresponding to an identity transformation.\n *\n * @param {Object} result Object to store result\n * @param {vec4} result.colorOffset Array with zeroes.\n * @param {mat4} result.colorMatrix Identity matrix.\n *\n * @memberof colorEffects\n */\nfunction identity(resultArg) {\n  var result = resultArg || {};\n  result.colorOffset = result.colorOffset || vec4.create();\n  result.colorMatrix = result.colorMatrix || mat4.create();\n  return result;\n}\n\n/**\n * Apply color effects to a single pixel\n *\n * @param {vec4} pixel Values in range [0,1]\n * @param {Object} effect\n * @param {vec4} effect.colorOffset\n * @param {mat4} effect.colorMatrix\n * @param {vec4} result Object to store result\n *\n * @memberof colorEffects\n */\nfunction applyToPixel(pixel, effect, result) {\n  vec4TransformMat4Transposed(result, pixel, effect.colorMatrix);\n  vec4.add(result, result, effect.colorOffset);\n}\n\n// Oddly, the colorTransform matrix needs to be transposed to be used with\n// vec4.transformMat4. It is strange that transformMat4 dosn't work the same\n// way as multiplying on the shader.\n// TODO: investigate this further\nfunction vec4TransformMat4Transposed(out, a, m) {\n  var x = a[0], y = a[1], z = a[2], w = a[3];\n  out[0] = m[0] * x + m[1] * y + m[2] * z + m[3] * w;\n  out[1] = m[4] * x + m[5] * y + m[6] * z + m[7] * w;\n  out[2] = m[8] * x + m[9] * y + m[10] * z + m[11] * w;\n  out[3] = m[12] * x + m[13] * y + m[14] * z + m[15] * w;\n  return out;\n}\n\n/**\n * Apply color effects to an ImageData\n *\n * @param {ImageData} imageData This object will be mutated\n * @param {Object} effect\n * @param {vec4} effect.colorOffset\n * @param {mat4} effect.colorMatrix\n *\n * @memberof colorEffects\n */\nvar tmpPixel = vec4.create();\nfunction applyToImageData(imageData, effect) {\n  var width = imageData.width;\n  var height = imageData.height;\n  var data = imageData.data;\n\n  for(var i = 0; i < width * height; i++) {\n    vec4.set(tmpPixel, data[i*4+0]/255, data[i*4+1]/255, data[i*4+2]/255, data[i*4+3]/255);\n    applyToPixel(tmpPixel, effect, tmpPixel);\n    data[i*4+0] = tmpPixel[0]*255;\n    data[i*4+1] = tmpPixel[1]*255;\n    data[i*4+2] = tmpPixel[2]*255;\n    data[i*4+3] = tmpPixel[3]*255;\n  }\n}\n\nmodule.exports = {\n  identity: identity,\n  applyToPixel: applyToPixel,\n  applyToImageData: applyToImageData\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar defaults = require('./util/defaults');\n\nvar defaultSpeed = 0.1;\nvar defaultAccel = 0.01;\n\nvar defaultOptions = {\n  yawSpeed: defaultSpeed,\n  pitchSpeed: defaultSpeed,\n  fovSpeed: defaultSpeed,\n  yawAccel: defaultAccel,\n  pitchAccel: defaultAccel,\n  fovAccel: defaultAccel,\n  targetPitch: 0,\n  targetFov: null\n};\n\n/**\n * @param {Object} opts\n * @param {Number} [opts.yawSpeed=0.1] Yaw maximum speed\n * @param {Number} [opts.pitchSpeed=0.1] Pitch maximum speed\n * @param {Number} [opts.fovSpeed=0.1] Fov maximum speed\n * @param {Number} [opts.yawAccel=0.01] Yaw acceleration\n * @param {Number} [opts.pitchAccel=0.01] Pitch acceleration\n * @param {Number} [opts.fovAccel=0.01] Fov acceleration\n * @param {Number} [opts.targetPitch=0] Value that pitch converges to. `null` means that the pitch will not change.\n * @param {Number} [opts.targetFov=null] Value that fov converges to. `null` means that the fov will not change.\n * @returns Movement function that can be passed to {@link Viewer#setIdleMovement} or {@link Scene#startMovement}\n*/\nfunction autorotate(opts) {\n\n  opts = defaults(opts || {}, defaultOptions);\n\n  var yawSpeed = opts.yawSpeed;\n  var pitchSpeed = opts.pitchSpeed;\n  var fovSpeed = opts.fovSpeed;\n  var yawAccel = opts.yawAccel;\n  var pitchAccel = opts.pitchAccel;\n  var fovAccel = opts.fovAccel;\n  var targetPitch = opts.targetPitch;\n  var targetFov = opts.targetFov;\n\n  return function start() {\n\n    var lastTime = 0;\n    var lastYawSpeed = 0;\n    var lastPitchSpeed = 0;\n    var lastFovSpeed = 0;\n\n    var currentYawSpeed = 0;\n    var currentPitchSpeed = 0;\n    var currentFovSpeed = 0;\n\n    var timeDelta;\n    var yawDelta;\n    var pitchDelta;\n    var fovDelta;\n\n    return function step(params, currentTime) {\n\n      timeDelta = (currentTime - lastTime) / 1000;\n      currentYawSpeed = Math.min(lastYawSpeed + timeDelta * yawAccel, yawSpeed);\n      yawDelta = currentYawSpeed * timeDelta;\n      params.yaw = params.yaw + yawDelta;\n\n      if (targetPitch != null && params.pitch !== targetPitch) {\n        var pitchThresh = 0.5 * lastPitchSpeed * lastPitchSpeed / pitchAccel;\n        if (Math.abs(targetPitch - params.pitch) > pitchThresh) {\n          // Acceleration phase\n          currentPitchSpeed = Math.min(lastPitchSpeed + timeDelta * pitchAccel, pitchSpeed);\n        } else {\n          // Deceleration phase\n          currentPitchSpeed = Math.max(lastPitchSpeed - timeDelta * pitchAccel, 0);\n        }\n        // currentPitchSpeed is the absolute value (>= 0)\n        pitchDelta = currentPitchSpeed * timeDelta;\n        if (targetPitch < params.pitch) {\n          params.pitch = Math.max(targetPitch, params.pitch - pitchDelta);\n        }\n        if (targetPitch > params.pitch) {\n          params.pitch = Math.min(targetPitch, params.pitch + pitchDelta);\n        }\n      }\n\n      if (targetFov != null && params.fov !== targetPitch) {\n        var fovThresh = 0.5 * lastFovSpeed * lastFovSpeed / fovAccel;\n        if (Math.abs(targetFov - params.fov) > fovThresh) {\n          // Acceleration phase\n          currentFovSpeed = Math.min(lastFovSpeed + timeDelta * fovAccel, fovSpeed);\n        } else {\n          // Deceleration phase\n          currentFovSpeed = Math.max(lastFovSpeed - timeDelta * fovAccel, 0);\n        }\n        // currentFovSpeed is the absolute value (>= 0)\n        fovDelta = currentFovSpeed * timeDelta;\n        if (targetFov < params.fov) {\n          params.fov = Math.max(targetFov, params.fov - fovDelta);\n        }\n        if (targetFov > params.fov) {\n          params.fov = Math.min(targetFov, params.fov + fovDelta);\n        }\n      }\n\n      lastTime = currentTime;\n      lastYawSpeed = currentYawSpeed;\n      lastPitchSpeed = currentPitchSpeed;\n      lastFovSpeed = currentFovSpeed;\n\n      return params;\n\n    };\n\n  };\n\n}\n\nmodule.exports = autorotate;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @memberof util\n * @param {number} rad\n * @return {number}\n */\nfunction radToDeg(rad) {\n  return rad * 180 / Math.PI;\n}\n\nmodule.exports = radToDeg;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nmodule.exports = {\n\n  // Stages.\n  WebGlStage: require('./stages/WebGl'),\n\n  // Renderers.\n  WebGlCubeRenderer: require('./renderers/WebGlCube'),\n  WebGlFlatRenderer: require('./renderers/WebGlFlat'),\n  WebGlEquirectRenderer: require('./renderers/WebGlEquirect'),\n  registerDefaultRenderers: require('./renderers/registerDefaultRenderers'),\n\n  // Geometries.\n  CubeGeometry: require('./geometries/Cube'),\n  FlatGeometry: require('./geometries/Flat'),\n  EquirectGeometry: require('./geometries/Equirect'),\n\n  // Views.\n  RectilinearView: require('./views/Rectilinear'),\n  FlatView: require('./views/Flat'),\n\n  // Sources.\n  ImageUrlSource: require('./sources/ImageUrl'),\n  SingleAssetSource: require('./sources/SingleAsset'),\n\n  // Assets.\n  StaticAsset: require('./assets/Static'),\n  DynamicAsset: require('./assets/Dynamic'),\n\n  // Texture store.\n  TextureStore: require('./TextureStore'),\n\n  // Layer.\n  Layer: require('./Layer'),\n\n  // Render loop.\n  RenderLoop: require('./RenderLoop'),\n\n  // Controls.\n  KeyControlMethod: require('./controls/Key'),\n  DragControlMethod: require('./controls/Drag'),\n  QtvrControlMethod: require('./controls/Qtvr'),\n  ScrollZoomControlMethod: require('./controls/ScrollZoom'),\n  PinchZoomControlMethod: require('./controls/PinchZoom'),\n  VelocityControlMethod: require('./controls/Velocity'),\n  ElementPressControlMethod: require('./controls/ElementPress'),\n  Controls: require('./controls/Controls'),\n  Dynamics: require('./controls/Dynamics'),\n\n  // High-level API.\n  Viewer: require('./Viewer'),\n  Scene: require('./Scene'),\n\n  // Hotspots.\n  Hotspot: require('./Hotspot'),\n  HotspotContainer: require('./HotspotContainer'),\n\n  // Effects.\n  colorEffects: require('./colorEffects'),\n\n  // Miscellaneous functions.\n  registerDefaultControls: require('./controls/registerDefaultControls'),\n  autorotate: require('./autorotate'),\n\n  // Utility functions.\n  util: {\n    async: require('./util/async'),\n    cancelize: require('./util/cancelize'),\n    chain: require('./util/chain'),\n    clamp: require('./util/clamp'),\n    clearOwnProperties: require('./util/clearOwnProperties'),\n    cmp: require('./util/cmp'),\n    compose: require('./util/compose'),\n    convertFov: require('./util/convertFov'),\n    decimal: require('./util/decimal'),\n    defaults: require('./util/defaults'),\n    defer: require('./util/defer'),\n    degToRad: require('./util/degToRad'),\n    delay: require('./util/delay'),\n    dom: require('./util/dom'),\n    extend: require('./util/extend'),\n    hash: require('./util/hash'),\n    inherits: require('./util/inherits'),\n    mod: require('./util/mod'),\n    noop: require('./util/noop'),\n    now: require('./util/now'),\n    once: require('./util/once'),\n    pixelRatio: require('./util/pixelRatio'),\n    radToDeg: require('./util/radToDeg'),\n    real: require('./util/real'),\n    retry: require('./util/retry'),\n    tween: require('./util/tween'),\n    type: require('./util/type')\n  },\n\n  // Expose dependencies for clients to use.\n  dependencies: {\n    bowser: require('bowser'),\n    glMatrix: require('gl-matrix'),\n    eventEmitter: require('minimal-event-emitter'),\n    hammerjs: require('hammerjs')\n  }\n};\n","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nfunction defer(fn, args) {\n  function deferred() {\n    if (args && args.length > 0) {\n      fn.apply(null, args);\n    } else {\n      fn();\n    }\n  }\n  setTimeout(deferred, 0);\n}\n\nmodule.exports = defer;","/*\n * Copyright 2016 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\n/**\n * @memberof util\n * @param {number} deg\n * @return {number}\n */\nfunction degToRad(deg) {\n  return deg * Math.PI / 180;\n}\n\nmodule.exports = degToRad;","<script lang=\"ts\">\n  import DataHotspot from \"../../hotspot/DataHotspot.svelte\";\n  import InfoHotspot from \"../../hotspot/InfoHotspot.svelte\";\n  import SceneHotspot from \"../../hotspot/SceneHotspot.svelte\";\n  import { onMount } from \"svelte\";\n  import Marzipano from \"marzipano\";\n\n  let container: HTMLElement;\n  let panoramaContainer: HTMLElement;\n  let config:\n    | {\n        scenes: [\n          {\n            name: string;\n            url: string;\n            hotspots: [\n              {\n                type: string;\n                dataType: \"flow\" | \"energy\" | \"power\" | \"temperature\";\n                sceneIndex: number;\n                yaw: number;\n                pitch: number;\n              }\n            ];\n          }\n        ];\n      }\n    | undefined;\n\n  let scenes: any[] = [];\n  let currentSceneIndex = 0;\n\n  const baseURL = window.location.href;\n  const configPath = baseURL + \"/config.json\";\n\n  async function getConfig() {\n    const config = await fetch(baseURL + \"/config.json\")\n      .then((response) => response.json())\n      .catch((e) => {\n        console.warn(\"Failed to fetch config from \" + configPath);\n      });\n\n    return config;\n  }\n\n  function switchScene(scene: any) {\n    // Display scene.\n    scene.switchTo();\n  }\n\n  $: if (currentSceneIndex != null && scenes.length > 0) {\n    switchScene(scenes[currentSceneIndex].scene);\n  }\n\n  function addHotspot(hotspot: HTMLElement) {\n    const sceneIndex = hotspot.dataset.sceneIndex;\n    if (sceneIndex) {\n      scenes[Number(sceneIndex)].scene.hotspotContainer().createHotspot(\n        hotspot,\n        {\n          yaw: Number(hotspot.dataset.yaw),\n          pitch: Number(hotspot.dataset.pitch),\n        },\n        { perspective: { radius: 1024 } }\n      );\n    }\n  }\n\n  onMount(async () => {\n    const viewer = new Marzipano.Viewer(panoramaContainer);\n\n    config = await getConfig();\n    if (config && config.scenes) {\n      for (const sceneConfig of config.scenes) {\n        // Create source.\n        const source = Marzipano.ImageUrlSource.fromString(\n          baseURL + sceneConfig.url\n        );\n\n        // Create geometry.\n        const geometry = new Marzipano.EquirectGeometry([{ width: 2048 }]);\n\n        // Create view.\n        const limiter = Marzipano.RectilinearView.limit.traditional(\n          1024,\n          (100 * Math.PI) / 180\n        );\n        const view = new Marzipano.RectilinearView({ yaw: 0 }, limiter);\n\n        // Create scene.\n        const scene = viewer.createScene({\n          source: source,\n          geometry: geometry,\n          view: view,\n          pinFirstLevel: true,\n        });\n\n        scenes = [...scenes, { name: sceneConfig.name, scene: scene }];\n      }\n    }\n\n    panoramaContainer.addEventListener(\"click\", (e) => {\n      console.log(\n        scenes[currentSceneIndex].scene\n          .view()\n          .screenToCoordinates({ x: e.x, y: e.y })\n      );\n    });\n  });\n</script>\n\n<style>\n  .panorama-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n\n  .scene-list {\n    position: absolute;\n    top: 0;\n    left: 0;\n    color: #fcfcfc;\n  }\n  .scene-list ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  .scene-list input {\n    display: none;\n  }\n  .scene-list label {\n    background-color: #1b191c55;\n    display: block;\n    padding: 10px 16px;\n  }\n  .scene-list label:hover {\n    background-color: #1b191ce0;\n  }\n  .scene-list label.active {\n    background-color: #1b191cbb;\n  }\n</style>\n\n<div bind:this={container}>\n  <div bind:this={panoramaContainer} class=\"panorama-container\" />\n  {#if config}\n    {#each config.scenes as sceneConfig, sceneIndex}\n      {#each sceneConfig.hotspots as hotspotConfig}\n        <div\n          data-scene-index={sceneIndex}\n          use:addHotspot\n          data-yaw={hotspotConfig.yaw}\n          data-pitch={hotspotConfig.pitch}>\n          {#if hotspotConfig.type == 'data'}\n            <DataHotspot type={hotspotConfig.dataType} value=\"2\">\n              {0}\n            </DataHotspot>\n          {:else if hotspotConfig.type == 'scene'}\n            <SceneHotspot\n              func={() => {\n                currentSceneIndex = hotspotConfig.sceneIndex;\n              }} />\n          {:else if hotspotConfig.type == 'info'}\n            <InfoHotspot />\n          {/if}\n        </div>\n      {/each}\n    {/each}\n  {/if}\n</div>\n\n<div class=\"scene-list\">\n  <ul>\n    {#each scenes as sceneConfig, sceneIndex}\n      <li>\n        <label class={sceneIndex == currentSceneIndex ? 'active' : ''}><input\n            type=\"radio\"\n            bind:group={currentSceneIndex}\n            value={sceneIndex} />\n          {sceneConfig.name}</label>\n      </li>\n    {/each}\n  </ul>\n</div>\n","import App from \"./App.svelte\";\nconst app = new App({\n    target: document.body,\n});\nexport default app;\n"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","tar","src","k","assign","slice","update_slot","slot","slot_definition","dirty","get_slot_changes_fn","get_slot_context_fn","slot_changes","lets","undefined","merged","len","Math","max","length","i","get_slot_changes","slot_context","p","null_to_empty","value","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","d","element","name","document","createElement","svg_element","createElementNS","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","set_data","wholeText","current_component","set_current_component","component","onMount","Error","get_current_component","$$","on_mount","push","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","flushing","seen_callbacks","Set","flush","update","pop","callback","has","add","clear","fragment","before_update","after_update","outroing","outros","group_outros","r","c","check_outros","transition_in","block","local","delete","transition_out","o","create_component","mount_component","on_destroy","m","new_on_destroy","map","filter","destroy_component","make_dirty","then","fill","init","instance","create_fragment","not_equal","props","parent_component","prop_values","bound","context","Map","callbacks","skip_bound","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","intro","SvelteComponent","[object Object]","this","$destroy","type","index","indexOf","splice","$$props","obj","$$set","keys","unit","color","elt","setInterval","random","toFixed","flow","energy","power","temperature","func","EventEmitter","prototype","eventMap","__events","handlerList","emit","var_args","args","call","arguments","apply","ctor","prop","hasOwnProperty","performance","now","Date","WorkTask","cb","cfn","WorkQueue","opts","_queue","_delay","delay","_paused","paused","_currentTask","_lastFinished","task","cancel","_cancel","bind","_next","pause","resume","_start","finish","_finish","pos","elapsed","remaining","setTimeout","shift","totalWidth","totalHeight","spec","result","width","height","x","y","absoluteWidth","relativeWidth","absoluteHeight","relativeHeight","absoluteX","relativeX","absoluteY","relativeY","done","err","e","called","once","RendererRegistry","_renderers","set","geometryType","viewType","Renderer","get","forwardTileCmp","t1","t2","cmp","reverseTileCmp","Stage","_progressive","progressive","_layers","_tilesToLoad","_tilesToRender","_tmpVisible","_tmpChildren","_width","_height","_tmpRect","_tmpSize","_createTextureWorkQueue","_emitRenderInvalid","_rendererRegistry","destroy","removeAllLayers","clearOwnProperties","registerRenderer","domElement","size","setSize","setSizeForType","loadImage","validateLayer","layer","listLayers","concat","hasLayer","addLayer","geometry","view","rendererClass","renderer","createRenderer","moveLayer","removeLayer","removedLayer","destroyRenderer","startFrame","endFrame","render","j","stableLayer","tilesToLoad","tilesToRender","stableStage","rect","textureStore","tile","texture","effects","depth","calcRect","startLayer","_collectTiles","markTile","renderTile","endLayer","tmpVisible","visibleTiles","isStable","needsFallback","_collectTileToLoad","_collectTileToRender","_collectChildren","_collectParents","sort","tmpChildren","needsLoading","parent","_collectTileIntoList","tileList","found","equals","createTexture","asset","self","cancelize","async","TextureClass","window","global","propertyMap","HTMLImageElement","HTMLCanvasElement","ImageBitmap","StaticAsset","supported","_widthProp","_heightProp","_element","timestamp","isDynamic","superCtor","super_","TempCtor","constructor","NetworkError","message","createImageBitmapOpts","imageOrientation","premultiplyAlpha","resizeQuality","HtmlImageLoader","stage","_stage","url","img","Image","crossOrigin","onload","_handleLoad","onerror","_handleError","naturalWidth","naturalHeight","createImageBitmap","bitmap","canvas","getContext","drawImage","module","t","n","exports","defineProperty","enumerable","Symbol","toStringTag","__esModule","default","s","17","getFirstMatch","match","getSecondMatch","matchAndReturnConst","test","getWindowsVersionName","getMacOSVersionName","split","parseInt","getAndroidVersionName","getVersionPrecision","compareVersions","u","join","reverse","min","find","getBrowserAlias","BROWSER_ALIASES_MAP","getBrowserTypeByAlias","BROWSER_MAP","18","ENGINE_MAP","OS_MAP","PLATFORMS_MAP","Amazon Silk","Android Browser","Bada","BlackBerry","Chrome","Chromium","Electron","Epiphany","Firefox","Focus","Generic","Google Search","Googlebot","Internet Explorer","K-Meleon","Maxthon","Microsoft Edge","MZ Browser","NAVER Whale Browser","Opera","Opera Coast","PhantomJS","Puffin","QupZilla","QQ","QQLite","Safari","Sailfish","Samsung Internet for Android","SeaMonkey","Sleipnir","Swing","Tizen","UC Browser","Vivaldi","WebOS Browser","WeChat","Yandex Browser","Roku","amazon_silk","android","bada","blackberry","chrome","chromium","electron","epiphany","firefox","focus","generic","googlebot","google_search","ie","k_meleon","maxthon","edge","mz","naver","opera","opera_coast","phantomjs","puffin","qupzilla","qq","qqlite","safari","sailfish","samsung_internet","seamonkey","sleipnir","swing","tizen","uc","vivaldi","webos","wechat","yandex","tablet","mobile","desktop","tv","WindowsPhone","Windows","MacOS","iOS","Android","WebOS","Linux","ChromeOS","PlayStation4","EdgeHTML","Blink","Trident","Presto","Gecko","WebKit","90","configurable","writable","key","getParser","parse","getResult","91","_ua","parsedResult","getUA","parseBrowser","browser","some","describe","getBrowser","getBrowserName","String","toLowerCase","getBrowserVersion","version","getOS","os","parseOS","getOSName","getOSVersion","getPlatform","platform","parsePlatform","getPlatformType","getEngine","engine","parseEngine","getEngineName","satisfies","isOS","isPlatform","f","h","isBrowser","compareVersion","substr","isEngine","is","92","search","93","versionName","replace","94","vendor","model","Number","95","devicePixelRatio","screen","deviceXDPI","logicalXDPI","systemXDPI","prefixProperty","property","style","documentElement","prefixList","prefixedProperty","toUpperCase","setWithVendorPrefix","val","setTransform","setTransformOrigin","getWithVendorPrefix","setNullTransform","setNullTransformOrigin","setAbsolute","position","setPixelPosition","left","top","setPixelSize","setNullSize","setFullSize","setOverflowHidden","overflow","setOverflowVisible","setNoPointerEvents","pointerEvents","setBlocking","backgroundColor","opacity","require$$0","browserQuirks","WebGlStage","_generateMipmaps","generateMipmaps","_loader","_domElement","_gl","alpha","premultipliedAlpha","antialias","preserveDrawingBuffer","gl","wrapContext","initWebGlContext","_handleContextLoss","_rendererInstances","WebGlTexture","_texture","_timestamp","refresh","webGlContext","ratio","pixelRatio","maxTextureSize","getParameter","MAX_TEXTURE_SIZE","tileSize","maxTileSize","rendererInstances","viewport","drawingBufferWidth","drawingBufferHeight","clearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","enable","DEPTH_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","takeSnapshot","quality","toDataURL","maxSize","deleteTexture","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texImage2D","RGBA","UNSIGNED_BYTE","HTMLVideoElement","texSubImage2D","ispot","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","generateMipmap","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","EPSILON","ARRAY_TYPE","Float32Array","RANDOM","degree","PI","hypot","sqrt","abs","multiply","out","a0","a1","a2","a3","b0","b1","b2","b3","subtract","mul","sub","glMatrix.ARRAY_TYPE","m00","m01","m10","m11","det","rad","sin","cos","v","v0","v1","L","D","U","glMatrix.EPSILON","scale","a4","a5","b4","b5","tx","ty","aa","ab","ac","ad","atx","aty","a00","a01","a02","a10","a11","a12","a20","a21","a22","b00","b01","b02","b10","b11","b12","b20","b21","b22","m02","m12","m20","m21","m22","q","z","w","x2","y2","z2","xx","yx","yy","zx","zy","zz","wx","wy","wz","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","a6","a7","a8","b6","b7","b8","identity","fromRotationTranslation","xy","xz","yz","getTranslation","mat","getScaling","m13","m23","m31","m32","m33","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","m03","m30","axis","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","sx","sy","sz","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","right","bottom","near","far","rl","tb","nf","fovy","aspect","tan","Infinity","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","lr","bt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","a9","a14","a15","b9","b13","b14","b15","fromValues","divide","distance","squaredDistance","squaredLength","normalize","dot","cross","vec","div","dist","sqrDist","sqrLen","stride","offset","count","arg","ceil","floor","round","factorTimes2","factor1","factor2","factor3","factor4","inverseFactor","inverseFactorTimesTwo","glMatrix.RANDOM","zScale","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","mag","cosine","acos","clone","copy","lerp","exactEquals","A","B","C","E","F","G","H","I","J","v2","v3","v4","s1","s2","ix","iy","iz","iw","setAxisAngle","rotateX","rotateY","rotateZ","exp","et","ln","atan2","log","slerp","omega","cosom","sinom","scale0","scale1","fromMat3","fRoot","fTrace","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","vec4.clone","vec4.fromValues","vec4.copy","vec4.set","vec4.add","vec4.scale","vec4.dot","vec4.lerp","vec4.length","vec4.squaredLength","vec4.normalize","vec4.exactEquals","vec4.equals","rotationTo","vec3.create","vec3.fromValues","vec3.dot","vec3.cross","vec3.len","vec3.normalize","sqlerp","setAxes","mat3.create","out_axis","dotproduct","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","halfToRad","cx","cy","cz","getReal","quat.copy","setReal","ax0","ay0","az0","aw0","bx1","by1","bz1","bw1","ax1","ay1","az1","aw1","bx0","by0","bz0","bw0","quat.dot","quat.length","quat.squaredLength","dq","w1","outer","quat.create","mat4.getRotation","mat4.getTranslation","ax2","ay2","az2","aw2","quat.rotateX","quat.rotateY","quat.rotateZ","axisLength","mt","sqlen","a_dot_b","p0","p1","sinC","cosC","vec4","vec3","mat4","createShader","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createConstantBuffer","usage","buffer","createBuffer","bindBuffer","bufferData","defaultColorOffset","defaultColorMatrix","translateVector","scaleVector","vertexSrc","fragmentSrc","attribList","uniformList","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","attrib","getAttribLocation","uniform","getUniformLocation","shaderList","getAttachedShaders","detachShader","deleteShader","deleteProgram","vertexIndices","vertexPositions","textureCoords","ELEMENT_ARRAY_BUFFER","STATIC_DRAW","Uint16Array","ARRAY_BUFFER","constantBuffers","deleteBuffer","numAttrs","ACTIVE_ATTRIBUTES","enableVertexAttribArray","disableVertexAttribArray","activeTexture","TEXTURE0","uniform1i","uSampler","layerZ","tileZ","uniform1f","uDepth","viewportMatrix","offsetX","clampedOffsetX","clamp","leftExcess","maxClampedWidth","clampedWidth","rightExcess","offsetY","clampedOffsetY","bottomExcess","maxClampedHeight","clampedHeight","topExcess","translate","uniforms","colorOffset","uniform4fv","colorMatrix","uniformMatrix4fv","createConstantBuffers","WebGlCommon","destroyConstantBuffers","createShaderProgram","destroyShaderProgram","enableAttributes","disableAttributes","setViewport","setupPixelEffectUniforms","setDepth","setTexture","WebGlBaseRenderer","projMatrix","useProgram","uViewportMatrix","vertexAttribPointer","aVertexPosition","FLOAT","FALSE","aTextureCoord","uOpacity","uColorOffset","uColorMatrix","centerX","centerY","scaleX","scaleY","projection","rotX","rotY","uProjMatrix","drawElements","TRIANGLES","UNSIGNED_SHORT","WebGlCubeRenderer","WebGlFlatRenderer","WebGlEquirectRenderer","invProjMatrix","invert","uInvProjMatrix","textureCrop","textureX","textureY","textureWidth","textureHeight","uTextureX","uTextureY","uTextureWidth","uTextureHeight","WebGlFlat","WebGlCube","WebGlEquirect","capacity","isFinite","_capacity","_buckets","_size","mod","hash","bucket","existingElement","remove","TileSearcher","_stack","_visited","_vertices","startingTile","stack","visited","vertices","_clear","intersects","neighbors","LruMap","_keys","_values","_index","existingKey","del","evictedKey","existingValue","Level","levelProperties","_fallbackOnly","fallbackOnly","numHorizontalTiles","tileWidth","numVerticalTiles","tileHeight","makeLevelList","levelPropertiesList","LevelClass","list","level1","level2","makeSelectableLevelList","levelList","typ","toString","require$$1","faceList","faceRotation","origin","rotateVector","faceVectors","face","rotation","adjacentFace","neighborOffsets","CubeTile","_geometry","_level","CubeLevel","_tileSize","CubeGeometry","selectableLevelList","_validateWithParentLevel","_tileSearcher","_neighborsCache","_vec","_viewSize","rot","makeVertex","level","parentLevel","childLevel","nHoriz","nVert","tileX","tileY","cache","cachedResult","numX","numY","newX","newY","newZ","newFace","xCoord","yCoord","that","str","numHorizontal","numVertical","parentWidth","parentHeight","parentTileWidth","parentTileHeight","parentNumHorizontal","parentNumVertical","levelTiles","levelIndex","maxX","maxY","_closestTile","ray","transformMat4","inverseProjection","minAngle","closestFace","vector","angle","viewSize","tileSearcher","Tile","vec2","FlatTile","FlatLevel","_tileWidth","_tileHeight","FlatGeometry","levelWidth","levelHeight","EquirectTile","EquirectLevel","EquirectGeometry","common","convert","fromDimension","toDimension","atan","htov","htod","vtoh","vtod","dtoh","dtov","toPrecision","fnList","initialArg","defaultFov","fovLimitEpsilon","RectilinearView","params","limiter","_yaw","yaw","_pitch","pitch","_roll","roll","_fov","_projectionCenterX","projectionCenterX","_projectionCenterY","projectionCenterY","_limiter","_projMatrix","_invProjMatrix","_frustum","_projectionChanged","_params","_fovs","_tmpVec","_update","parameters","setYaw","_resetParams","setPitch","setRoll","setFov","setProjectionCenterX","setProjectionCenterY","offsetYaw","yawOffset","offsetPitch","pitchOffset","offsetRoll","rollOffset","offsetFov","fovOffset","setParameters","setLimiter","oldYaw","oldPitch","oldRoll","oldFov","oldProjectionCenterX","oldProjectionCenterY","oldWidth","oldHeight","newYaw","_normalize","newPitch","newRoll","newFov","newWidth","newHeight","newProjectionCenterX","newProjectionCenterY","real","_normalizeCoordinates","hfovPi","convertFov","maxFov","isNaN","normalizeToClosest","coords","viewYaw","viewPitch","coordYaw","coordPitch","prevYaw","nextYaw","prevPitch","nextPitch","updateWithControlParameters","vfov","hfov","axisScaledX","axisScaledY","zoom","_updateProjection","frustum","offsetAngleX","offsetAngleY","fovs","perspectiveFromFieldOfView","perspective","_matrixToFrustum","rectangle","vertex","plane","inside","corner","selectLevel","requiredPixels","coverFactor","coordinatesToScreen","screenToCoordinates","vecx","vecy","coordinatesToPerspectiveTransform","radius","extraTransforms","transform","decimal","limit","vmin","vmax","resolution","minFov","traditional","maxResolution","maxVFov","maxHFov","compose","planeAxes","planeCmp","FlatView","mediaAspectRatio","_x","_y","_zoom","_mediaAspectRatio","setX","setY","setZoom","xOffset","yOffset","offsetZoom","zoomOffset","setMediaAspectRatio","oldX","oldY","oldZoom","oldMediaAspectRatio","newZoom","newMediaAspectRatio","_zoomX","_zoomY","zoomX","zoomY","ortho","levels","zoomFactor","minZoom","visibleX","maxZoom","minX","visibleY","factor","minY","letterbox","viewportAspectRatio","fullHeightZoom","WorkPool","_concurrency","concurrency","_pool","argList","exec","_fn","_cfn","unshift","ms","timer","clearTimeout","templateProperties","ImageUrlSource","sourceFromTile","_loadPool","_retryDelay","retryDelay","_retryMap","_sourceFromTile","propertyRegExp","RegExp","loadAsset","delayAmount","retryMap","tileSource","lastTime","delayFn","chain","fromString","faceOrder","cubeMapPreviewFaceOrder","cubeMapPreviewUrl","cubeMapUrl","withoutPreview","tileUrl","templateProperty","regExp","valueFromTile","SingleAssetSource","_asset","timeout","DynamicAsset","markDirty","_keyBuckets","_valBuckets","keyBucket","valBucket","LruSet","_elements","evictedElement","defaultsObj","canceled","debug","MARZIPANODEBUG","State","defaultOptions","previouslyVisibleCacheSize","nextId","CancelError","TextureStoreItem","store","id","_id","_store","_tile","_changeHandler","source","retry","console","TextureStore","defaults","_source","_state","_delimCount","_itemMap","_visible","_previouslyVisible","_pinMap","_newVisible","_noLongerVisible","_visibleAgain","_evicted","_unloadTile","clearNotPinned","item","otherTile","_loadTile","tmp","pin","unpin","query","pinCount","visible","previouslyVisible","hasAsset","hasTexture","pinned","sourceObj","Layer","_view","_textureStore","_effects","_fixedLevelIndex","_viewChangeHandler","_textureStoreChangeHandler","setEffects","mergeEffects","extend","fixedLevel","setFixedLevel","_selectLevel","pinLevel","tiles","unpinLevel","pinFirstLevel","unpinFirstLevel","RenderLoop","_running","_rendering","_requestHandle","_boundLoop","_loop","_renderInvalidHandler","renderOnNextFrame","stop","start","cancelAnimationFrame","requestAnimationFrame","Dynamics","velocity","friction","d1","d2","other","offsetFromVelocity","reset","velocityAfter","num","dec","decreaseAbs","nullVelocityTime","velocityEnd","KeyControlMethod","keyCode","parameter","_keyCode","_parameter","_velocity","_friction","_keydownHandler","_handlePress","_keyupHandler","_handleRelease","_blurHandler","_handleBlur","_dynamics","_pressing","exportName","VENDOR_PREFIXES","TEST_ELEMENT","TYPE_FUNCTION","setTimeoutContext","bindFn","invokeArrayArg","isArray","each","iterator","dest","merge","inherit","child","base","properties","childP","baseP","_super","boolOrFn","ifUndefined","val1","val2","addEventListeners","types","splitStr","removeEventListeners","hasParent","inStr","trim","inArray","findByKey","toArray","uniqueArray","results","values","prefixed","prefix","camelProp","_uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_MOUSE","DIRECTION_VERTICAL","DIRECTION_UP","PROPS_XY","PROPS_CLIENT_XY","Input","manager","inputTarget","domHandler","ev","inputHandler","eventType","input","pointersLen","pointers","changedPointersLen","changedPointers","isFirst","isFinal","session","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","getCenter","timeStamp","deltaTime","getAngle","getDistance","offsetDelta","prevDelta","prevInput","deltaX","deltaY","computeDeltaXY","offsetDirection","getDirection","end","velocityX","velocityY","direction","last","lastInterval","getVelocity","computeIntervalInputData","srcEvent","computeInputData","recognize","clientX","clientY","p2","evEl","evTarget","evWin","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","MouseInput","allow","pressed","button","which","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","2","3","4","5","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","PointerEventInput","MSPointerEvent","removePointer","eventTypeNormalized","isTouch","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","normalizeSingleTouches","all","touches","changed","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","TouchInput","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","touch","TouchMouseInput","mouse","inputEvent","inputData","isMouse","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TouchAction","compute","actions","touchAction","recognizers","recognizer","getTouchAction","hasPanX","hasPanY","cleanTouchActions","preventDefaults","prevented","hasNone","DIRECTION_LEFT","preventSrc","preventDefault","STATE_CANCELLED","STATE_FAILED","Recognizer","state","simultaneous","requireFail","directionStr","getRecognizerByNameIfManager","otherRecognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","Hammer","preset","Manager","recognizeWith","dropRecognizeWith","requireFailure","dropRequireFailure","hasRequireFailures","canRecognizeWith","withState","stateStr","tryEmit","canEmit","inputDataClone","process","attrTest","optionPointers","isRecognized","isValid","threshold","DIRECTION_HORIZONTAL","directionTest","hasMoved","inOut","time","validPointers","validMovement","validTime","taps","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","VERSION","domEvents","inputClass","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","handlers","toggleCssProps","force","stopped","curRecognizer","existing","on","events","off","gestureEvent","createEvent","initEvent","gesture","dispatchEvent","triggerDomEvent","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","DIRECTION_NONE","DIRECTION_RIGHT","DIRECTION_DOWN","DIRECTION_ALL","Tap","Pan","Swipe","Pinch","Rotate","Press","idProperty","getKeyForElementAndType","HammerGestures","_managers","_refCount","HammerGesturesHandle","hammerGestures","_manager","_type","_hammerGestures","_eventHandlers","_createManager","_releaseHandle","handlerFilteredEvents","release","eventHandler","changeVectorNorm","theta","maxFrictionTime","pow","maxFriction","controls","DragControlMethod","_opts","_startEvent","_lastEvent","_active","_hammer","_handleHammerEvent","_handleStart","_handleMove","_handleEnd","_updateDynamicsMove","_updateDynamicsRelease","eventToSubtract","elementRect","getBoundingClientRect","tmpReleaseFriction","speed","QtvrControlMethod","_updateDynamics","maxDim","frictionTime","zoomDelta","ScrollZoomControlMethod","_eventList","withSmoothing","withoutSmoothing","_wheelListener","wheelEventDelta","multiplier","deltaMode","currentTime","PinchZoomControlMethod","_handleEvent","VelocityControlMethod","setVelocity","setFriction","ElementPressControlMethod","_pressHandler","_releaseHandler","ControlComposer","_methods","_parameters","_now","nowForTesting","_composedOffsets","_composeReturn","offsets","changing","dynamics","parameterDynamicsHandler","method","_indexOfInstance","instances","storedDynamics","parameterDynamics","newTime","_resetComposedOffsets","methodDynamics","currentVelocity","Controls","_methodGroups","_composer","Composer","_enabled","enabled","_activeCount","updatedViews_","_attachedRenderLoop","methods","registerMethod","active","activeHandler","_handleActive","inactiveHandler","_handleInactive","enableMethod","unregisterMethod","disableMethod","_incrementActiveCount","_listen","_updateComposer","_decrementActiveCount","_unlisten","addMethodGroup","groupId","methodIds","removeMethodGroup","methodGroups","enableMethodGroup","methodId","disableMethodGroup","disable","attach","renderLoop","_beforeRenderHandler","_updateViewsWithControls","attached","_checkActiveCount","composer","controlData","layers","Hotspot","parentDomElement","_parentDomElement","_coords","_perspective","setPosition","setPerspective","_position","show","hide","isVisible","_setEmbeddedPosition","_setPosition","display","positionAbsolutely","setPointerEvents","HotspotContainer","_renderLoop","_hotspots","_rect","_visibilityOrRectChanged","_stageWidth","_stageHeight","_hotspotContainerWrapper","_hotspotContainer","_updateHandler","destroyHotspot","setRect","createHotspot","hotspot","hasHotspot","listHotspots","wrapper","tmpRect","Scene","viewer","_viewer","_controlContainer","_movement","_movementStartTime","_movementStep","_movementParams","_movementCallback","_updateMovementHandler","_updateMovement","_updateHotspotContainerHandler","_updateHotspotContainer","stopMovement","destroyAllLayers","hotspotContainer","scene","createLayer","textureStoreOpts","layerOpts","destroyLayer","switchTo","switchScene","lookTo","ease","controlsInterrupt","duration","transitionDuration","shortest","initialParams","finalParams","reenableControls","startMovement","finalUpdate","delta","param","step","movement","Timer","_duration","_startTime","_handle","_check","_setup","_teardown","setDuration","defaultOpts","inactive","disabled","ControlCursor","_controls","_attached","_setActiveCursor","_setCursor","_setInactiveCursor","_setDisabledCursor","_setOriginalCursor","cursor","_updateAttachmentHandler","_updateAttachment","_detachFromControlMethod","_attachToControlMethod","controlMethod","mouseViewMode","controlMethods","mouseViewDrag","mouseViewQtvr","touchView","pinch","leftArrowKey","rightArrowKey","upArrowKey","downArrowKey","plusKey","minusKey","wKey","aKey","sKey","dKey","qKey","eKey","scrollZoom","controlMethodGroups","arrowKeys","plusMinusKeys","wasdKeys","qeKeys","enabledControls","methodGroup","cancelled","startTime","runUpdate","tweenVal","Viewer","registerDefaultRenderers","ios","controlCapture","updateSize","_updateSizeListener","_controlMethods","registerDefaultControls","_hammerManagerTouch","_hammerManagerMouse","_dragCursor","cursors","drag","_scenes","_currentScene","_replacedScene","_cancelCurrentTween","_layerChangeHandler","_updateSceneLayers","_idleTimer","_resetIdleTimerHandler","_resetIdleTimer","_triggerIdleTimerHandler","_triggerIdleTimer","_stopMovementHandler","_idleMovement","methodName","_removeSceneEventListeners","destroyScene","clientWidth","clientHeight","createScene","createEmptyScene","currentScene","replacedScene","oldLayers","newLayers","_removeLayerFromStage","_addLayerToStage","_addSceneEventListeners","destroyAllScenes","hasScene","listScenes","setIdleMovement","breakIdleMovement","idleMovement","defaultTransitionUpdate","newScene","oldScene","oldSceneLayers","newSceneLayers","stageLayers","transitionUpdate","tween","applyToPixel","pixel","effect","tmpPixel","defaultAccel","yawSpeed","pitchSpeed","fovSpeed","yawAccel","pitchAccel","fovAccel","targetPitch","targetFov","require$$2","require$$3","require$$4","require$$5","require$$6","require$$7","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","require$$14","require$$15","require$$16","require$$17","require$$18","require$$19","require$$20","require$$21","require$$22","require$$23","require$$24","require$$25","require$$26","require$$27","require$$28","require$$29","colorEffects","resultArg","applyToImageData","imageData","require$$31","autorotate","timeDelta","yawDelta","pitchDelta","fovDelta","lastYawSpeed","lastPitchSpeed","lastFovSpeed","currentYawSpeed","currentPitchSpeed","currentFovSpeed","pitchThresh","fovThresh","util","require$$33","require$$34","require$$35","require$$36","require$$37","require$$38","require$$39","require$$40","require$$41","require$$42","defer","degToRad","deg","require$$45","dom","require$$46","require$$47","require$$48","inherits","require$$49","require$$50","require$$51","require$$52","require$$53","require$$54","radToDeg","require$$56","require$$57","require$$58","require$$59","dependencies","bowser","require$$60","glMatrix","require$$61","eventEmitter","require$$62","hammerjs","require$$63","scenes","dataType","action_result","hotspots","__awaiter","thisArg","_arguments","P","generator","reject","fulfilled","next","rejected","container","panoramaContainer","config","currentSceneIndex","baseURL","location","href","configPath","Marzipano","fetch","response","json","catch","warn","getConfig","sceneConfig","sceneIndex","dataset","hotspotConfig","body"],"mappings":"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"}